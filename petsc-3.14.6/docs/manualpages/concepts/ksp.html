<html>
<title>KSP</title><body bgcolor="FFFFFF">
   <div id="version" align=right><b>petsc-3.14.6 2021-03-30</b></div>
   <div id="bugreport" align=right><a href="mailto:petsc-maint@mcs.anl.gov?subject=Typo or Error in Documentation &body=Please describe the typo or error in the documentation: petsc-3.14.6 v3.14.6 docs/manualpages/concepts/ksp.html "><small>Report Typos and Errors</small></a></div>
<h2>KSP</h2>
<menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex1.c.html"><CONCEPT>solving a system of linear equations</CONCEPT></A>
<menu>
Solves a tridiagonal linear system with KSP.<BR></menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex12.c.html"><CONCEPT>solving a system of linear equations</CONCEPT></A>
<menu>
Solves a linear system in parallel with KSP,<BR>demonstrating how to register a new preconditioner (PC) type.<BR>
Input parameters include:<BR>
  -m &lt;mesh_x&gt;       : number of mesh points in x-direction<BR>
  -n &lt;mesh_y&gt;       : number of mesh points in y-direction<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex1f.F90.html"><CONCEPT>solving a system of linear equations</CONCEPT></A>
<menu>
<BR>
   Description: Solves a tridiagonal linear system with KSP.<BR>
<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex29.c.html"><CONCEPT>solving a system of linear equations</CONCEPT></A>
<menu>
Solves 2D inhomogeneous Laplacian using multigrid.<BR></menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex32.c.html"><CONCEPT>solving a system of linear equations</CONCEPT></A>
<menu>
Solves 2D inhomogeneous Laplacian using multigrid.<BR></menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex34.c.html"><CONCEPT>solving a system of linear equations</CONCEPT></A>
<menu>
Solves 3D Laplacian using multigrid.<BR></menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex54f.F90.html"><CONCEPT>solving a system of linear equations</CONCEPT></A>
<menu>
<BR>
   Description: Solve Ax=b.  A comes from an anisotropic 2D thermal problem with Q1 FEM on domain (-1,1)^2.<BR>
       Material conductivity given by tensor:<BR>
<BR>
       D = | 1 0       |<BR>
           | 0 epsilon |<BR>
<BR>
    rotated by angle 'theta' (-theta &lt;90&gt; in degrees) with anisotropic parameter 'epsilon' (-epsilon &lt;0.0&gt;).<BR>
    Blob right hand side centered at C (-blob_center C(1),C(2) &lt;0,0&gt;)<BR>
    Dirichlet BCs on y=-1 face.<BR>
<BR>
    -out_matlab will generate binary files for A,x,b and a ex54f.m file that reads them and plots them in matlab.<BR>
<BR>
    User can change anisotropic shape with function ex54_psi().  Negative theta will switch to a circular anisotropy.<BR>
<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex73.c.html"><CONCEPT>solving a system of linear equations</CONCEPT></A>
<menu>
Solves 2D inhomogeneous Laplacian. Demonstates using PCTelescopeSetCoarseDM functionality of PCTelescope via a DMShell<BR></menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex18.c.html"><CONCEPT>basic parallel example;</CONCEPT></A>
<menu>
single<BR>
single<BR>
single<BR>
single<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex2.c.html"><CONCEPT>basic parallel example;</CONCEPT></A>
<menu>
Solves a linear system in parallel with KSP.<BR>Input parameters include:<BR>
  -view_exact_sol   : write exact solution vector to stdout<BR>
  -m &lt;mesh_x&gt;       : number of mesh points in x-direction<BR>
  -n &lt;mesh_y&gt;       : number of mesh points in y-direction<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex23.c.html"><CONCEPT>basic parallel example;</CONCEPT></A>
<menu>
Solves a tridiagonal linear system.<BR></menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex46.c.html"><CONCEPT>basic parallel example;</CONCEPT></A>
<menu>
Solves a linear system in parallel with KSP and DM.<BR>Compare this to ex2 which solves the same problem without a DM.<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex12.c.html"><CONCEPT>Laplacian, 2d</CONCEPT></A>
<menu>
Solves a linear system in parallel with KSP,<BR>demonstrating how to register a new preconditioner (PC) type.<BR>
Input parameters include:<BR>
  -m &lt;mesh_x&gt;       : number of mesh points in x-direction<BR>
  -n &lt;mesh_y&gt;       : number of mesh points in y-direction<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex13.c.html"><CONCEPT>Laplacian, 2d</CONCEPT></A>
<menu>
Solves a variable Poisson problem with KSP.<BR></menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex13f90.F90.html"><CONCEPT>Laplacian, 2d</CONCEPT></A>
<menu>
<BR>
<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex16.c.html"><CONCEPT>Laplacian, 2d</CONCEPT></A>
<menu>
Solves a sequence of linear systems with different right-hand-side vectors.<BR>Input parameters include:<BR>
  -ntimes &lt;ntimes&gt;  : number of linear systems to solve<BR>
  -view_exact_sol   : write exact solution vector to stdout<BR>
  -m &lt;mesh_x&gt;       : number of mesh points in x-direction<BR>
  -n &lt;mesh_y&gt;       : number of mesh points in y-direction<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex18.c.html"><CONCEPT>Laplacian, 2d</CONCEPT></A>
<menu>
single<BR>
single<BR>
single<BR>
single<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex2.c.html"><CONCEPT>Laplacian, 2d</CONCEPT></A>
<menu>
Solves a linear system in parallel with KSP.<BR>Input parameters include:<BR>
  -view_exact_sol   : write exact solution vector to stdout<BR>
  -m &lt;mesh_x&gt;       : number of mesh points in x-direction<BR>
  -n &lt;mesh_y&gt;       : number of mesh points in y-direction<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex29.c.html"><CONCEPT>Laplacian, 2d</CONCEPT></A>
<menu>
Solves 2D inhomogeneous Laplacian using multigrid.<BR></menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex32.c.html"><CONCEPT>Laplacian, 2d</CONCEPT></A>
<menu>
Solves 2D inhomogeneous Laplacian using multigrid.<BR></menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex46.c.html"><CONCEPT>Laplacian, 2d</CONCEPT></A>
<menu>
Solves a linear system in parallel with KSP and DM.<BR>Compare this to ex2 which solves the same problem without a DM.<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex73.c.html"><CONCEPT>Laplacian, 2d</CONCEPT></A>
<menu>
Solves 2D inhomogeneous Laplacian. Demonstates using PCTelescopeSetCoarseDM functionality of PCTelescope via a DMShell<BR></menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex10.c.html"><CONCEPT>basic parallel example</CONCEPT></A>
<menu>
Solve a small system and a large system through preloading<BR>  Input arguments are:<BR>
   -f0 &lt;small_sys_binary&gt; -f1 &lt;large_sys_binary&gt; <BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex15.c.html"><CONCEPT>basic parallel example</CONCEPT></A>
<menu>
Solves a linear system in parallel with KSP.  Also<BR>illustrates setting a user-defined shell preconditioner and using the<BR>
Input parameters include:<BR>
  -user_defined_pc : Activate a user-defined preconditioner<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex15f.F90.html"><CONCEPT>basic parallel example</CONCEPT></A>
<menu>
<BR>
   Solves a linear system in parallel with KSP.  Also indicates<BR>
   use of a user-provided preconditioner.  Input parameters include:<BR>
      -user_defined_pc : Activate a user-defined preconditioner<BR>
<BR>
<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex2f.F90.html"><CONCEPT>basic parallel example</CONCEPT></A>
<menu>
<BR>
  Description: Solves a linear system in parallel with KSP (Fortran code).<BR>
               Also shows how to set a user-defined monitoring routine.<BR>
<BR>
<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex3.c.html"><CONCEPT>basic parallel example</CONCEPT></A>
<menu>
Bilinear elements on the unit square for Laplacian.  To test the parallel<BR>matrix assembly, the matrix is intentionally laid out across processors<BR>
differently from the way it is assembled.  Input arguments are:<BR>
  -m &lt;size&gt; : problem size<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex67.c.html"><CONCEPT>basic parallel example</CONCEPT></A>
<menu>
Krylov methods to solve u''  = f in parallel with periodic boundary conditions,<BR>                      with a singular, inconsistent system.<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex16.c.html"><CONCEPT>repeatedly solving linear systems;</CONCEPT></A>
<menu>
Solves a sequence of linear systems with different right-hand-side vectors.<BR>Input parameters include:<BR>
  -ntimes &lt;ntimes&gt;  : number of linear systems to solve<BR>
  -view_exact_sol   : write exact solution vector to stdout<BR>
  -m &lt;mesh_x&gt;       : number of mesh points in x-direction<BR>
  -n &lt;mesh_y&gt;       : number of mesh points in y-direction<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex5.c.html"><CONCEPT>repeatedly solving linear systems;</CONCEPT></A>
<menu>
Solves two linear systems in parallel with KSP.  The code<BR>illustrates repeated solution of linear systems with the same preconditioner<BR>
method but different matrices (having the same nonzero structure).  The code<BR>
also uses multiple profiling stages.  Input arguments are<BR>
  -m &lt;size&gt; : problem size<BR>
  -mat_nonsym : use nonsymmetric matrix (default is symmetric)<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex5f.F90.html"><CONCEPT>repeatedly solving linear systems;</CONCEPT></A>
<menu>
Solves two linear systems in parallel with KSP.  The code<BR>
illustrates repeated solution of linear systems with the same preconditioner<BR>
method but different matrices (having the same nonzero structure).  The code<BR>
also uses multiple profiling stages.  Input arguments are<BR>
  -m &lt;size&gt; : problem size<BR>
  -mat_nonsym : use nonsymmetric matrix (default is symmetric)<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex6f.F90.html"><CONCEPT>repeatedly solving linear systems;</CONCEPT></A>
<menu>
<BR>
  Description: This example demonstrates repeated linear solves as<BR>
  well as the use of different preconditioner and linear system<BR>
  matrices.  This example also illustrates how to save PETSc objects<BR>
  in common blocks.<BR>
<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex9.c.html"><CONCEPT>repeatedly solving linear systems;</CONCEPT></A>
<menu>
The solution of 2 different linear systems with different linear solvers.<BR>Also, this example illustrates the repeated<BR>
solution of linear systems, while reusing matrix, vector, and solver data<BR>
structures throughout the process.  Note the various stages of event logging.<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex7.c.html"><CONCEPT>customizing the block Jacobi preconditioner</CONCEPT></A>
<menu>
Block Jacobi preconditioner for solving a linear system in parallel with KSP.<BR>The code indicates the<BR>
procedures for setting the particular block sizes and for using different<BR>
linear solvers on the individual blocks.<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex7f.F90.html"><CONCEPT>customizing the block Jacobi preconditioner</CONCEPT></A>
<menu>
 Block Jacobi preconditioner for solving a linear system in parallel with KSP<BR>
 The code indicates the procedures for setting the particular block sizes and<BR>
 for using different linear solvers on the individual blocks<BR>
 This example focuses on ways to customize the block Jacobi preconditioner.<BR>
 See ex1.c and ex2.c for more detailed comments on the basic usage of KSP<BR>
 (including working with matrices and vectors)<BR>
 Recall: The block Jacobi method is equivalent to the ASM preconditioner with zero overlap.<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex8.c.html"><CONCEPT>Additive Schwarz Method (ASM) with user-defined subdomains</CONCEPT></A>
<menu>
Illustrates use of the preconditioner ASM.<BR>The Additive Schwarz Method for solving a linear system in parallel with KSP.  The<BR>
code indicates the procedure for setting user-defined subdomains.  Input<BR>
parameters include:<BR>
  -user_set_subdomain_solvers:  User explicitly sets subdomain solvers<BR>
  -user_set_subdomains:  Activate user-defined subdomains<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex11.c.html"><CONCEPT>solving a Helmholtz equation</CONCEPT></A>
<menu>
Solves a linear system in parallel with KSP.<BR></menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex11f.F90.html"><CONCEPT>solving a Helmholtz equation</CONCEPT></A>
<menu>
<BR>
  Description: Solves a complex linear system in parallel with KSP (Fortran code).<BR>
<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex13.c.html"><CONCEPT>basic sequential example</CONCEPT></A>
<menu>
Solves a variable Poisson problem with KSP.<BR></menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex13f90.F90.html"><CONCEPT>basic sequential example</CONCEPT></A>
<menu>
<BR>
<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex27.c.html"><CONCEPT>solving a linear system</CONCEPT></A>
<menu>
Reads a PETSc matrix and vector from a file and solves the normal equations.<BR></menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex41.c.html"><CONCEPT>solving a linear system</CONCEPT></A>
<menu>
Reads a PETSc matrix and vector from a socket connection,  solves a linear system and sends the result back.<BR></menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex72.c.html"><CONCEPT>solving a linear system</CONCEPT></A>
<menu>
Reads a PETSc matrix and vector from a file and solves a linear system.<BR>This version first preloads and solves a small system, then loads <BR>
another (larger) system and solves it as well.  This example illustrates<BR>
preloading of instructions with the smaller system so that more accurate<BR>
performance monitoring can be done with the larger one (that actually<BR>
is the system of interest).  See the 'Performance Hints' chapter of the<BR>
users manual for a discussion of preloading.  Input parameters include<BR>
  -f0 &lt;input_file&gt; : first file to load (small system)<BR>
  -f1 &lt;input_file&gt; : second file to load (larger system)<BR>
  -nearnulldim &lt;0&gt; : number of vectors in the near-null space immediately following matrix<BR>
  -trans  : solve transpose system instead<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex34.c.html"><CONCEPT>Laplacian, 3d</CONCEPT></A>
<menu>
Solves 3D Laplacian using multigrid.<BR></menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex62.c.html"><CONCEPT>Additive Schwarz Method (GASM) with user-defined subdomains</CONCEPT></A>
<menu>
Illustrates use of PCGASM.<BR>The Generalized Additive Schwarz Method for solving a linear system in parallel with KSP.  The<BR>
code indicates the procedure for setting user-defined subdomains.<BR>
See section 'ex62' below for command-line options.<BR>
Without -user_set_subdomains, the general PCGASM options are meaningful:<BR>
  -pc_gasm_total_subdomains<BR>
  -pc_gasm_print_subdomains<BR>
<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex64.c.html"><CONCEPT>Additive Schwarz Method (GASM) with user-defined subdomains</CONCEPT></A>
<menu>
Illustrates use of the preconditioner GASM.<BR>    using hierarchical partitioning and MatIncreaseOverlapSplit 
        -pc_gasm_total_subdomains<BR> 
        -pc_gasm_print_subdomains<BR> 
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex74.c.html"><CONCEPT>ex74.c</CONCEPT></A>
<menu>
Solves the constant-coefficient 1D heat equation <BR>with an Implicit Runge-Kutta method using MatKAIJ.                  <BR>
                                                                    <BR>
    du      d^2 u                                                   <BR>
    --  = a ----- ; 0 &lt;= x &lt;= 1;                                    <BR>
    dt      dx^2                                                    <BR>
                                                                    <BR>
  with periodic boundary conditions                                 <BR>
                                                                    <BR>
2nd order central discretization in space:                          <BR>
                                                                    <BR>
   [ d^2 u ]     u_{i+1} - 2u_i + u_{i-1}                           <BR>
   [ ----- ]  =  ------------------------                           <BR>
   [ dx^2  ]i              h^2                                      <BR>
                                                                    <BR>
    i = grid index;    h = x_{i+1}-x_i (Uniform)                    <BR>
    0 &lt;= i &lt; n         h = 1.0/n                                    <BR>
                                                                    <BR>
Thus,                                                               <BR>
                                                                    <BR>
   du                                                               <BR>
   --  = Ju;  J = (a/h^2) tridiagonal(1,-2,1)_n                     <BR>
   dt                                                               <BR>
                                                                    <BR>
Implicit Runge-Kutta method:                                        <BR>
                                                                    <BR>
  U^(k)   = u^n + dt \\sum_i a_{ki} JU^{i}                          <BR>
  u^{n+1} = u^n + dt \\sum_i b_i JU^{i}                             <BR>
                                                                    <BR>
  i = 1,...,s (s -&gt; number of stages)                               <BR>
                                                                    <BR>
At each time step, we solve                                         <BR>
                                                                    <BR>
 [  1                                  ]     1                      <BR>
 [ -- I \\otimes A^{-1} - J \\otimes I ] U = -- u^n \\otimes A^{-1} <BR>
 [ dt                                  ]     dt                     <BR>
                                                                    <BR>
  where A is the Butcher tableaux of the implicit                   <BR>
  Runge-Kutta method,                                               <BR>
                                                                    <BR>
with MATKAIJ and KSP.                                               <BR>
                                                                    <BR>
Available IRK Methods:                                              <BR>
  gauss       n-stage Gauss method                                  <BR>
                                                                    <BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex2f.F90.html"><CONCEPT>setting a user-defined monitoring routine</CONCEPT></A>
<menu>
<BR>
  Description: Solves a linear system in parallel with KSP (Fortran code).<BR>
               Also shows how to set a user-defined monitoring routine.<BR>
<BR>
<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex6f.F90.html"><CONCEPT>different matrices for linear system and preconditioner;</CONCEPT></A>
<menu>
<BR>
  Description: This example demonstrates repeated linear solves as<BR>
  well as the use of different preconditioner and linear system<BR>
  matrices.  This example also illustrates how to save PETSc objects<BR>
  in common blocks.<BR>
<BR>
</menu>
<LI><A HREF="../../../src/ksp/ksp/tutorials/ex14f.F90.html"><CONCEPT>writing a user-defined nonlinear solver</CONCEPT></A>
<menu>
<BR>
<BR>
  Solves a nonlinear system in parallel with a user-defined<BR>
  Newton method that uses KSP to solve the linearized Newton sytems.  This solver<BR>
  is a very simplistic inexact Newton method.  The intent of this code is to<BR>
  demonstrate the repeated solution of linear sytems with the same nonzero pattern.<BR>
<BR>
  This is NOT the recommended approach for solving nonlinear problems with PETSc!<BR>
  We urge users to employ the SNES component for solving nonlinear problems whenever<BR>
  possible, as it offers many advantages over coding nonlinear solvers independently.<BR>
<BR>
  We solve the  Bratu (SFI - solid fuel ignition) problem in a 2D rectangular<BR>
  domain, using distributed arrays (DMDAs) to partition the parallel grid.<BR>
<BR>
</menu>
</menu>
</body>
</html>
