<center><a href="dtds.c">Actual source code: dtds.c</a></center><br>

<html>
<head> <link rel="canonical" href="http://www.mcs.anl.gov/petsc/petsc-current/src/dm/dt/interface/dtds.c.html" />
<title></title>
<meta name="generator" content="c2html 0.9.4">
<meta name="date" content="2021-03-30T16:51:00+00:00">
</head>

<body bgcolor="#FFFFFF">
   <div id="version" align=right><b>petsc-3.14.6 2021-03-30</b></div>
   <div id="bugreport" align=right><a href="mailto:petsc-maint@mcs.anl.gov?subject=Typo or Error in Documentation &body=Please describe the typo or error in the documentation: petsc-3.14.6 v3.14.6 src/dm/dt/interface/dtds.c.html "><small>Report Typos and Errors</small></a></div>
<pre width="80">
<a name="line1">  1: </a>#include <A href="../../../../include/petsc/private/petscdsimpl.h.html">&lt;petsc/private/petscdsimpl.h&gt;</A>

<a name="line3">  3: </a><a href="../../../../docs/manualpages/Sys/PetscClassId.html#PetscClassId">PetscClassId</a> PETSCDS_CLASSID = 0;

<a name="line5">  5: </a><a href="../../../../docs/manualpages/Sys/PetscFunctionList.html#PetscFunctionList">PetscFunctionList</a> PetscDSList              = NULL;
<a name="line6">  6: </a><a href="../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a>         PetscDSRegisterAllCalled = <a href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>;

<a name="line8">  8: </a><font color="#B22222">/* A <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> (Discrete System) encodes a set of equations posed in a discrete space, which represents a set of</font>
<a name="line9">  9: </a><font color="#B22222">   nonlinear continuum equations. The equations can have multiple fields, each field having a different</font>
<a name="line10"> 10: </a><font color="#B22222">   discretization. In addition, different pieces of the domain can have different field combinations and equations.</font>

<a name="line12"> 12: </a><font color="#B22222">   The DS provides the user a description of the approximation space on any given cell. It also gives pointwise</font>
<a name="line13"> 13: </a><font color="#B22222">   functions representing the equations.</font>

<a name="line15"> 15: </a><font color="#B22222">   Each field is associated with a label, marking the cells on which it is supported. Note that a field can be</font>
<a name="line16"> 16: </a><font color="#B22222">   supported on the closure of a cell not in the label due to overlap of the boundary of neighboring cells. The <a href="../../../../docs/manualpages/DM/DM.html#DM">DM</a></font>
<a name="line17"> 17: </a><font color="#B22222">   then creates a DS for each set of cells with identical approximation spaces. When assembling, the user asks for</font>
<a name="line18"> 18: </a><font color="#B22222">   the space associated with a given cell. DMPlex uses the labels associated with each DS in the default integration loop.</font>
<a name="line19"> 19: </a><font color="#B22222">*/</font>

<a name="line21"> 21: </a><font color="#B22222">/*@C</font>
<a name="line22"> 22: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSRegister.html#PetscDSRegister">PetscDSRegister</a> - Adds a new <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> implementation</font>

<a name="line24"> 24: </a><font color="#B22222">  Not Collective</font>

<a name="line26"> 26: </a><font color="#B22222">  Input Parameters:</font>
<a name="line27"> 27: </a><font color="#B22222">+ name        - The name of a new user-defined creation routine</font>
<a name="line28"> 28: </a><font color="#B22222">- create_func - The creation routine itself</font>

<a name="line30"> 30: </a><font color="#B22222">  Notes:</font>
<a name="line31"> 31: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSRegister.html#PetscDSRegister">PetscDSRegister</a>() may be called multiple times to add several user-defined PetscDSs</font>

<a name="line33"> 33: </a><font color="#B22222">  Sample usage:</font>
<a name="line34"> 34: </a><font color="#B22222">.vb</font>
<a name="line35"> 35: </a><font color="#B22222">    <a href="../../../../docs/manualpages/DT/PetscDSRegister.html#PetscDSRegister">PetscDSRegister</a>("my_ds", MyPetscDSCreate);</font>
<a name="line36"> 36: </a><font color="#B22222">.ve</font>

<a name="line38"> 38: </a><font color="#B22222">  Then, your <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> type can be chosen with the procedural interface via</font>
<a name="line39"> 39: </a><font color="#B22222">.vb</font>
<a name="line40"> 40: </a><font color="#B22222">    <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>(<a href="../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</a>, <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> *);</font>
<a name="line41"> 41: </a><font color="#B22222">    <a href="../../../../docs/manualpages/DT/PetscDSSetType.html#PetscDSSetType">PetscDSSetType</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a>, "my_ds");</font>
<a name="line42"> 42: </a><font color="#B22222">.ve</font>
<a name="line43"> 43: </a><font color="#B22222">   or at runtime via the option</font>
<a name="line44"> 44: </a><font color="#B22222">.vb</font>
<a name="line45"> 45: </a><font color="#B22222">    -petscds_type my_ds</font>
<a name="line46"> 46: </a><font color="#B22222">.ve</font>

<a name="line48"> 48: </a><font color="#B22222">  Level: advanced</font>

<a name="line50"> 50: </a><font color="#B22222">   Not available from Fortran</font>

<a name="line52"> 52: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DM/PetscDSRegisterAll.html#PetscDSRegisterAll">PetscDSRegisterAll</a>(), PetscDSRegisterDestroy()</font>

<a name="line54"> 54: </a><font color="#B22222">@*/</font>
<a name="line55"> 55: </a><strong><font color="#4169E1"><a name="PetscDSRegister"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSRegister.html#PetscDSRegister">PetscDSRegister</a>(const char sname[], <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> (*function)(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a>))</font></strong>
<a name="line56"> 56: </a>{

<a name="line60"> 60: </a>  <a href="../../../../docs/manualpages/Sys/PetscFunctionListAdd.html#PetscFunctionListAdd">PetscFunctionListAdd</a>(&amp;PetscDSList, sname, function);
<a name="line61"> 61: </a>  <font color="#4169E1">return</font>(0);
<a name="line62"> 62: </a>}

<a name="line64"> 64: </a><font color="#B22222">/*@C</font>
<a name="line65"> 65: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetType.html#PetscDSSetType">PetscDSSetType</a> - Builds a particular <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>

<a name="line67"> 67: </a><font color="#B22222">  Collective on prob</font>

<a name="line69"> 69: </a><font color="#B22222">  Input Parameters:</font>
<a name="line70"> 70: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line71"> 71: </a><font color="#B22222">- name - The kind of system</font>

<a name="line73"> 73: </a><font color="#B22222">  Options Database Key:</font>
<a name="line74"> 74: </a><font color="#B22222">. -petscds_type &lt;type&gt; - Sets the <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> type; use -help for a list of available types</font>

<a name="line76"> 76: </a><font color="#B22222">  Level: intermediate</font>

<a name="line78"> 78: </a><font color="#B22222">   Not available from Fortran</font>

<a name="line80"> 80: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetType.html#PetscDSGetType">PetscDSGetType</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line81"> 81: </a><font color="#B22222">@*/</font>
<a name="line82"> 82: </a><strong><font color="#4169E1"><a name="PetscDSSetType"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetType.html#PetscDSSetType">PetscDSSetType</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/DM/PetscDSType.html#PetscDSType">PetscDSType</a> name)</font></strong>
<a name="line83"> 83: </a>{
<a name="line84"> 84: </a>  <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> (*r)(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a>);
<a name="line85"> 85: </a>  <a href="../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a>      match;

<a name="line90"> 90: </a>  <a href="../../../../docs/manualpages/Sys/PetscObjectTypeCompare.html#PetscObjectTypeCompare">PetscObjectTypeCompare</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob, name, &amp;match);
<a name="line91"> 91: </a>  <font color="#4169E1">if</font> (match) <font color="#4169E1">return</font>(0);

<a name="line93"> 93: </a>  <a href="../../../../docs/manualpages/DM/PetscDSRegisterAll.html#PetscDSRegisterAll">PetscDSRegisterAll</a>();
<a name="line94"> 94: </a>  <a href="../../../../docs/manualpages/Sys/PetscFunctionListFind.html#PetscFunctionListFind">PetscFunctionListFind</a>(PetscDSList, name, &amp;r);
<a name="line95"> 95: </a>  <font color="#4169E1">if</font> (!r) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob), PETSC_ERR_ARG_UNKNOWN_TYPE, <font color="#666666">"Unknown <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> type: %s"</font>, name);

<a name="line97"> 97: </a>  <font color="#4169E1">if</font> (prob-&gt;ops-&gt;destroy) {
<a name="line98"> 98: </a>    (*prob-&gt;ops-&gt;destroy)(prob);
<a name="line99"> 99: </a>    prob-&gt;ops-&gt;destroy = NULL;
<a name="line100">100: </a>  }
<a name="line101">101: </a>  (*r)(prob);
<a name="line102">102: </a>  PetscObjectChangeTypeName((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob, name);
<a name="line103">103: </a>  <font color="#4169E1">return</font>(0);
<a name="line104">104: </a>}

<a name="line106">106: </a><font color="#B22222">/*@C</font>
<a name="line107">107: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetType.html#PetscDSGetType">PetscDSGetType</a> - Gets the <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> type name (as a string) from the object.</font>

<a name="line109">109: </a><font color="#B22222">  Not Collective</font>

<a name="line111">111: </a><font color="#B22222">  Input Parameter:</font>
<a name="line112">112: </a><font color="#B22222">. prob  - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>

<a name="line114">114: </a><font color="#B22222">  Output Parameter:</font>
<a name="line115">115: </a><font color="#B22222">. name - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> type name</font>

<a name="line117">117: </a><font color="#B22222">  Level: intermediate</font>

<a name="line119">119: </a><font color="#B22222">   Not available from Fortran</font>

<a name="line121">121: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetType.html#PetscDSSetType">PetscDSSetType</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line122">122: </a><font color="#B22222">@*/</font>
<a name="line123">123: </a><strong><font color="#4169E1"><a name="PetscDSGetType"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetType.html#PetscDSGetType">PetscDSGetType</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/DM/PetscDSType.html#PetscDSType">PetscDSType</a> *name)</font></strong>
<a name="line124">124: </a>{

<a name="line130">130: </a>  <a href="../../../../docs/manualpages/DM/PetscDSRegisterAll.html#PetscDSRegisterAll">PetscDSRegisterAll</a>();
<a name="line131">131: </a>  *name = ((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob)-&gt;type_name;
<a name="line132">132: </a>  <font color="#4169E1">return</font>(0);
<a name="line133">133: </a>}

<a name="line135">135: </a><strong><font color="#4169E1"><a name="PetscDSView_Ascii"></a>static <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDSView_Ascii(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</a> viewer)</font></strong>
<a name="line136">136: </a>{
<a name="line137">137: </a>  <a href="../../../../docs/manualpages/Viewer/PetscViewerFormat.html#PetscViewerFormat">PetscViewerFormat</a>  format;
<a name="line138">138: </a>  const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> *constants;
<a name="line139">139: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>           numConstants, f;
<a name="line140">140: </a>  <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a>     ierr;

<a name="line143">143: </a>  PetscViewerGetFormat(viewer, &amp;format);
<a name="line144">144: </a>  <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"Discrete System with %d fields\n"</font>, prob-&gt;Nf);
<a name="line145">145: </a>  <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPushTab.html#PetscViewerASCIIPushTab">PetscViewerASCIIPushTab</a>(viewer);
<a name="line146">146: </a>  <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"  cell total dim %D total comp %D\n"</font>, prob-&gt;totDim, prob-&gt;totComp);
<a name="line147">147: </a>  <font color="#4169E1">if</font> (prob-&gt;isHybrid) {<a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"  hybrid cell\n"</font>);}
<a name="line148">148: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; prob-&gt;Nf; ++f) {
<a name="line149">149: </a>    DSBoundary      b;
<a name="line150">150: </a>    <a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>     obj;
<a name="line151">151: </a>    <a href="../../../../docs/manualpages/Sys/PetscClassId.html#PetscClassId">PetscClassId</a>    id;
<a name="line152">152: </a>    <a href="../../../../docs/manualpages/FE/PetscQuadrature.html#PetscQuadrature">PetscQuadrature</a> q;
<a name="line153">153: </a>    const char     *name;
<a name="line154">154: </a>    <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>        Nc, Nq, Nqc;

<a name="line156">156: </a>    <a href="../../../../docs/manualpages/DT/PetscDSGetDiscretization.html#PetscDSGetDiscretization">PetscDSGetDiscretization</a>(prob, f, &amp;obj);
<a name="line157">157: </a>    <a href="../../../../docs/manualpages/Sys/PetscObjectGetClassId.html#PetscObjectGetClassId">PetscObjectGetClassId</a>(obj, &amp;id);
<a name="line158">158: </a>    <a href="../../../../docs/manualpages/Sys/PetscObjectGetName.html#PetscObjectGetName">PetscObjectGetName</a>(obj, &amp;name);
<a name="line159">159: </a>    <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"Field %s"</font>, name ? name : <font color="#666666">"&lt;unknown&gt;"</font>);
<a name="line160">160: </a>    <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIUseTabs.html#PetscViewerASCIIUseTabs">PetscViewerASCIIUseTabs</a>(viewer, <a href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>);
<a name="line161">161: </a>    <font color="#4169E1">if</font> (id == PETSCFE_CLASSID)      {
<a name="line162">162: </a>      <a href="../../../../docs/manualpages/FE/PetscFEGetNumComponents.html#PetscFEGetNumComponents">PetscFEGetNumComponents</a>((<a href="../../../../docs/manualpages/FE/PetscFE.html#PetscFE">PetscFE</a>) obj, &amp;Nc);
<a name="line163">163: </a>      <a href="../../../../docs/manualpages/FE/PetscFEGetQuadrature.html#PetscFEGetQuadrature">PetscFEGetQuadrature</a>((<a href="../../../../docs/manualpages/FE/PetscFE.html#PetscFE">PetscFE</a>) obj, &amp;q);
<a name="line164">164: </a>      <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">" FEM"</font>);
<a name="line165">165: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (id == PETSCFV_CLASSID) {
<a name="line166">166: </a>      <a href="../../../../docs/manualpages/FV/PetscFVGetNumComponents.html#PetscFVGetNumComponents">PetscFVGetNumComponents</a>((<a href="../../../../docs/manualpages/FV/PetscFV.html#PetscFV">PetscFV</a>) obj, &amp;Nc);
<a name="line167">167: </a>      <a href="../../../../docs/manualpages/FV/PetscFVGetQuadrature.html#PetscFVGetQuadrature">PetscFVGetQuadrature</a>((<a href="../../../../docs/manualpages/FV/PetscFV.html#PetscFV">PetscFV</a>) obj, &amp;q);
<a name="line168">168: </a>      <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">" FVM"</font>);
<a name="line169">169: </a>    }
<a name="line170">170: </a>    <font color="#4169E1">else</font> <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob), PETSC_ERR_ARG_WRONG, <font color="#666666">"Unknown discretization type for field %D"</font>, f);
<a name="line171">171: </a>    <font color="#4169E1">if</font> (Nc &gt; 1) {<a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"%D components"</font>, Nc);}
<a name="line172">172: </a>    <font color="#4169E1">else</font>        {<a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"%D component "</font>, Nc);}
<a name="line173">173: </a>    <font color="#4169E1">if</font> (prob-&gt;implicit[f]) {<a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">" (implicit)"</font>);}
<a name="line174">174: </a>    <font color="#4169E1">else</font>                   {<a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">" (explicit)"</font>);}
<a name="line175">175: </a>    <font color="#4169E1">if</font> (q) {
<a name="line176">176: </a>      <a href="../../../../docs/manualpages/DT/PetscQuadratureGetData.html#PetscQuadratureGetData">PetscQuadratureGetData</a>(q, NULL, &amp;Nqc, &amp;Nq, NULL, NULL);
<a name="line177">177: </a>      <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">" (Nq %D Nqc %D)"</font>, Nq, Nqc);
<a name="line178">178: </a>    }
<a name="line179">179: </a>    <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"\n"</font>);
<a name="line180">180: </a>    <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIUseTabs.html#PetscViewerASCIIUseTabs">PetscViewerASCIIUseTabs</a>(viewer, <a href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</a>);
<a name="line181">181: </a>    <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPushTab.html#PetscViewerASCIIPushTab">PetscViewerASCIIPushTab</a>(viewer);
<a name="line182">182: </a>    <font color="#4169E1">if</font> (id == PETSCFE_CLASSID)      {<a href="../../../../docs/manualpages/FE/PetscFEView.html#PetscFEView">PetscFEView</a>((<a href="../../../../docs/manualpages/FE/PetscFE.html#PetscFE">PetscFE</a>) obj, viewer);}
<a name="line183">183: </a>    <font color="#4169E1">else</font> <font color="#4169E1">if</font> (id == PETSCFV_CLASSID) {<a href="../../../../docs/manualpages/FV/PetscFVView.html#PetscFVView">PetscFVView</a>((<a href="../../../../docs/manualpages/FV/PetscFV.html#PetscFV">PetscFV</a>) obj, viewer);}
<a name="line184">184: </a>    <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPopTab.html#PetscViewerASCIIPopTab">PetscViewerASCIIPopTab</a>(viewer);

<a name="line186">186: </a>    <font color="#4169E1">for</font> (b = prob-&gt;boundary; b; b = b-&gt;next) {
<a name="line187">187: </a>      <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> c, i;

<a name="line189">189: </a>      <font color="#4169E1">if</font> (b-&gt;field != f) <font color="#4169E1">continue</font>;
<a name="line190">190: </a>      <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPushTab.html#PetscViewerASCIIPushTab">PetscViewerASCIIPushTab</a>(viewer);
<a name="line191">191: </a>      <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"Boundary %s (%s) %s\n"</font>, b-&gt;name, b-&gt;labelname, DMBoundaryConditionTypes[b-&gt;type]);
<a name="line192">192: </a>      <font color="#4169E1">if</font> (!b-&gt;numcomps) {
<a name="line193">193: </a>        <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"  all components\n"</font>);
<a name="line194">194: </a>      } <font color="#4169E1">else</font> {
<a name="line195">195: </a>        <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"  components: "</font>);
<a name="line196">196: </a>        <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIUseTabs.html#PetscViewerASCIIUseTabs">PetscViewerASCIIUseTabs</a>(viewer, <a href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>);
<a name="line197">197: </a>        <font color="#4169E1">for</font> (c = 0; c &lt; b-&gt;numcomps; ++c) {
<a name="line198">198: </a>          <font color="#4169E1">if</font> (c &gt; 0) {<a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">", "</font>);}
<a name="line199">199: </a>          <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"%D"</font>, b-&gt;comps[c]);
<a name="line200">200: </a>        }
<a name="line201">201: </a>        <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"\n"</font>);
<a name="line202">202: </a>        <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIUseTabs.html#PetscViewerASCIIUseTabs">PetscViewerASCIIUseTabs</a>(viewer, <a href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</a>);
<a name="line203">203: </a>      }
<a name="line204">204: </a>      <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"  ids: "</font>);
<a name="line205">205: </a>      <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIUseTabs.html#PetscViewerASCIIUseTabs">PetscViewerASCIIUseTabs</a>(viewer, <a href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>);
<a name="line206">206: </a>      <font color="#4169E1">for</font> (i = 0; i &lt; b-&gt;numids; ++i) {
<a name="line207">207: </a>        <font color="#4169E1">if</font> (i &gt; 0) {<a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">", "</font>);}
<a name="line208">208: </a>        <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"%D"</font>, b-&gt;ids[i]);
<a name="line209">209: </a>      }
<a name="line210">210: </a>      <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"\n"</font>);
<a name="line211">211: </a>      <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIUseTabs.html#PetscViewerASCIIUseTabs">PetscViewerASCIIUseTabs</a>(viewer, <a href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</a>);
<a name="line212">212: </a>      <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPopTab.html#PetscViewerASCIIPopTab">PetscViewerASCIIPopTab</a>(viewer);
<a name="line213">213: </a>    }
<a name="line214">214: </a>  }
<a name="line215">215: </a>  <a href="../../../../docs/manualpages/DT/PetscDSGetConstants.html#PetscDSGetConstants">PetscDSGetConstants</a>(prob, &amp;numConstants, &amp;constants);
<a name="line216">216: </a>  <font color="#4169E1">if</font> (numConstants) {
<a name="line217">217: </a>    <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"%D constants\n"</font>, numConstants);
<a name="line218">218: </a>    <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPushTab.html#PetscViewerASCIIPushTab">PetscViewerASCIIPushTab</a>(viewer);
<a name="line219">219: </a>    <font color="#4169E1">for</font> (f = 0; f &lt; numConstants; ++f) {<a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</a>(viewer, <font color="#666666">"%g\n"</font>, (double) <a href="../../../../docs/manualpages/Sys/PetscRealPart.html#PetscRealPart">PetscRealPart</a>(constants[f]));}
<a name="line220">220: </a>    <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPopTab.html#PetscViewerASCIIPopTab">PetscViewerASCIIPopTab</a>(viewer);
<a name="line221">221: </a>  }
<a name="line222">222: </a>  <a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPopTab.html#PetscViewerASCIIPopTab">PetscViewerASCIIPopTab</a>(viewer);
<a name="line223">223: </a>  <font color="#4169E1">return</font>(0);
<a name="line224">224: </a>}

<a name="line226">226: </a><font color="#B22222">/*@C</font>
<a name="line227">227: </a><font color="#B22222">   <a href="../../../../docs/manualpages/DT/PetscDSViewFromOptions.html#PetscDSViewFromOptions">PetscDSViewFromOptions</a> - View from Options</font>

<a name="line229">229: </a><font color="#B22222">   Collective on <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>

<a name="line231">231: </a><font color="#B22222">   Input Parameters:</font>
<a name="line232">232: </a><font color="#B22222">+  A - the <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line233">233: </a><font color="#B22222">.  obj - Optional object</font>
<a name="line234">234: </a><font color="#B22222">-  name - command line option</font>

<a name="line236">236: </a><font color="#B22222">   Level: intermediate</font>
<a name="line237">237: </a><font color="#B22222">.seealso:  <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a>, <a href="../../../../docs/manualpages/DT/PetscDSView.html#PetscDSView">PetscDSView</a>, <a href="../../../../docs/manualpages/Sys/PetscObjectViewFromOptions.html#PetscObjectViewFromOptions">PetscObjectViewFromOptions</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line238">238: </a><font color="#B22222">@*/</font>
<a name="line239">239: </a><strong><font color="#4169E1"><a name="PetscDSViewFromOptions"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a>  <a href="../../../../docs/manualpages/DT/PetscDSViewFromOptions.html#PetscDSViewFromOptions">PetscDSViewFromOptions</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> A,<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a> obj,const char name[])</font></strong>
<a name="line240">240: </a>{

<a name="line245">245: </a>  <a href="../../../../docs/manualpages/Sys/PetscObjectViewFromOptions.html#PetscObjectViewFromOptions">PetscObjectViewFromOptions</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>)A,obj,name);
<a name="line246">246: </a>  <font color="#4169E1">return</font>(0);
<a name="line247">247: </a>}

<a name="line249">249: </a><font color="#B22222">/*@C</font>
<a name="line250">250: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSView.html#PetscDSView">PetscDSView</a> - Views a <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>

<a name="line252">252: </a><font color="#B22222">  Collective on prob</font>

<a name="line254">254: </a><font color="#B22222">  Input Parameter:</font>
<a name="line255">255: </a><font color="#B22222">+ prob - the <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object to view</font>
<a name="line256">256: </a><font color="#B22222">- v  - the viewer</font>

<a name="line258">258: </a><font color="#B22222">  Level: developer</font>

<a name="line260">260: </a><font color="#B22222">.seealso <a href="../../../../docs/manualpages/DT/PetscDSDestroy.html#PetscDSDestroy">PetscDSDestroy</a>()</font>
<a name="line261">261: </a><font color="#B22222">@*/</font>
<a name="line262">262: </a><strong><font color="#4169E1"><a name="PetscDSView"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSView.html#PetscDSView">PetscDSView</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</a> v)</font></strong>
<a name="line263">263: </a>{
<a name="line264">264: </a>  <a href="../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a>      iascii;

<a name="line269">269: </a>  <font color="#4169E1">if</font> (!v) {<a href="../../../../docs/manualpages/Viewer/PetscViewerASCIIGetStdout.html#PetscViewerASCIIGetStdout">PetscViewerASCIIGetStdout</a>(<a href="../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob), &amp;v);}
<a name="line271">271: </a>  <a href="../../../../docs/manualpages/Sys/PetscObjectTypeCompare.html#PetscObjectTypeCompare">PetscObjectTypeCompare</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) v, <a href="../../../../docs/manualpages/Viewer/PETSCVIEWERASCII.html#PETSCVIEWERASCII">PETSCVIEWERASCII</a>, &amp;iascii);
<a name="line272">272: </a>  <font color="#4169E1">if</font> (iascii) {PetscDSView_Ascii(prob, v);}
<a name="line273">273: </a>  <font color="#4169E1">if</font> (prob-&gt;ops-&gt;view) {(*prob-&gt;ops-&gt;view)(prob, v);}
<a name="line274">274: </a>  <font color="#4169E1">return</font>(0);
<a name="line275">275: </a>}

<a name="line277">277: </a><font color="#B22222">/*@</font>
<a name="line278">278: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetFromOptions.html#PetscDSSetFromOptions">PetscDSSetFromOptions</a> - sets parameters in a <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> from the options database</font>

<a name="line280">280: </a><font color="#B22222">  Collective on prob</font>

<a name="line282">282: </a><font color="#B22222">  Input Parameter:</font>
<a name="line283">283: </a><font color="#B22222">. prob - the <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object to set options for</font>

<a name="line285">285: </a><font color="#B22222">  Options Database:</font>
<a name="line286">286: </a><font color="#B22222">+ -petscds_type &lt;type&gt;     : Set the DS type</font>
<a name="line287">287: </a><font color="#B22222">. -petscds_view &lt;view opt&gt; : View the DS</font>
<a name="line288">288: </a><font color="#B22222">. -petscds_jac_pre         : Turn formation of a separate Jacobian preconditioner on and off</font>
<a name="line289">289: </a><font color="#B22222">. -bc_&lt;name&gt; &lt;ids&gt;         : Specify a list of label ids for a boundary condition</font>
<a name="line290">290: </a><font color="#B22222">- -bc_&lt;name&gt;_comp &lt;comps&gt;  : Specify a list of field components to constrain for a boundary condition</font>

<a name="line292">292: </a><font color="#B22222">  Level: developer</font>

<a name="line294">294: </a><font color="#B22222">.seealso <a href="../../../../docs/manualpages/DT/PetscDSView.html#PetscDSView">PetscDSView</a>()</font>
<a name="line295">295: </a><font color="#B22222">@*/</font>
<a name="line296">296: </a><strong><font color="#4169E1"><a name="PetscDSSetFromOptions"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetFromOptions.html#PetscDSSetFromOptions">PetscDSSetFromOptions</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob)</font></strong>
<a name="line297">297: </a>{
<a name="line298">298: </a>  DSBoundary     b;
<a name="line299">299: </a>  const char    *defaultType;
<a name="line300">300: </a>  char           name[256];
<a name="line301">301: </a>  <a href="../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a>      flg;

<a name="line306">306: </a>  <font color="#4169E1">if</font> (!((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob)-&gt;type_name) {
<a name="line307">307: </a>    defaultType = <a href="../../../../docs/manualpages/DT/PETSCDSBASIC.html#PETSCDSBASIC">PETSCDSBASIC</a>;
<a name="line308">308: </a>  } <font color="#4169E1">else</font> {
<a name="line309">309: </a>    defaultType = ((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob)-&gt;type_name;
<a name="line310">310: </a>  }
<a name="line311">311: </a>  <a href="../../../../docs/manualpages/DM/PetscDSRegisterAll.html#PetscDSRegisterAll">PetscDSRegisterAll</a>();

<a name="line313">313: </a>  <a href="../../../../docs/manualpages/Sys/PetscObjectOptionsBegin.html#PetscObjectOptionsBegin">PetscObjectOptionsBegin</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob);
<a name="line314">314: </a>  <font color="#4169E1">for</font> (b = prob-&gt;boundary; b; b = b-&gt;next) {
<a name="line315">315: </a>    char       optname[1024];
<a name="line316">316: </a>    <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>   ids[1024], len = 1024;
<a name="line317">317: </a>    <a href="../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a>  flg;

<a name="line319">319: </a>    <a href="../../../../docs/manualpages/Sys/PetscSNPrintf.html#PetscSNPrintf">PetscSNPrintf</a>(optname, <font color="#4169E1">sizeof</font>(optname), <font color="#666666">"-bc_%s"</font>, b-&gt;name);
<a name="line320">320: </a>    <a href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</a>(ids, <font color="#4169E1">sizeof</font>(ids));
<a name="line321">321: </a>    <a href="../../../../docs/manualpages/Sys/PetscOptionsIntArray.html#PetscOptionsIntArray">PetscOptionsIntArray</a>(optname, <font color="#666666">"List of boundary IDs"</font>, <font color="#666666">""</font>, ids, &amp;len, &amp;flg);
<a name="line322">322: </a>    <font color="#4169E1">if</font> (flg) {
<a name="line323">323: </a>      b-&gt;numids = len;
<a name="line324">324: </a>      <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(b-&gt;ids);
<a name="line325">325: </a>      <a href="../../../../docs/manualpages/Sys/PetscMalloc1.html#PetscMalloc1">PetscMalloc1</a>(len, &amp;b-&gt;ids);
<a name="line326">326: </a>      <a href="../../../../docs/manualpages/Sys/PetscArraycpy.html#PetscArraycpy">PetscArraycpy</a>(b-&gt;ids, ids, len);
<a name="line327">327: </a>    }
<a name="line328">328: </a>    len = 1024;
<a name="line329">329: </a>    <a href="../../../../docs/manualpages/Sys/PetscSNPrintf.html#PetscSNPrintf">PetscSNPrintf</a>(optname, <font color="#4169E1">sizeof</font>(optname), <font color="#666666">"-bc_%s_comp"</font>, b-&gt;name);
<a name="line330">330: </a>    <a href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</a>(ids, <font color="#4169E1">sizeof</font>(ids));
<a name="line331">331: </a>    <a href="../../../../docs/manualpages/Sys/PetscOptionsIntArray.html#PetscOptionsIntArray">PetscOptionsIntArray</a>(optname, <font color="#666666">"List of boundary field components"</font>, <font color="#666666">""</font>, ids, &amp;len, &amp;flg);
<a name="line332">332: </a>    <font color="#4169E1">if</font> (flg) {
<a name="line333">333: </a>      b-&gt;numcomps = len;
<a name="line334">334: </a>      <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(b-&gt;comps);
<a name="line335">335: </a>      <a href="../../../../docs/manualpages/Sys/PetscMalloc1.html#PetscMalloc1">PetscMalloc1</a>(len, &amp;b-&gt;comps);
<a name="line336">336: </a>      <a href="../../../../docs/manualpages/Sys/PetscArraycpy.html#PetscArraycpy">PetscArraycpy</a>(b-&gt;comps, ids, len);
<a name="line337">337: </a>    }
<a name="line338">338: </a>  }
<a name="line339">339: </a>  <a href="../../../../docs/manualpages/Sys/PetscOptionsFList.html#PetscOptionsFList">PetscOptionsFList</a>(<font color="#666666">"-petscds_type"</font>, <font color="#666666">"Discrete System"</font>, <font color="#666666">"<a href="../../../../docs/manualpages/DT/PetscDSSetType.html#PetscDSSetType">PetscDSSetType</a>"</font>, PetscDSList, defaultType, name, 256, &amp;flg);
<a name="line340">340: </a>  <font color="#4169E1">if</font> (flg) {
<a name="line341">341: </a>    <a href="../../../../docs/manualpages/DT/PetscDSSetType.html#PetscDSSetType">PetscDSSetType</a>(prob, name);
<a name="line342">342: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (!((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob)-&gt;type_name) {
<a name="line343">343: </a>    <a href="../../../../docs/manualpages/DT/PetscDSSetType.html#PetscDSSetType">PetscDSSetType</a>(prob, defaultType);
<a name="line344">344: </a>  }
<a name="line345">345: </a>  <a href="../../../../docs/manualpages/Sys/PetscOptionsBool.html#PetscOptionsBool">PetscOptionsBool</a>(<font color="#666666">"-petscds_jac_pre"</font>, <font color="#666666">"Discrete System"</font>, <font color="#666666">"<a href="../../../../docs/manualpages/DT/PetscDSUseJacobianPreconditioner.html#PetscDSUseJacobianPreconditioner">PetscDSUseJacobianPreconditioner</a>"</font>, prob-&gt;useJacPre, &amp;prob-&gt;useJacPre, &amp;flg);
<a name="line346">346: </a>  <font color="#4169E1">if</font> (prob-&gt;ops-&gt;setfromoptions) {(*prob-&gt;ops-&gt;setfromoptions)(prob);}
<a name="line347">347: </a>  <font color="#B22222">/* process any options handlers added with <a href="../../../../docs/manualpages/Sys/PetscObjectAddOptionsHandler.html#PetscObjectAddOptionsHandler">PetscObjectAddOptionsHandler</a>() */</font>
<a name="line348">348: </a>  <a href="../../../../docs/manualpages/Sys/PetscObjectProcessOptionsHandlers.html#PetscObjectProcessOptionsHandlers">PetscObjectProcessOptionsHandlers</a>(PetscOptionsObject,(<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob);
<a name="line349">349: </a>  <a href="../../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</a>();
<a name="line350">350: </a>  <font color="#4169E1">if</font> (prob-&gt;Nf) {<a href="../../../../docs/manualpages/DT/PetscDSViewFromOptions.html#PetscDSViewFromOptions">PetscDSViewFromOptions</a>(prob, NULL, <font color="#666666">"-petscds_view"</font>);}
<a name="line351">351: </a>  <font color="#4169E1">return</font>(0);
<a name="line352">352: </a>}

<a name="line354">354: </a><font color="#B22222">/*@C</font>
<a name="line355">355: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetUp.html#PetscDSSetUp">PetscDSSetUp</a> - Construct data structures for the <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>

<a name="line357">357: </a><font color="#B22222">  Collective on prob</font>

<a name="line359">359: </a><font color="#B22222">  Input Parameter:</font>
<a name="line360">360: </a><font color="#B22222">. prob - the <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object to setup</font>

<a name="line362">362: </a><font color="#B22222">  Level: developer</font>

<a name="line364">364: </a><font color="#B22222">.seealso <a href="../../../../docs/manualpages/DT/PetscDSView.html#PetscDSView">PetscDSView</a>(), <a href="../../../../docs/manualpages/DT/PetscDSDestroy.html#PetscDSDestroy">PetscDSDestroy</a>()</font>
<a name="line365">365: </a><font color="#B22222">@*/</font>
<a name="line366">366: </a><strong><font color="#4169E1"><a name="PetscDSSetUp"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetUp.html#PetscDSSetUp">PetscDSSetUp</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob)</font></strong>
<a name="line367">367: </a>{
<a name="line368">368: </a>  const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf = prob-&gt;Nf;
<a name="line369">369: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>       dim, dimEmbed, NbMax = 0, NcMax = 0, NqMax = 0, NsMax = 1, f;

<a name="line374">374: </a>  <font color="#4169E1">if</font> (prob-&gt;setup) <font color="#4169E1">return</font>(0);
<a name="line375">375: </a>  <font color="#B22222">/* Calculate sizes */</font>
<a name="line376">376: </a>  <a href="../../../../docs/manualpages/DT/PetscDSGetSpatialDimension.html#PetscDSGetSpatialDimension">PetscDSGetSpatialDimension</a>(prob, &amp;dim);
<a name="line377">377: </a>  <a href="../../../../docs/manualpages/DT/PetscDSGetCoordinateDimension.html#PetscDSGetCoordinateDimension">PetscDSGetCoordinateDimension</a>(prob, &amp;dimEmbed);
<a name="line378">378: </a>  prob-&gt;totDim = prob-&gt;totComp = 0;
<a name="line379">379: </a>  <a href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</a>(Nf,&amp;prob-&gt;Nc,Nf,&amp;prob-&gt;Nb);
<a name="line380">380: </a>  <a href="../../../../docs/manualpages/Sys/PetscCalloc2.html#PetscCalloc2">PetscCalloc2</a>(Nf+1,&amp;prob-&gt;off,Nf+1,&amp;prob-&gt;offDer);
<a name="line381">381: </a>  <a href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</a>(Nf,&amp;prob-&gt;T,Nf,&amp;prob-&gt;Tf);
<a name="line382">382: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; Nf; ++f) {
<a name="line383">383: </a>    <a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>     obj;
<a name="line384">384: </a>    <a href="../../../../docs/manualpages/Sys/PetscClassId.html#PetscClassId">PetscClassId</a>    id;
<a name="line385">385: </a>    <a href="../../../../docs/manualpages/FE/PetscQuadrature.html#PetscQuadrature">PetscQuadrature</a> q = NULL;
<a name="line386">386: </a>    <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>        Nq = 0, Nb, Nc;

<a name="line388">388: </a>    <a href="../../../../docs/manualpages/DT/PetscDSGetDiscretization.html#PetscDSGetDiscretization">PetscDSGetDiscretization</a>(prob, f, &amp;obj);
<a name="line389">389: </a>    <font color="#4169E1">if</font> (!obj) {
<a name="line390">390: </a>      <font color="#B22222">/* Empty mesh */</font>
<a name="line391">391: </a>      Nb = Nc = 0;
<a name="line392">392: </a>      prob-&gt;T[f] = prob-&gt;Tf[f] = NULL;
<a name="line393">393: </a>    } <font color="#4169E1">else</font> {
<a name="line394">394: </a>      <a href="../../../../docs/manualpages/Sys/PetscObjectGetClassId.html#PetscObjectGetClassId">PetscObjectGetClassId</a>(obj, &amp;id);
<a name="line395">395: </a>      <font color="#4169E1">if</font> (id == PETSCFE_CLASSID)      {
<a name="line396">396: </a>        <a href="../../../../docs/manualpages/FE/PetscFE.html#PetscFE">PetscFE</a> fe = (<a href="../../../../docs/manualpages/FE/PetscFE.html#PetscFE">PetscFE</a>) obj;

<a name="line398">398: </a>        <a href="../../../../docs/manualpages/FE/PetscFEGetQuadrature.html#PetscFEGetQuadrature">PetscFEGetQuadrature</a>(fe, &amp;q);
<a name="line399">399: </a>        <a href="../../../../docs/manualpages/FE/PetscFEGetDimension.html#PetscFEGetDimension">PetscFEGetDimension</a>(fe, &amp;Nb);
<a name="line400">400: </a>        <a href="../../../../docs/manualpages/FE/PetscFEGetNumComponents.html#PetscFEGetNumComponents">PetscFEGetNumComponents</a>(fe, &amp;Nc);
<a name="line401">401: </a>        <a href="../../../../docs/manualpages/FE/PetscFEGetCellTabulation.html#PetscFEGetCellTabulation">PetscFEGetCellTabulation</a>(fe, &amp;prob-&gt;T[f]);
<a name="line402">402: </a>        <a href="../../../../docs/manualpages/FE/PetscFEGetFaceTabulation.html#PetscFEGetFaceTabulation">PetscFEGetFaceTabulation</a>(fe, &amp;prob-&gt;Tf[f]);
<a name="line403">403: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (id == PETSCFV_CLASSID) {
<a name="line404">404: </a>        <a href="../../../../docs/manualpages/FV/PetscFV.html#PetscFV">PetscFV</a> fv = (<a href="../../../../docs/manualpages/FV/PetscFV.html#PetscFV">PetscFV</a>) obj;

<a name="line406">406: </a>        <a href="../../../../docs/manualpages/FV/PetscFVGetQuadrature.html#PetscFVGetQuadrature">PetscFVGetQuadrature</a>(fv, &amp;q);
<a name="line407">407: </a>        <a href="../../../../docs/manualpages/FV/PetscFVGetNumComponents.html#PetscFVGetNumComponents">PetscFVGetNumComponents</a>(fv, &amp;Nc);
<a name="line408">408: </a>        Nb   = Nc;
<a name="line409">409: </a>        <a href="../../../../docs/manualpages/FV/PetscFVGetCellTabulation.html#PetscFVGetCellTabulation">PetscFVGetCellTabulation</a>(fv, &amp;prob-&gt;T[f]);
<a name="line410">410: </a>        <font color="#B22222">/* TODO: should <a href="../../../../docs/manualpages/FV/PetscFV.html#PetscFV">PetscFV</a> also have face tabulation? Otherwise there will be a null pointer in prob-&gt;basisFace */</font>
<a name="line411">411: </a>      } <font color="#4169E1">else</font> <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob), PETSC_ERR_ARG_WRONG, <font color="#666666">"Unknown discretization type for field %d"</font>, f);
<a name="line412">412: </a>    }
<a name="line413">413: </a>    prob-&gt;Nc[f]       = Nc;
<a name="line414">414: </a>    prob-&gt;Nb[f]       = Nb;
<a name="line415">415: </a>    prob-&gt;off[f+1]    = Nc     + prob-&gt;off[f];
<a name="line416">416: </a>    prob-&gt;offDer[f+1] = Nc*dim + prob-&gt;offDer[f];
<a name="line417">417: </a>    <font color="#4169E1">if</font> (q) {<a href="../../../../docs/manualpages/DT/PetscQuadratureGetData.html#PetscQuadratureGetData">PetscQuadratureGetData</a>(q, NULL, NULL, &amp;Nq, NULL, NULL);}
<a name="line418">418: </a>    NqMax          = <a href="../../../../docs/manualpages/Sys/PetscMax.html#PetscMax">PetscMax</a>(NqMax, Nq);
<a name="line419">419: </a>    NbMax          = <a href="../../../../docs/manualpages/Sys/PetscMax.html#PetscMax">PetscMax</a>(NbMax, Nb);
<a name="line420">420: </a>    NcMax          = <a href="../../../../docs/manualpages/Sys/PetscMax.html#PetscMax">PetscMax</a>(NcMax, Nc);
<a name="line421">421: </a>    prob-&gt;totDim  += Nb;
<a name="line422">422: </a>    prob-&gt;totComp += Nc;
<a name="line423">423: </a>    <font color="#B22222">/* There are two faces for all fields but the cohesive field on a hybrid cell */</font>
<a name="line424">424: </a>    <font color="#4169E1">if</font> (prob-&gt;isHybrid &amp;&amp; (f &lt; Nf-1)) prob-&gt;totDim += Nb;
<a name="line425">425: </a>  }
<a name="line426">426: </a>  <font color="#B22222">/* Allocate works space */</font>
<a name="line427">427: </a>  <font color="#4169E1">if</font> (prob-&gt;isHybrid) NsMax = 2;
<a name="line428">428: </a>  <a href="../../../../docs/manualpages/Sys/PetscMalloc3.html#PetscMalloc3">PetscMalloc3</a>(NsMax*prob-&gt;totComp,&amp;prob-&gt;u,NsMax*prob-&gt;totComp,&amp;prob-&gt;u_t,NsMax*prob-&gt;totComp*dimEmbed,&amp;prob-&gt;u_x);
<a name="line429">429: </a>  <a href="../../../../docs/manualpages/Sys/PetscMalloc5.html#PetscMalloc5">PetscMalloc5</a>(dimEmbed,&amp;prob-&gt;x,NbMax*NcMax,&amp;prob-&gt;basisReal,NbMax*NcMax*dimEmbed,&amp;prob-&gt;basisDerReal,NbMax*NcMax,&amp;prob-&gt;testReal,NbMax*NcMax*dimEmbed,&amp;prob-&gt;testDerReal);
<a name="line430">430: </a>  <a href="../../../../docs/manualpages/Sys/PetscMalloc6.html#PetscMalloc6">PetscMalloc6</a>(NsMax*NqMax*NcMax,&amp;prob-&gt;f0,NsMax*NqMax*NcMax*dimEmbed,&amp;prob-&gt;f1,
<a name="line431">431: </a>                      NsMax*NsMax*NqMax*NcMax*NcMax,&amp;prob-&gt;g0,NsMax*NsMax*NqMax*NcMax*NcMax*dimEmbed,&amp;prob-&gt;g1,
<a name="line432">432: </a>                      NsMax*NsMax*NqMax*NcMax*NcMax*dimEmbed,&amp;prob-&gt;g2,NsMax*NsMax*NqMax*NcMax*NcMax*dimEmbed*dimEmbed,&amp;prob-&gt;g3);
<a name="line433">433: </a>  <font color="#4169E1">if</font> (prob-&gt;ops-&gt;setup) {(*prob-&gt;ops-&gt;setup)(prob);}
<a name="line434">434: </a>  prob-&gt;setup = <a href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</a>;
<a name="line435">435: </a>  <font color="#4169E1">return</font>(0);
<a name="line436">436: </a>}

<a name="line438">438: </a><strong><font color="#4169E1"><a name="PetscDSDestroyStructs_Static"></a>static <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDSDestroyStructs_Static(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob)</font></strong>
<a name="line439">439: </a>{

<a name="line443">443: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</a>(prob-&gt;Nc,prob-&gt;Nb);
<a name="line444">444: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</a>(prob-&gt;off,prob-&gt;offDer);
<a name="line445">445: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</a>(prob-&gt;T,prob-&gt;Tf);
<a name="line446">446: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree3.html#PetscFree3">PetscFree3</a>(prob-&gt;u,prob-&gt;u_t,prob-&gt;u_x);
<a name="line447">447: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree5.html#PetscFree5">PetscFree5</a>(prob-&gt;x,prob-&gt;basisReal, prob-&gt;basisDerReal,prob-&gt;testReal,prob-&gt;testDerReal);
<a name="line448">448: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree6.html#PetscFree6">PetscFree6</a>(prob-&gt;f0,prob-&gt;f1,prob-&gt;g0,prob-&gt;g1,prob-&gt;g2,prob-&gt;g3);
<a name="line449">449: </a>  <font color="#4169E1">return</font>(0);
<a name="line450">450: </a>}

<a name="line452">452: </a><strong><font color="#4169E1"><a name="PetscDSEnlarge_Static"></a>static <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDSEnlarge_Static(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfNew)</font></strong>
<a name="line453">453: </a>{
<a name="line454">454: </a>  <a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>      *tmpd;
<a name="line455">455: </a>  <a href="../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a>        *tmpi;
<a name="line456">456: </a>  PetscPointFunc   *tmpobj, *tmpf, *tmpup;
<a name="line457">457: </a>  PetscPointJac    *tmpg, *tmpgp, *tmpgt;
<a name="line458">458: </a>  PetscBdPointFunc *tmpfbd;
<a name="line459">459: </a>  PetscBdPointJac  *tmpgbd, *tmpgpbd;
<a name="line460">460: </a>  PetscRiemannFunc *tmpr;
<a name="line461">461: </a>  PetscSimplePointFunc *tmpexactSol,  *tmpexactSol_t;
<a name="line462">462: </a>  void                **tmpexactCtx, **tmpexactCtx_t;
<a name="line463">463: </a>  void            **tmpctx;
<a name="line464">464: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>          Nf = prob-&gt;Nf, f;
<a name="line465">465: </a>  <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a>    ierr;

<a name="line468">468: </a>  <font color="#4169E1">if</font> (Nf &gt;= NfNew) <font color="#4169E1">return</font>(0);
<a name="line469">469: </a>  prob-&gt;setup = <a href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>;
<a name="line470">470: </a>  PetscDSDestroyStructs_Static(prob);
<a name="line471">471: </a>  <a href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</a>(NfNew, &amp;tmpd, NfNew, &amp;tmpi);
<a name="line472">472: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; Nf; ++f) {tmpd[f] = prob-&gt;disc[f]; tmpi[f] = prob-&gt;implicit[f];}
<a name="line473">473: </a>  <font color="#4169E1">for</font> (f = Nf; f &lt; NfNew; ++f) {tmpd[f] = NULL; tmpi[f] = <a href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</a>;}
<a name="line474">474: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</a>(prob-&gt;disc, prob-&gt;implicit);
<a name="line475">475: </a>  prob-&gt;Nf        = NfNew;
<a name="line476">476: </a>  prob-&gt;disc      = tmpd;
<a name="line477">477: </a>  prob-&gt;implicit  = tmpi;
<a name="line478">478: </a>  <a href="../../../../docs/manualpages/Sys/PetscCalloc7.html#PetscCalloc7">PetscCalloc7</a>(NfNew, &amp;tmpobj, NfNew*2, &amp;tmpf, NfNew*NfNew*4, &amp;tmpg, NfNew*NfNew*4, &amp;tmpgp, NfNew*NfNew*4, &amp;tmpgt, NfNew, &amp;tmpr, NfNew, &amp;tmpctx);
<a name="line479">479: </a>  <a href="../../../../docs/manualpages/Sys/PetscCalloc1.html#PetscCalloc1">PetscCalloc1</a>(NfNew, &amp;tmpup);
<a name="line480">480: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; Nf; ++f) tmpobj[f] = prob-&gt;obj[f];
<a name="line481">481: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; Nf*2; ++f) tmpf[f] = prob-&gt;f[f];
<a name="line482">482: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; Nf*Nf*4; ++f) tmpg[f] = prob-&gt;g[f];
<a name="line483">483: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; Nf*Nf*4; ++f) tmpgp[f] = prob-&gt;gp[f];
<a name="line484">484: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; Nf; ++f) tmpr[f] = prob-&gt;r[f];
<a name="line485">485: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; Nf; ++f) tmpup[f] = prob-&gt;update[f];
<a name="line486">486: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; Nf; ++f) tmpctx[f] = prob-&gt;ctx[f];
<a name="line487">487: </a>  <font color="#4169E1">for</font> (f = Nf; f &lt; NfNew; ++f) tmpobj[f] = NULL;
<a name="line488">488: </a>  <font color="#4169E1">for</font> (f = Nf*2; f &lt; NfNew*2; ++f) tmpf[f] = NULL;
<a name="line489">489: </a>  <font color="#4169E1">for</font> (f = Nf*Nf*4; f &lt; NfNew*NfNew*4; ++f) tmpg[f] = NULL;
<a name="line490">490: </a>  <font color="#4169E1">for</font> (f = Nf*Nf*4; f &lt; NfNew*NfNew*4; ++f) tmpgp[f] = NULL;
<a name="line491">491: </a>  <font color="#4169E1">for</font> (f = Nf*Nf*4; f &lt; NfNew*NfNew*4; ++f) tmpgt[f] = NULL;
<a name="line492">492: </a>  <font color="#4169E1">for</font> (f = Nf; f &lt; NfNew; ++f) tmpr[f] = NULL;
<a name="line493">493: </a>  <font color="#4169E1">for</font> (f = Nf; f &lt; NfNew; ++f) tmpup[f] = NULL;
<a name="line494">494: </a>  <font color="#4169E1">for</font> (f = Nf; f &lt; NfNew; ++f) tmpctx[f] = NULL;
<a name="line495">495: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree7.html#PetscFree7">PetscFree7</a>(prob-&gt;obj, prob-&gt;f, prob-&gt;g, prob-&gt;gp, prob-&gt;gt, prob-&gt;r, prob-&gt;ctx);
<a name="line496">496: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(prob-&gt;update);
<a name="line497">497: </a>  prob-&gt;obj = tmpobj;
<a name="line498">498: </a>  prob-&gt;f   = tmpf;
<a name="line499">499: </a>  prob-&gt;g   = tmpg;
<a name="line500">500: </a>  prob-&gt;gp  = tmpgp;
<a name="line501">501: </a>  prob-&gt;gt  = tmpgt;
<a name="line502">502: </a>  prob-&gt;r   = tmpr;
<a name="line503">503: </a>  prob-&gt;update = tmpup;
<a name="line504">504: </a>  prob-&gt;ctx = tmpctx;
<a name="line505">505: </a>  <a href="../../../../docs/manualpages/Sys/PetscCalloc7.html#PetscCalloc7">PetscCalloc7</a>(NfNew*2, &amp;tmpfbd, NfNew*NfNew*4, &amp;tmpgbd, NfNew*NfNew*4, &amp;tmpgpbd, NfNew, &amp;tmpexactSol, NfNew, &amp;tmpexactCtx, NfNew, &amp;tmpexactSol_t, NfNew, &amp;tmpexactCtx_t);
<a name="line506">506: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; Nf*2; ++f) tmpfbd[f] = prob-&gt;fBd[f];
<a name="line507">507: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; Nf*Nf*4; ++f) tmpgbd[f] = prob-&gt;gBd[f];
<a name="line508">508: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; Nf*Nf*4; ++f) tmpgpbd[f] = prob-&gt;gpBd[f];
<a name="line509">509: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; Nf; ++f) tmpexactSol[f] = prob-&gt;exactSol[f];
<a name="line510">510: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; Nf; ++f) tmpexactCtx[f] = prob-&gt;exactCtx[f];
<a name="line511">511: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; Nf; ++f) tmpexactSol_t[f] = prob-&gt;exactSol_t[f];
<a name="line512">512: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; Nf; ++f) tmpexactCtx_t[f] = prob-&gt;exactCtx_t[f];
<a name="line513">513: </a>  <font color="#4169E1">for</font> (f = Nf*2; f &lt; NfNew*2; ++f) tmpfbd[f] = NULL;
<a name="line514">514: </a>  <font color="#4169E1">for</font> (f = Nf*Nf*4; f &lt; NfNew*NfNew*4; ++f) tmpgbd[f] = NULL;
<a name="line515">515: </a>  <font color="#4169E1">for</font> (f = Nf*Nf*4; f &lt; NfNew*NfNew*4; ++f) tmpgpbd[f] = NULL;
<a name="line516">516: </a>  <font color="#4169E1">for</font> (f = Nf; f &lt; NfNew; ++f) tmpexactSol[f] = NULL;
<a name="line517">517: </a>  <font color="#4169E1">for</font> (f = Nf; f &lt; NfNew; ++f) tmpexactCtx[f] = NULL;
<a name="line518">518: </a>  <font color="#4169E1">for</font> (f = Nf; f &lt; NfNew; ++f) tmpexactSol_t[f] = NULL;
<a name="line519">519: </a>  <font color="#4169E1">for</font> (f = Nf; f &lt; NfNew; ++f) tmpexactCtx_t[f] = NULL;
<a name="line520">520: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree7.html#PetscFree7">PetscFree7</a>(prob-&gt;fBd, prob-&gt;gBd, prob-&gt;gpBd, prob-&gt;exactSol, prob-&gt;exactCtx, prob-&gt;exactSol_t, prob-&gt;exactCtx_t);
<a name="line521">521: </a>  prob-&gt;fBd = tmpfbd;
<a name="line522">522: </a>  prob-&gt;gBd = tmpgbd;
<a name="line523">523: </a>  prob-&gt;gpBd = tmpgpbd;
<a name="line524">524: </a>  prob-&gt;exactSol = tmpexactSol;
<a name="line525">525: </a>  prob-&gt;exactCtx = tmpexactCtx;
<a name="line526">526: </a>  prob-&gt;exactSol_t = tmpexactSol_t;
<a name="line527">527: </a>  prob-&gt;exactCtx_t = tmpexactCtx_t;
<a name="line528">528: </a>  <font color="#4169E1">return</font>(0);
<a name="line529">529: </a>}

<a name="line531">531: </a><font color="#B22222">/*@</font>
<a name="line532">532: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSDestroy.html#PetscDSDestroy">PetscDSDestroy</a> - Destroys a <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line534">534: </a><font color="#B22222">  Collective on prob</font>

<a name="line536">536: </a><font color="#B22222">  Input Parameter:</font>
<a name="line537">537: </a><font color="#B22222">. prob - the <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object to destroy</font>

<a name="line539">539: </a><font color="#B22222">  Level: developer</font>

<a name="line541">541: </a><font color="#B22222">.seealso <a href="../../../../docs/manualpages/DT/PetscDSView.html#PetscDSView">PetscDSView</a>()</font>
<a name="line542">542: </a><font color="#B22222">@*/</font>
<a name="line543">543: </a><strong><font color="#4169E1"><a name="PetscDSDestroy"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSDestroy.html#PetscDSDestroy">PetscDSDestroy</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> *prob)</font></strong>
<a name="line544">544: </a>{
<a name="line545">545: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>       f;
<a name="line546">546: </a>  DSBoundary     next;

<a name="line550">550: </a>  <font color="#4169E1">if</font> (!*prob) <font color="#4169E1">return</font>(0);

<a name="line553">553: </a>  <font color="#4169E1">if</font> (--((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>)(*prob))-&gt;refct &gt; 0) {*prob = NULL; <font color="#4169E1">return</font>(0);}
<a name="line554">554: </a>  ((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) (*prob))-&gt;refct = 0;
<a name="line555">555: </a>  <font color="#4169E1">if</font> ((*prob)-&gt;subprobs) {
<a name="line556">556: </a>    <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, d;

<a name="line558">558: </a>    <a href="../../../../docs/manualpages/DT/PetscDSGetSpatialDimension.html#PetscDSGetSpatialDimension">PetscDSGetSpatialDimension</a>(*prob, &amp;dim);
<a name="line559">559: </a>    <font color="#4169E1">for</font> (d = 0; d &lt; dim; ++d) {<a href="../../../../docs/manualpages/DT/PetscDSDestroy.html#PetscDSDestroy">PetscDSDestroy</a>(&amp;(*prob)-&gt;subprobs[d]);}
<a name="line560">560: </a>  }
<a name="line561">561: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>((*prob)-&gt;subprobs);
<a name="line562">562: </a>  PetscDSDestroyStructs_Static(*prob);
<a name="line563">563: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; (*prob)-&gt;Nf; ++f) {
<a name="line564">564: </a>    <a href="../../../../docs/manualpages/Sys/PetscObjectDereference.html#PetscObjectDereference">PetscObjectDereference</a>((*prob)-&gt;disc[f]);
<a name="line565">565: </a>  }
<a name="line566">566: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</a>((*prob)-&gt;disc, (*prob)-&gt;implicit);
<a name="line567">567: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree7.html#PetscFree7">PetscFree7</a>((*prob)-&gt;obj,(*prob)-&gt;f,(*prob)-&gt;g,(*prob)-&gt;gp,(*prob)-&gt;gt,(*prob)-&gt;r,(*prob)-&gt;ctx);
<a name="line568">568: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>((*prob)-&gt;update);
<a name="line569">569: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree7.html#PetscFree7">PetscFree7</a>((*prob)-&gt;fBd,(*prob)-&gt;gBd,(*prob)-&gt;gpBd,(*prob)-&gt;exactSol,(*prob)-&gt;exactCtx,(*prob)-&gt;exactSol_t,(*prob)-&gt;exactCtx_t);
<a name="line570">570: </a>  <font color="#4169E1">if</font> ((*prob)-&gt;ops-&gt;destroy) {(*(*prob)-&gt;ops-&gt;destroy)(*prob);}
<a name="line571">571: </a>  next = (*prob)-&gt;boundary;
<a name="line572">572: </a>  <font color="#4169E1">while</font> (next) {
<a name="line573">573: </a>    DSBoundary b = next;

<a name="line575">575: </a>    next = b-&gt;next;
<a name="line576">576: </a>    <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(b-&gt;comps);
<a name="line577">577: </a>    <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(b-&gt;ids);
<a name="line578">578: </a>    <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(b-&gt;name);
<a name="line579">579: </a>    <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(b-&gt;labelname);
<a name="line580">580: </a>    <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(b);
<a name="line581">581: </a>  }
<a name="line582">582: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>((*prob)-&gt;constants);
<a name="line583">583: </a>  <a href="../../../../docs/manualpages/Sys/PetscHeaderDestroy.html#PetscHeaderDestroy">PetscHeaderDestroy</a>(prob);
<a name="line584">584: </a>  <font color="#4169E1">return</font>(0);
<a name="line585">585: </a>}

<a name="line587">587: </a><font color="#B22222">/*@</font>
<a name="line588">588: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a> - Creates an empty <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object. The type can then be set with <a href="../../../../docs/manualpages/DT/PetscDSSetType.html#PetscDSSetType">PetscDSSetType</a>().</font>

<a name="line590">590: </a><font color="#B22222">  Collective</font>

<a name="line592">592: </a><font color="#B22222">  Input Parameter:</font>
<a name="line593">593: </a><font color="#B22222">. comm - The communicator for the <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line595">595: </a><font color="#B22222">  Output Parameter:</font>
<a name="line596">596: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line598">598: </a><font color="#B22222">  Level: beginner</font>

<a name="line600">600: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetType.html#PetscDSSetType">PetscDSSetType</a>(), <a href="../../../../docs/manualpages/DT/PETSCDSBASIC.html#PETSCDSBASIC">PETSCDSBASIC</a></font>
<a name="line601">601: </a><font color="#B22222">@*/</font>
<a name="line602">602: </a><strong><font color="#4169E1"><a name="PetscDSCreate"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>(<a href="../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</a> comm, <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> *prob)</font></strong>
<a name="line603">603: </a>{
<a name="line604">604: </a>  <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a>   p;

<a name="line609">609: </a>  *prob  = NULL;
<a name="line610">610: </a>  <a href="../../../../docs/manualpages/DM/PetscDSInitializePackage.html#PetscDSInitializePackage">PetscDSInitializePackage</a>();

<a name="line612">612: </a>  <a href="../../../../docs/manualpages/Sys/PetscHeaderCreate.html#PetscHeaderCreate">PetscHeaderCreate</a>(p, PETSCDS_CLASSID, <font color="#666666">"<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a>"</font>, <font color="#666666">"Discrete System"</font>, <font color="#666666">"<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a>"</font>, comm, <a href="../../../../docs/manualpages/DT/PetscDSDestroy.html#PetscDSDestroy">PetscDSDestroy</a>, <a href="../../../../docs/manualpages/DT/PetscDSView.html#PetscDSView">PetscDSView</a>);

<a name="line614">614: </a>  p-&gt;Nf           = 0;
<a name="line615">615: </a>  p-&gt;setup        = <a href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>;
<a name="line616">616: </a>  p-&gt;numConstants = 0;
<a name="line617">617: </a>  p-&gt;constants    = NULL;
<a name="line618">618: </a>  p-&gt;dimEmbed     = -1;
<a name="line619">619: </a>  p-&gt;useJacPre    = <a href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</a>;

<a name="line621">621: </a>  *prob = p;
<a name="line622">622: </a>  <font color="#4169E1">return</font>(0);
<a name="line623">623: </a>}

<a name="line625">625: </a><font color="#B22222">/*@</font>
<a name="line626">626: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a> - Returns the number of fields in the DS</font>

<a name="line628">628: </a><font color="#B22222">  Not collective</font>

<a name="line630">630: </a><font color="#B22222">  Input Parameter:</font>
<a name="line631">631: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line633">633: </a><font color="#B22222">  Output Parameter:</font>
<a name="line634">634: </a><font color="#B22222">. Nf - The number of fields</font>

<a name="line636">636: </a><font color="#B22222">  Level: beginner</font>

<a name="line638">638: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetSpatialDimension.html#PetscDSGetSpatialDimension">PetscDSGetSpatialDimension</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line639">639: </a><font color="#B22222">@*/</font>
<a name="line640">640: </a><strong><font color="#4169E1"><a name="PetscDSGetNumFields"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *Nf)</font></strong>
<a name="line641">641: </a>{
<a name="line645">645: </a>  *Nf = prob-&gt;Nf;
<a name="line646">646: </a>  <font color="#4169E1">return</font>(0);
<a name="line647">647: </a>}

<a name="line649">649: </a><font color="#B22222">/*@</font>
<a name="line650">650: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetSpatialDimension.html#PetscDSGetSpatialDimension">PetscDSGetSpatialDimension</a> - Returns the spatial dimension of the DS, meaning the topological dimension of the discretizations</font>

<a name="line652">652: </a><font color="#B22222">  Not collective</font>

<a name="line654">654: </a><font color="#B22222">  Input Parameter:</font>
<a name="line655">655: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line657">657: </a><font color="#B22222">  Output Parameter:</font>
<a name="line658">658: </a><font color="#B22222">. dim - The spatial dimension</font>

<a name="line660">660: </a><font color="#B22222">  Level: beginner</font>

<a name="line662">662: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetCoordinateDimension.html#PetscDSGetCoordinateDimension">PetscDSGetCoordinateDimension</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line663">663: </a><font color="#B22222">@*/</font>
<a name="line664">664: </a><strong><font color="#4169E1"><a name="PetscDSGetSpatialDimension"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetSpatialDimension.html#PetscDSGetSpatialDimension">PetscDSGetSpatialDimension</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *dim)</font></strong>
<a name="line665">665: </a>{

<a name="line671">671: </a>  *dim = 0;
<a name="line672">672: </a>  <font color="#4169E1">if</font> (prob-&gt;Nf) {
<a name="line673">673: </a>    <a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>  obj;
<a name="line674">674: </a>    <a href="../../../../docs/manualpages/Sys/PetscClassId.html#PetscClassId">PetscClassId</a> id;

<a name="line676">676: </a>    <a href="../../../../docs/manualpages/DT/PetscDSGetDiscretization.html#PetscDSGetDiscretization">PetscDSGetDiscretization</a>(prob, 0, &amp;obj);
<a name="line677">677: </a>    <font color="#4169E1">if</font> (obj) {
<a name="line678">678: </a>      <a href="../../../../docs/manualpages/Sys/PetscObjectGetClassId.html#PetscObjectGetClassId">PetscObjectGetClassId</a>(obj, &amp;id);
<a name="line679">679: </a>      <font color="#4169E1">if</font> (id == PETSCFE_CLASSID)      {<a href="../../../../docs/manualpages/FE/PetscFEGetSpatialDimension.html#PetscFEGetSpatialDimension">PetscFEGetSpatialDimension</a>((<a href="../../../../docs/manualpages/FE/PetscFE.html#PetscFE">PetscFE</a>) obj, dim);}
<a name="line680">680: </a>      <font color="#4169E1">else</font> <font color="#4169E1">if</font> (id == PETSCFV_CLASSID) {<a href="../../../../docs/manualpages/FV/PetscFVGetSpatialDimension.html#PetscFVGetSpatialDimension">PetscFVGetSpatialDimension</a>((<a href="../../../../docs/manualpages/FV/PetscFV.html#PetscFV">PetscFV</a>) obj, dim);}
<a name="line681">681: </a>      <font color="#4169E1">else</font> <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob), PETSC_ERR_ARG_WRONG, <font color="#666666">"Unknown discretization type for field %d"</font>, 0);
<a name="line682">682: </a>    }
<a name="line683">683: </a>  }
<a name="line684">684: </a>  <font color="#4169E1">return</font>(0);
<a name="line685">685: </a>}

<a name="line687">687: </a><font color="#B22222">/*@</font>
<a name="line688">688: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetCoordinateDimension.html#PetscDSGetCoordinateDimension">PetscDSGetCoordinateDimension</a> - Returns the coordinate dimension of the DS, meaning the dimension of the space into which the discretiaztions are embedded</font>

<a name="line690">690: </a><font color="#B22222">  Not collective</font>

<a name="line692">692: </a><font color="#B22222">  Input Parameter:</font>
<a name="line693">693: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line695">695: </a><font color="#B22222">  Output Parameter:</font>
<a name="line696">696: </a><font color="#B22222">. dimEmbed - The coordinate dimension</font>

<a name="line698">698: </a><font color="#B22222">  Level: beginner</font>

<a name="line700">700: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetCoordinateDimension.html#PetscDSSetCoordinateDimension">PetscDSSetCoordinateDimension</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetSpatialDimension.html#PetscDSGetSpatialDimension">PetscDSGetSpatialDimension</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line701">701: </a><font color="#B22222">@*/</font>
<a name="line702">702: </a><strong><font color="#4169E1"><a name="PetscDSGetCoordinateDimension"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetCoordinateDimension.html#PetscDSGetCoordinateDimension">PetscDSGetCoordinateDimension</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *dimEmbed)</font></strong>
<a name="line703">703: </a>{
<a name="line707">707: </a>  <font color="#4169E1">if</font> (prob-&gt;dimEmbed &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</a>(<a href="../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob), PETSC_ERR_ARG_WRONGSTATE, <font color="#666666">"No coordinate dimension set for this DS"</font>);
<a name="line708">708: </a>  *dimEmbed = prob-&gt;dimEmbed;
<a name="line709">709: </a>  <font color="#4169E1">return</font>(0);
<a name="line710">710: </a>}

<a name="line712">712: </a><font color="#B22222">/*@</font>
<a name="line713">713: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetCoordinateDimension.html#PetscDSSetCoordinateDimension">PetscDSSetCoordinateDimension</a> - Set the coordinate dimension of the DS, meaning the dimension of the space into which the discretiaztions are embedded</font>

<a name="line715">715: </a><font color="#B22222">  Logically collective on prob</font>

<a name="line717">717: </a><font color="#B22222">  Input Parameters:</font>
<a name="line718">718: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line719">719: </a><font color="#B22222">- dimEmbed - The coordinate dimension</font>

<a name="line721">721: </a><font color="#B22222">  Level: beginner</font>

<a name="line723">723: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetCoordinateDimension.html#PetscDSGetCoordinateDimension">PetscDSGetCoordinateDimension</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetSpatialDimension.html#PetscDSGetSpatialDimension">PetscDSGetSpatialDimension</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line724">724: </a><font color="#B22222">@*/</font>
<a name="line725">725: </a><strong><font color="#4169E1"><a name="PetscDSSetCoordinateDimension"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetCoordinateDimension.html#PetscDSSetCoordinateDimension">PetscDSSetCoordinateDimension</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dimEmbed)</font></strong>
<a name="line726">726: </a>{
<a name="line729">729: </a>  <font color="#4169E1">if</font> (dimEmbed &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Coordinate dimension must be non-negative, not %D"</font>, dimEmbed);
<a name="line730">730: </a>  prob-&gt;dimEmbed = dimEmbed;
<a name="line731">731: </a>  <font color="#4169E1">return</font>(0);
<a name="line732">732: </a>}

<a name="line734">734: </a><font color="#B22222">/*@</font>
<a name="line735">735: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetHybrid.html#PetscDSGetHybrid">PetscDSGetHybrid</a> - Returns the flag for a hybrid (cohesive) cell</font>

<a name="line737">737: </a><font color="#B22222">  Not collective</font>

<a name="line739">739: </a><font color="#B22222">  Input Parameter:</font>
<a name="line740">740: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line742">742: </a><font color="#B22222">  Output Parameter:</font>
<a name="line743">743: </a><font color="#B22222">. isHybrid - The flag</font>

<a name="line745">745: </a><font color="#B22222">  Level: developer</font>

<a name="line747">747: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetHybrid.html#PetscDSSetHybrid">PetscDSSetHybrid</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line748">748: </a><font color="#B22222">@*/</font>
<a name="line749">749: </a><strong><font color="#4169E1"><a name="PetscDSGetHybrid"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetHybrid.html#PetscDSGetHybrid">PetscDSGetHybrid</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a> *isHybrid)</font></strong>
<a name="line750">750: </a>{
<a name="line754">754: </a>  *isHybrid = prob-&gt;isHybrid;
<a name="line755">755: </a>  <font color="#4169E1">return</font>(0);
<a name="line756">756: </a>}

<a name="line758">758: </a><font color="#B22222">/*@</font>
<a name="line759">759: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetHybrid.html#PetscDSSetHybrid">PetscDSSetHybrid</a> - Set the flag for a hybrid (cohesive) cell</font>

<a name="line761">761: </a><font color="#B22222">  Not collective</font>

<a name="line763">763: </a><font color="#B22222">  Input Parameters:</font>
<a name="line764">764: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line765">765: </a><font color="#B22222">- isHybrid - The flag</font>

<a name="line767">767: </a><font color="#B22222">  Level: developer</font>

<a name="line769">769: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetHybrid.html#PetscDSGetHybrid">PetscDSGetHybrid</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line770">770: </a><font color="#B22222">@*/</font>
<a name="line771">771: </a><strong><font color="#4169E1"><a name="PetscDSSetHybrid"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetHybrid.html#PetscDSSetHybrid">PetscDSSetHybrid</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a> isHybrid)</font></strong>
<a name="line772">772: </a>{
<a name="line775">775: </a>  prob-&gt;isHybrid = isHybrid;
<a name="line776">776: </a>  <font color="#4169E1">return</font>(0);
<a name="line777">777: </a>}

<a name="line779">779: </a><font color="#B22222">/*@</font>
<a name="line780">780: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetTotalDimension.html#PetscDSGetTotalDimension">PetscDSGetTotalDimension</a> - Returns the total size of the approximation space for this system</font>

<a name="line782">782: </a><font color="#B22222">  Not collective</font>

<a name="line784">784: </a><font color="#B22222">  Input Parameter:</font>
<a name="line785">785: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line787">787: </a><font color="#B22222">  Output Parameter:</font>
<a name="line788">788: </a><font color="#B22222">. dim - The total problem dimension</font>

<a name="line790">790: </a><font color="#B22222">  Level: beginner</font>

<a name="line792">792: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line793">793: </a><font color="#B22222">@*/</font>
<a name="line794">794: </a><strong><font color="#4169E1"><a name="PetscDSGetTotalDimension"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetTotalDimension.html#PetscDSGetTotalDimension">PetscDSGetTotalDimension</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *dim)</font></strong>
<a name="line795">795: </a>{

<a name="line800">800: </a>  <a href="../../../../docs/manualpages/DT/PetscDSSetUp.html#PetscDSSetUp">PetscDSSetUp</a>(prob);
<a name="line802">802: </a>  *dim = prob-&gt;totDim;
<a name="line803">803: </a>  <font color="#4169E1">return</font>(0);
<a name="line804">804: </a>}

<a name="line806">806: </a><font color="#B22222">/*@</font>
<a name="line807">807: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetTotalComponents.html#PetscDSGetTotalComponents">PetscDSGetTotalComponents</a> - Returns the total number of components in this system</font>

<a name="line809">809: </a><font color="#B22222">  Not collective</font>

<a name="line811">811: </a><font color="#B22222">  Input Parameter:</font>
<a name="line812">812: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line814">814: </a><font color="#B22222">  Output Parameter:</font>
<a name="line815">815: </a><font color="#B22222">. dim - The total number of components</font>

<a name="line817">817: </a><font color="#B22222">  Level: beginner</font>

<a name="line819">819: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line820">820: </a><font color="#B22222">@*/</font>
<a name="line821">821: </a><strong><font color="#4169E1"><a name="PetscDSGetTotalComponents"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetTotalComponents.html#PetscDSGetTotalComponents">PetscDSGetTotalComponents</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *Nc)</font></strong>
<a name="line822">822: </a>{

<a name="line827">827: </a>  <a href="../../../../docs/manualpages/DT/PetscDSSetUp.html#PetscDSSetUp">PetscDSSetUp</a>(prob);
<a name="line829">829: </a>  *Nc = prob-&gt;totComp;
<a name="line830">830: </a>  <font color="#4169E1">return</font>(0);
<a name="line831">831: </a>}

<a name="line833">833: </a><font color="#B22222">/*@</font>
<a name="line834">834: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetDiscretization.html#PetscDSGetDiscretization">PetscDSGetDiscretization</a> - Returns the discretization object for the given field</font>

<a name="line836">836: </a><font color="#B22222">  Not collective</font>

<a name="line838">838: </a><font color="#B22222">  Input Parameters:</font>
<a name="line839">839: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line840">840: </a><font color="#B22222">- f - The field number</font>

<a name="line842">842: </a><font color="#B22222">  Output Parameter:</font>
<a name="line843">843: </a><font color="#B22222">. disc - The discretization object</font>

<a name="line845">845: </a><font color="#B22222">  Level: beginner</font>

<a name="line847">847: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetDiscretization.html#PetscDSSetDiscretization">PetscDSSetDiscretization</a>(), <a href="../../../../docs/manualpages/DT/PetscDSAddDiscretization.html#PetscDSAddDiscretization">PetscDSAddDiscretization</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line848">848: </a><font color="#B22222">@*/</font>
<a name="line849">849: </a><strong><font color="#4169E1"><a name="PetscDSGetDiscretization"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetDiscretization.html#PetscDSGetDiscretization">PetscDSGetDiscretization</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a> *disc)</font></strong>
<a name="line850">850: </a>{
<a name="line854">854: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line855">855: </a>  *disc = prob-&gt;disc[f];
<a name="line856">856: </a>  <font color="#4169E1">return</font>(0);
<a name="line857">857: </a>}

<a name="line859">859: </a><font color="#B22222">/*@</font>
<a name="line860">860: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetDiscretization.html#PetscDSSetDiscretization">PetscDSSetDiscretization</a> - Sets the discretization object for the given field</font>

<a name="line862">862: </a><font color="#B22222">  Not collective</font>

<a name="line864">864: </a><font color="#B22222">  Input Parameters:</font>
<a name="line865">865: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line866">866: </a><font color="#B22222">. f - The field number</font>
<a name="line867">867: </a><font color="#B22222">- disc - The discretization object</font>

<a name="line869">869: </a><font color="#B22222">  Level: beginner</font>

<a name="line871">871: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetDiscretization.html#PetscDSGetDiscretization">PetscDSGetDiscretization</a>(), <a href="../../../../docs/manualpages/DT/PetscDSAddDiscretization.html#PetscDSAddDiscretization">PetscDSAddDiscretization</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line872">872: </a><font color="#B22222">@*/</font>
<a name="line873">873: </a><strong><font color="#4169E1"><a name="PetscDSSetDiscretization"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetDiscretization.html#PetscDSSetDiscretization">PetscDSSetDiscretization</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a> disc)</font></strong>
<a name="line874">874: </a>{

<a name="line880">880: </a>  <font color="#4169E1">if</font> (f &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, f);
<a name="line881">881: </a>  PetscDSEnlarge_Static(prob, f+1);
<a name="line882">882: </a>  <a href="../../../../docs/manualpages/Sys/PetscObjectDereference.html#PetscObjectDereference">PetscObjectDereference</a>(prob-&gt;disc[f]);
<a name="line883">883: </a>  prob-&gt;disc[f] = disc;
<a name="line884">884: </a>  <a href="../../../../docs/manualpages/Sys/PetscObjectReference.html#PetscObjectReference">PetscObjectReference</a>(disc);
<a name="line885">885: </a>  <font color="#4169E1">if</font> (disc) {
<a name="line886">886: </a>    <a href="../../../../docs/manualpages/Sys/PetscClassId.html#PetscClassId">PetscClassId</a> id;

<a name="line888">888: </a>    <a href="../../../../docs/manualpages/Sys/PetscObjectGetClassId.html#PetscObjectGetClassId">PetscObjectGetClassId</a>(disc, &amp;id);
<a name="line889">889: </a>    <font color="#4169E1">if</font> (id == PETSCFE_CLASSID) {
<a name="line890">890: </a>      <a href="../../../../docs/manualpages/DT/PetscDSSetImplicit.html#PetscDSSetImplicit">PetscDSSetImplicit</a>(prob, f, <a href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</a>);
<a name="line891">891: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (id == PETSCFV_CLASSID) {
<a name="line892">892: </a>      <a href="../../../../docs/manualpages/DT/PetscDSSetImplicit.html#PetscDSSetImplicit">PetscDSSetImplicit</a>(prob, f, <a href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>);
<a name="line893">893: </a>    }
<a name="line894">894: </a>  }
<a name="line895">895: </a>  <font color="#4169E1">return</font>(0);
<a name="line896">896: </a>}

<a name="line898">898: </a><font color="#B22222">/*@</font>
<a name="line899">899: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSAddDiscretization.html#PetscDSAddDiscretization">PetscDSAddDiscretization</a> - Adds a discretization object</font>

<a name="line901">901: </a><font color="#B22222">  Not collective</font>

<a name="line903">903: </a><font color="#B22222">  Input Parameters:</font>
<a name="line904">904: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line905">905: </a><font color="#B22222">- disc - The boundary discretization object</font>

<a name="line907">907: </a><font color="#B22222">  Level: beginner</font>

<a name="line909">909: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetDiscretization.html#PetscDSGetDiscretization">PetscDSGetDiscretization</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetDiscretization.html#PetscDSSetDiscretization">PetscDSSetDiscretization</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line910">910: </a><font color="#B22222">@*/</font>
<a name="line911">911: </a><strong><font color="#4169E1"><a name="PetscDSAddDiscretization"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSAddDiscretization.html#PetscDSAddDiscretization">PetscDSAddDiscretization</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a> disc)</font></strong>
<a name="line912">912: </a>{

<a name="line916">916: </a>  <a href="../../../../docs/manualpages/DT/PetscDSSetDiscretization.html#PetscDSSetDiscretization">PetscDSSetDiscretization</a>(prob, prob-&gt;Nf, disc);
<a name="line917">917: </a>  <font color="#4169E1">return</font>(0);
<a name="line918">918: </a>}

<a name="line920">920: </a><font color="#B22222">/*@</font>
<a name="line921">921: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetQuadrature.html#PetscDSGetQuadrature">PetscDSGetQuadrature</a> - Returns the quadrature, which must agree for all fields in the DS</font>

<a name="line923">923: </a><font color="#B22222">  Not collective</font>

<a name="line925">925: </a><font color="#B22222">  Input Parameter:</font>
<a name="line926">926: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line928">928: </a><font color="#B22222">  Output Parameter:</font>
<a name="line929">929: </a><font color="#B22222">. q - The quadrature object</font>

<a name="line931">931: </a><font color="#B22222">Level: intermediate</font>

<a name="line933">933: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetImplicit.html#PetscDSSetImplicit">PetscDSSetImplicit</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetDiscretization.html#PetscDSSetDiscretization">PetscDSSetDiscretization</a>(), <a href="../../../../docs/manualpages/DT/PetscDSAddDiscretization.html#PetscDSAddDiscretization">PetscDSAddDiscretization</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line934">934: </a><font color="#B22222">@*/</font>
<a name="line935">935: </a><strong><font color="#4169E1"><a name="PetscDSGetQuadrature"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetQuadrature.html#PetscDSGetQuadrature">PetscDSGetQuadrature</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/FE/PetscQuadrature.html#PetscQuadrature">PetscQuadrature</a> *q)</font></strong>
<a name="line936">936: </a>{
<a name="line937">937: </a>  <a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>    obj;
<a name="line938">938: </a>  <a href="../../../../docs/manualpages/Sys/PetscClassId.html#PetscClassId">PetscClassId</a>   id;

<a name="line942">942: </a>  *q = NULL;
<a name="line943">943: </a>  <font color="#4169E1">if</font> (!prob-&gt;Nf) <font color="#4169E1">return</font>(0);
<a name="line944">944: </a>  <a href="../../../../docs/manualpages/DT/PetscDSGetDiscretization.html#PetscDSGetDiscretization">PetscDSGetDiscretization</a>(prob, 0, &amp;obj);
<a name="line945">945: </a>  <a href="../../../../docs/manualpages/Sys/PetscObjectGetClassId.html#PetscObjectGetClassId">PetscObjectGetClassId</a>(obj, &amp;id);
<a name="line946">946: </a>  <font color="#4169E1">if</font>      (id == PETSCFE_CLASSID) {<a href="../../../../docs/manualpages/FE/PetscFEGetQuadrature.html#PetscFEGetQuadrature">PetscFEGetQuadrature</a>((<a href="../../../../docs/manualpages/FE/PetscFE.html#PetscFE">PetscFE</a>) obj, q);}
<a name="line947">947: </a>  <font color="#4169E1">else</font> <font color="#4169E1">if</font> (id == PETSCFV_CLASSID) {<a href="../../../../docs/manualpages/FV/PetscFVGetQuadrature.html#PetscFVGetQuadrature">PetscFVGetQuadrature</a>((<a href="../../../../docs/manualpages/FV/PetscFV.html#PetscFV">PetscFV</a>) obj, q);}
<a name="line948">948: </a>  <font color="#4169E1">else</font> <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob), PETSC_ERR_ARG_WRONG, <font color="#666666">"Unknown discretization type for field %d"</font>, 0);
<a name="line949">949: </a>  <font color="#4169E1">return</font>(0);
<a name="line950">950: </a>}

<a name="line952">952: </a><font color="#B22222">/*@</font>
<a name="line953">953: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetImplicit.html#PetscDSGetImplicit">PetscDSGetImplicit</a> - Returns the flag for implicit solve for this field. This is just a guide for IMEX</font>

<a name="line955">955: </a><font color="#B22222">  Not collective</font>

<a name="line957">957: </a><font color="#B22222">  Input Parameters:</font>
<a name="line958">958: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line959">959: </a><font color="#B22222">- f - The field number</font>

<a name="line961">961: </a><font color="#B22222">  Output Parameter:</font>
<a name="line962">962: </a><font color="#B22222">. implicit - The flag indicating what kind of solve to use for this field</font>

<a name="line964">964: </a><font color="#B22222">  Level: developer</font>

<a name="line966">966: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetImplicit.html#PetscDSSetImplicit">PetscDSSetImplicit</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetDiscretization.html#PetscDSSetDiscretization">PetscDSSetDiscretization</a>(), <a href="../../../../docs/manualpages/DT/PetscDSAddDiscretization.html#PetscDSAddDiscretization">PetscDSAddDiscretization</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line967">967: </a><font color="#B22222">@*/</font>
<a name="line968">968: </a><strong><font color="#4169E1"><a name="PetscDSGetImplicit"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetImplicit.html#PetscDSGetImplicit">PetscDSGetImplicit</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a> *implicit)</font></strong>
<a name="line969">969: </a>{
<a name="line973">973: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line974">974: </a>  *implicit = prob-&gt;implicit[f];
<a name="line975">975: </a>  <font color="#4169E1">return</font>(0);
<a name="line976">976: </a>}

<a name="line978">978: </a><font color="#B22222">/*@</font>
<a name="line979">979: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetImplicit.html#PetscDSSetImplicit">PetscDSSetImplicit</a> - Set the flag for implicit solve for this field. This is just a guide for IMEX</font>

<a name="line981">981: </a><font color="#B22222">  Not collective</font>

<a name="line983">983: </a><font color="#B22222">  Input Parameters:</font>
<a name="line984">984: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line985">985: </a><font color="#B22222">. f - The field number</font>
<a name="line986">986: </a><font color="#B22222">- implicit - The flag indicating what kind of solve to use for this field</font>

<a name="line988">988: </a><font color="#B22222">  Level: developer</font>

<a name="line990">990: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetImplicit.html#PetscDSGetImplicit">PetscDSGetImplicit</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetDiscretization.html#PetscDSSetDiscretization">PetscDSSetDiscretization</a>(), <a href="../../../../docs/manualpages/DT/PetscDSAddDiscretization.html#PetscDSAddDiscretization">PetscDSAddDiscretization</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line991">991: </a><font color="#B22222">@*/</font>
<a name="line992">992: </a><strong><font color="#4169E1"><a name="PetscDSSetImplicit"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetImplicit.html#PetscDSSetImplicit">PetscDSSetImplicit</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a> implicit)</font></strong>
<a name="line993">993: </a>{
<a name="line996">996: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line997">997: </a>  prob-&gt;implicit[f] = implicit;
<a name="line998">998: </a>  <font color="#4169E1">return</font>(0);
<a name="line999">999: </a>}

<a name="line1001">1001: </a><strong><font color="#4169E1"><a name="PetscDSGetObjective"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDSGetObjective(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f,</font></strong>
<a name="line1002">1002: </a><strong><font color="#4169E1">                                   void (**obj)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1003">1003: </a><strong><font color="#4169E1">                                                const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1004">1004: </a><strong><font color="#4169E1">                                                const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1005">1005: </a><strong><font color="#4169E1">                                                <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> obj[]))</font></strong>
<a name="line1006">1006: </a>{
<a name="line1010">1010: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line1011">1011: </a>  *obj = prob-&gt;obj[f];
<a name="line1012">1012: </a>  <font color="#4169E1">return</font>(0);
<a name="line1013">1013: </a>}

<a name="line1015">1015: </a><strong><font color="#4169E1"><a name="PetscDSSetObjective"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDSSetObjective(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f,</font></strong>
<a name="line1016">1016: </a><strong><font color="#4169E1">                                   void (*obj)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1017">1017: </a><strong><font color="#4169E1">                                               const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1018">1018: </a><strong><font color="#4169E1">                                               const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1019">1019: </a><strong><font color="#4169E1">                                               <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> obj[]))</font></strong>
<a name="line1020">1020: </a>{

<a name="line1026">1026: </a>  <font color="#4169E1">if</font> (f &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, f);
<a name="line1027">1027: </a>  PetscDSEnlarge_Static(prob, f+1);
<a name="line1028">1028: </a>  prob-&gt;obj[f] = obj;
<a name="line1029">1029: </a>  <font color="#4169E1">return</font>(0);
<a name="line1030">1030: </a>}

<a name="line1032">1032: </a><font color="#B22222">/*@C</font>
<a name="line1033">1033: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetResidual.html#PetscDSGetResidual">PetscDSGetResidual</a> - Get the pointwise residual function for a given test field</font>

<a name="line1035">1035: </a><font color="#B22222">  Not collective</font>

<a name="line1037">1037: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1038">1038: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line1039">1039: </a><font color="#B22222">- f    - The test field number</font>

<a name="line1041">1041: </a><font color="#B22222">  Output Parameters:</font>
<a name="line1042">1042: </a><font color="#B22222">+ f0 - integrand for the test function term</font>
<a name="line1043">1043: </a><font color="#B22222">- f1 - integrand for the test function gradient term</font>

<a name="line1045">1045: </a><font color="#B22222">  Note: We are using a first order FEM model for the weak form:</font>

<a name="line1047">1047: </a><font color="#B22222">  \int_\Omega \phi f_0(u, u_t, \nabla u, x, t) + \nabla\phi \cdot {\vec f}_1(u, u_t, \nabla u, x, t)</font>

<a name="line1049">1049: </a><font color="#B22222">The calling sequence for the callbacks f0 and f1 is given by:</font>

<a name="line1051">1051: </a><font color="#B22222">$ f0(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line1052">1052: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line1053">1053: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line1054">1054: </a><font color="#B22222">$    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> f0[])</font>

<a name="line1056">1056: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line1057">1057: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line1058">1058: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line1059">1059: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line1060">1060: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line1061">1061: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line1062">1062: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line1063">1063: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line1064">1064: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line1065">1065: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line1066">1066: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line1067">1067: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line1068">1068: </a><font color="#B22222">. t - current time</font>
<a name="line1069">1069: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line1070">1070: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line1071">1071: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line1072">1072: </a><font color="#B22222">- f0 - output values at the current point</font>

<a name="line1074">1074: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1076">1076: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetResidual.html#PetscDSSetResidual">PetscDSSetResidual</a>()</font>
<a name="line1077">1077: </a><font color="#B22222">@*/</font>
<a name="line1078">1078: </a><strong><font color="#4169E1"><a name="PetscDSGetResidual"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetResidual.html#PetscDSGetResidual">PetscDSGetResidual</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f,</font></strong>
<a name="line1079">1079: </a><strong><font color="#4169E1">                                  void (**f0)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1080">1080: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1081">1081: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1082">1082: </a><strong><font color="#4169E1">                                              <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> f0[]),</font></strong>
<a name="line1083">1083: </a><strong><font color="#4169E1">                                  void (**f1)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1084">1084: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1085">1085: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1086">1086: </a><strong><font color="#4169E1">                                              <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> f1[]))</font></strong>
<a name="line1087">1087: </a>{
<a name="line1090">1090: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line1093">1093: </a>  <font color="#4169E1">return</font>(0);
<a name="line1094">1094: </a>}

<a name="line1096">1096: </a><font color="#B22222">/*@C</font>
<a name="line1097">1097: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetResidual.html#PetscDSSetResidual">PetscDSSetResidual</a> - Set the pointwise residual function for a given test field</font>

<a name="line1099">1099: </a><font color="#B22222">  Not collective</font>

<a name="line1101">1101: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1102">1102: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line1103">1103: </a><font color="#B22222">. f    - The test field number</font>
<a name="line1104">1104: </a><font color="#B22222">. f0 - integrand for the test function term</font>
<a name="line1105">1105: </a><font color="#B22222">- f1 - integrand for the test function gradient term</font>

<a name="line1107">1107: </a><font color="#B22222">  Note: We are using a first order FEM model for the weak form:</font>

<a name="line1109">1109: </a><font color="#B22222">  \int_\Omega \phi f_0(u, u_t, \nabla u, x, t) + \nabla\phi \cdot {\vec f}_1(u, u_t, \nabla u, x, t)</font>

<a name="line1111">1111: </a><font color="#B22222">The calling sequence for the callbacks f0 and f1 is given by:</font>

<a name="line1113">1113: </a><font color="#B22222">$ f0(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line1114">1114: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line1115">1115: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line1116">1116: </a><font color="#B22222">$    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> f0[])</font>

<a name="line1118">1118: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line1119">1119: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line1120">1120: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line1121">1121: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line1122">1122: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line1123">1123: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line1124">1124: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line1125">1125: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line1126">1126: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line1127">1127: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line1128">1128: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line1129">1129: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line1130">1130: </a><font color="#B22222">. t - current time</font>
<a name="line1131">1131: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line1132">1132: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line1133">1133: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line1134">1134: </a><font color="#B22222">- f0 - output values at the current point</font>

<a name="line1136">1136: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1138">1138: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetResidual.html#PetscDSGetResidual">PetscDSGetResidual</a>()</font>
<a name="line1139">1139: </a><font color="#B22222">@*/</font>
<a name="line1140">1140: </a><strong><font color="#4169E1"><a name="PetscDSSetResidual"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetResidual.html#PetscDSSetResidual">PetscDSSetResidual</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f,</font></strong>
<a name="line1141">1141: </a><strong><font color="#4169E1">                                  void (*f0)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1142">1142: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1143">1143: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1144">1144: </a><strong><font color="#4169E1">                                             <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> f0[]),</font></strong>
<a name="line1145">1145: </a><strong><font color="#4169E1">                                  void (*f1)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1146">1146: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1147">1147: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1148">1148: </a><strong><font color="#4169E1">                                             <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> f1[]))</font></strong>
<a name="line1149">1149: </a>{

<a name="line1156">1156: </a>  <font color="#4169E1">if</font> (f &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, f);
<a name="line1157">1157: </a>  PetscDSEnlarge_Static(prob, f+1);
<a name="line1158">1158: </a>  prob-&gt;f[f*2+0] = f0;
<a name="line1159">1159: </a>  prob-&gt;f[f*2+1] = f1;
<a name="line1160">1160: </a>  <font color="#4169E1">return</font>(0);
<a name="line1161">1161: </a>}

<a name="line1163">1163: </a><font color="#B22222">/*@C</font>
<a name="line1164">1164: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSHasJacobian.html#PetscDSHasJacobian">PetscDSHasJacobian</a> - Signals that Jacobian functions have been set</font>

<a name="line1166">1166: </a><font color="#B22222">  Not collective</font>

<a name="line1168">1168: </a><font color="#B22222">  Input Parameter:</font>
<a name="line1169">1169: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>

<a name="line1171">1171: </a><font color="#B22222">  Output Parameter:</font>
<a name="line1172">1172: </a><font color="#B22222">. hasJac - flag that pointwise function for the Jacobian has been set</font>

<a name="line1174">1174: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1176">1176: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetJacobianPreconditioner.html#PetscDSGetJacobianPreconditioner">PetscDSGetJacobianPreconditioner</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetJacobianPreconditioner.html#PetscDSSetJacobianPreconditioner">PetscDSSetJacobianPreconditioner</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetJacobian.html#PetscDSGetJacobian">PetscDSGetJacobian</a>()</font>
<a name="line1177">1177: </a><font color="#B22222">@*/</font>
<a name="line1178">1178: </a><strong><font color="#4169E1"><a name="PetscDSHasJacobian"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSHasJacobian.html#PetscDSHasJacobian">PetscDSHasJacobian</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a> *hasJac)</font></strong>
<a name="line1179">1179: </a>{
<a name="line1180">1180: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, g, h;

<a name="line1184">1184: </a>  *hasJac = <a href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>;
<a name="line1185">1185: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; prob-&gt;Nf; ++f) {
<a name="line1186">1186: </a>    <font color="#4169E1">for</font> (g = 0; g &lt; prob-&gt;Nf; ++g) {
<a name="line1187">1187: </a>      <font color="#4169E1">for</font> (h = 0; h &lt; 4; ++h) {
<a name="line1188">1188: </a>        <font color="#4169E1">if</font> (prob-&gt;g[(f*prob-&gt;Nf + g)*4+h]) *hasJac = <a href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</a>;
<a name="line1189">1189: </a>      }
<a name="line1190">1190: </a>    }
<a name="line1191">1191: </a>  }
<a name="line1192">1192: </a>  <font color="#4169E1">return</font>(0);
<a name="line1193">1193: </a>}

<a name="line1195">1195: </a><font color="#B22222">/*@C</font>
<a name="line1196">1196: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetJacobian.html#PetscDSGetJacobian">PetscDSGetJacobian</a> - Get the pointwise Jacobian function for given test and basis field</font>

<a name="line1198">1198: </a><font color="#B22222">  Not collective</font>

<a name="line1200">1200: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1201">1201: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line1202">1202: </a><font color="#B22222">. f    - The test field number</font>
<a name="line1203">1203: </a><font color="#B22222">- g    - The field number</font>

<a name="line1205">1205: </a><font color="#B22222">  Output Parameters:</font>
<a name="line1206">1206: </a><font color="#B22222">+ g0 - integrand for the test and basis function term</font>
<a name="line1207">1207: </a><font color="#B22222">. g1 - integrand for the test function and basis function gradient term</font>
<a name="line1208">1208: </a><font color="#B22222">. g2 - integrand for the test function gradient and basis function term</font>
<a name="line1209">1209: </a><font color="#B22222">- g3 - integrand for the test function gradient and basis function gradient term</font>

<a name="line1211">1211: </a><font color="#B22222">  Note: We are using a first order FEM model for the weak form:</font>

<a name="line1213">1213: </a><font color="#B22222">  \int_\Omega \phi g_0(u, u_t, \nabla u, x, t) \psi + \phi {\vec g}_1(u, u_t, \nabla u, x, t) \nabla \psi + \nabla\phi \cdot {\vec g}_2(u, u_t, \nabla u, x, t) \psi + \nabla\phi \cdot {\overleftrightarrow g}_3(u, u_t, \nabla u, x, t) \cdot \nabla \psi</font>

<a name="line1215">1215: </a><font color="#B22222">The calling sequence for the callbacks g0, g1, g2 and g3 is given by:</font>

<a name="line1217">1217: </a><font color="#B22222">$ g0(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line1218">1218: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line1219">1219: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line1220">1220: </a><font color="#B22222">$    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[])</font>

<a name="line1222">1222: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line1223">1223: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line1224">1224: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line1225">1225: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line1226">1226: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line1227">1227: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line1228">1228: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line1229">1229: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line1230">1230: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line1231">1231: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line1232">1232: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line1233">1233: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line1234">1234: </a><font color="#B22222">. t - current time</font>
<a name="line1235">1235: </a><font color="#B22222">. u_tShift - the multiplier a for dF/dU_t</font>
<a name="line1236">1236: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line1237">1237: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line1238">1238: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line1239">1239: </a><font color="#B22222">- g0 - output values at the current point</font>

<a name="line1241">1241: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1243">1243: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetJacobian.html#PetscDSSetJacobian">PetscDSSetJacobian</a>()</font>
<a name="line1244">1244: </a><font color="#B22222">@*/</font>
<a name="line1245">1245: </a><strong><font color="#4169E1"><a name="PetscDSGetJacobian"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetJacobian.html#PetscDSGetJacobian">PetscDSGetJacobian</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> g,</font></strong>
<a name="line1246">1246: </a><strong><font color="#4169E1">                                  void (**g0)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1247">1247: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1248">1248: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1249">1249: </a><strong><font color="#4169E1">                                              <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[]),</font></strong>
<a name="line1250">1250: </a><strong><font color="#4169E1">                                  void (**g1)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1251">1251: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1252">1252: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1253">1253: </a><strong><font color="#4169E1">                                              <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g1[]),</font></strong>
<a name="line1254">1254: </a><strong><font color="#4169E1">                                  void (**g2)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1255">1255: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1256">1256: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1257">1257: </a><strong><font color="#4169E1">                                              <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g2[]),</font></strong>
<a name="line1258">1258: </a><strong><font color="#4169E1">                                  void (**g3)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1259">1259: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1260">1260: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1261">1261: </a><strong><font color="#4169E1">                                              <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g3[]))</font></strong>
<a name="line1262">1262: </a>{
<a name="line1265">1265: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line1266">1266: </a>  <font color="#4169E1">if</font> ((g &lt; 0) || (g &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, g, prob-&gt;Nf);
<a name="line1271">1271: </a>  <font color="#4169E1">return</font>(0);
<a name="line1272">1272: </a>}

<a name="line1274">1274: </a><font color="#B22222">/*@C</font>
<a name="line1275">1275: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetJacobian.html#PetscDSSetJacobian">PetscDSSetJacobian</a> - Set the pointwise Jacobian function for given test and basis fields</font>

<a name="line1277">1277: </a><font color="#B22222">  Not collective</font>

<a name="line1279">1279: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1280">1280: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line1281">1281: </a><font color="#B22222">. f    - The test field number</font>
<a name="line1282">1282: </a><font color="#B22222">. g    - The field number</font>
<a name="line1283">1283: </a><font color="#B22222">. g0 - integrand for the test and basis function term</font>
<a name="line1284">1284: </a><font color="#B22222">. g1 - integrand for the test function and basis function gradient term</font>
<a name="line1285">1285: </a><font color="#B22222">. g2 - integrand for the test function gradient and basis function term</font>
<a name="line1286">1286: </a><font color="#B22222">- g3 - integrand for the test function gradient and basis function gradient term</font>

<a name="line1288">1288: </a><font color="#B22222">  Note: We are using a first order FEM model for the weak form:</font>

<a name="line1290">1290: </a><font color="#B22222">  \int_\Omega \phi g_0(u, u_t, \nabla u, x, t) \psi + \phi {\vec g}_1(u, u_t, \nabla u, x, t) \nabla \psi + \nabla\phi \cdot {\vec g}_2(u, u_t, \nabla u, x, t) \psi + \nabla\phi \cdot {\overleftrightarrow g}_3(u, u_t, \nabla u, x, t) \cdot \nabla \psi</font>

<a name="line1292">1292: </a><font color="#B22222">The calling sequence for the callbacks g0, g1, g2 and g3 is given by:</font>

<a name="line1294">1294: </a><font color="#B22222">$ g0(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line1295">1295: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line1296">1296: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line1297">1297: </a><font color="#B22222">$    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[])</font>

<a name="line1299">1299: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line1300">1300: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line1301">1301: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line1302">1302: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line1303">1303: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line1304">1304: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line1305">1305: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line1306">1306: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line1307">1307: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line1308">1308: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line1309">1309: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line1310">1310: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line1311">1311: </a><font color="#B22222">. t - current time</font>
<a name="line1312">1312: </a><font color="#B22222">. u_tShift - the multiplier a for dF/dU_t</font>
<a name="line1313">1313: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line1314">1314: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line1315">1315: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line1316">1316: </a><font color="#B22222">- g0 - output values at the current point</font>

<a name="line1318">1318: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1320">1320: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetJacobian.html#PetscDSGetJacobian">PetscDSGetJacobian</a>()</font>
<a name="line1321">1321: </a><font color="#B22222">@*/</font>
<a name="line1322">1322: </a><strong><font color="#4169E1"><a name="PetscDSSetJacobian"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetJacobian.html#PetscDSSetJacobian">PetscDSSetJacobian</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> g,</font></strong>
<a name="line1323">1323: </a><strong><font color="#4169E1">                                  void (*g0)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1324">1324: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1325">1325: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1326">1326: </a><strong><font color="#4169E1">                                             <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[]),</font></strong>
<a name="line1327">1327: </a><strong><font color="#4169E1">                                  void (*g1)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1328">1328: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1329">1329: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1330">1330: </a><strong><font color="#4169E1">                                             <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g1[]),</font></strong>
<a name="line1331">1331: </a><strong><font color="#4169E1">                                  void (*g2)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1332">1332: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1333">1333: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1334">1334: </a><strong><font color="#4169E1">                                             <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g2[]),</font></strong>
<a name="line1335">1335: </a><strong><font color="#4169E1">                                  void (*g3)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1336">1336: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1337">1337: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1338">1338: </a><strong><font color="#4169E1">                                             <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g3[]))</font></strong>
<a name="line1339">1339: </a>{

<a name="line1348">1348: </a>  <font color="#4169E1">if</font> (f &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, f);
<a name="line1349">1349: </a>  <font color="#4169E1">if</font> (g &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, g);
<a name="line1350">1350: </a>  PetscDSEnlarge_Static(prob, <a href="../../../../docs/manualpages/Sys/PetscMax.html#PetscMax">PetscMax</a>(f, g)+1);
<a name="line1351">1351: </a>  prob-&gt;g[(f*prob-&gt;Nf + g)*4+0] = g0;
<a name="line1352">1352: </a>  prob-&gt;g[(f*prob-&gt;Nf + g)*4+1] = g1;
<a name="line1353">1353: </a>  prob-&gt;g[(f*prob-&gt;Nf + g)*4+2] = g2;
<a name="line1354">1354: </a>  prob-&gt;g[(f*prob-&gt;Nf + g)*4+3] = g3;
<a name="line1355">1355: </a>  <font color="#4169E1">return</font>(0);
<a name="line1356">1356: </a>}

<a name="line1358">1358: </a><font color="#B22222">/*@C</font>
<a name="line1359">1359: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSUseJacobianPreconditioner.html#PetscDSUseJacobianPreconditioner">PetscDSUseJacobianPreconditioner</a> - Whether to construct a Jacobian preconditioner</font>

<a name="line1361">1361: </a><font color="#B22222">  Not collective</font>

<a name="line1363">1363: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1364">1364: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line1365">1365: </a><font color="#B22222">- useJacPre - flag that enables construction of a Jacobian preconditioner</font>

<a name="line1367">1367: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1369">1369: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetJacobianPreconditioner.html#PetscDSGetJacobianPreconditioner">PetscDSGetJacobianPreconditioner</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetJacobianPreconditioner.html#PetscDSSetJacobianPreconditioner">PetscDSSetJacobianPreconditioner</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetJacobian.html#PetscDSGetJacobian">PetscDSGetJacobian</a>()</font>
<a name="line1370">1370: </a><font color="#B22222">@*/</font>
<a name="line1371">1371: </a><strong><font color="#4169E1"><a name="PetscDSUseJacobianPreconditioner"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSUseJacobianPreconditioner.html#PetscDSUseJacobianPreconditioner">PetscDSUseJacobianPreconditioner</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a> useJacPre)</font></strong>
<a name="line1372">1372: </a>{
<a name="line1375">1375: </a>  prob-&gt;useJacPre = useJacPre;
<a name="line1376">1376: </a>  <font color="#4169E1">return</font>(0);
<a name="line1377">1377: </a>}

<a name="line1379">1379: </a><font color="#B22222">/*@C</font>
<a name="line1380">1380: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSHasJacobianPreconditioner.html#PetscDSHasJacobianPreconditioner">PetscDSHasJacobianPreconditioner</a> - Signals that a Jacobian preconditioner matrix has been set</font>

<a name="line1382">1382: </a><font color="#B22222">  Not collective</font>

<a name="line1384">1384: </a><font color="#B22222">  Input Parameter:</font>
<a name="line1385">1385: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>

<a name="line1387">1387: </a><font color="#B22222">  Output Parameter:</font>
<a name="line1388">1388: </a><font color="#B22222">. hasJacPre - flag that pointwise function for Jacobian preconditioner matrix has been set</font>

<a name="line1390">1390: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1392">1392: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetJacobianPreconditioner.html#PetscDSGetJacobianPreconditioner">PetscDSGetJacobianPreconditioner</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetJacobianPreconditioner.html#PetscDSSetJacobianPreconditioner">PetscDSSetJacobianPreconditioner</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetJacobian.html#PetscDSGetJacobian">PetscDSGetJacobian</a>()</font>
<a name="line1393">1393: </a><font color="#B22222">@*/</font>
<a name="line1394">1394: </a><strong><font color="#4169E1"><a name="PetscDSHasJacobianPreconditioner"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSHasJacobianPreconditioner.html#PetscDSHasJacobianPreconditioner">PetscDSHasJacobianPreconditioner</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a> *hasJacPre)</font></strong>
<a name="line1395">1395: </a>{
<a name="line1396">1396: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, g, h;

<a name="line1400">1400: </a>  *hasJacPre = <a href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>;
<a name="line1401">1401: </a>  <font color="#4169E1">if</font> (!prob-&gt;useJacPre) <font color="#4169E1">return</font>(0);
<a name="line1402">1402: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; prob-&gt;Nf; ++f) {
<a name="line1403">1403: </a>    <font color="#4169E1">for</font> (g = 0; g &lt; prob-&gt;Nf; ++g) {
<a name="line1404">1404: </a>      <font color="#4169E1">for</font> (h = 0; h &lt; 4; ++h) {
<a name="line1405">1405: </a>        <font color="#4169E1">if</font> (prob-&gt;gp[(f*prob-&gt;Nf + g)*4+h]) *hasJacPre = <a href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</a>;
<a name="line1406">1406: </a>      }
<a name="line1407">1407: </a>    }
<a name="line1408">1408: </a>  }
<a name="line1409">1409: </a>  <font color="#4169E1">return</font>(0);
<a name="line1410">1410: </a>}

<a name="line1412">1412: </a><font color="#B22222">/*@C</font>
<a name="line1413">1413: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetJacobianPreconditioner.html#PetscDSGetJacobianPreconditioner">PetscDSGetJacobianPreconditioner</a> - Get the pointwise Jacobian preconditioner function for given test and basis field. If this is missing, the system matrix is used to build the preconditioner.</font>

<a name="line1415">1415: </a><font color="#B22222">  Not collective</font>

<a name="line1417">1417: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1418">1418: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line1419">1419: </a><font color="#B22222">. f    - The test field number</font>
<a name="line1420">1420: </a><font color="#B22222">- g    - The field number</font>

<a name="line1422">1422: </a><font color="#B22222">  Output Parameters:</font>
<a name="line1423">1423: </a><font color="#B22222">+ g0 - integrand for the test and basis function term</font>
<a name="line1424">1424: </a><font color="#B22222">. g1 - integrand for the test function and basis function gradient term</font>
<a name="line1425">1425: </a><font color="#B22222">. g2 - integrand for the test function gradient and basis function term</font>
<a name="line1426">1426: </a><font color="#B22222">- g3 - integrand for the test function gradient and basis function gradient term</font>

<a name="line1428">1428: </a><font color="#B22222">  Note: We are using a first order FEM model for the weak form:</font>

<a name="line1430">1430: </a><font color="#B22222">  \int_\Omega \phi g_0(u, u_t, \nabla u, x, t) \psi + \phi {\vec g}_1(u, u_t, \nabla u, x, t) \nabla \psi + \nabla\phi \cdot {\vec g}_2(u, u_t, \nabla u, x, t) \psi + \nabla\phi \cdot {\overleftrightarrow g}_3(u, u_t, \nabla u, x, t) \cdot \nabla \psi</font>

<a name="line1432">1432: </a><font color="#B22222">The calling sequence for the callbacks g0, g1, g2 and g3 is given by:</font>

<a name="line1434">1434: </a><font color="#B22222">$ g0(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line1435">1435: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line1436">1436: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line1437">1437: </a><font color="#B22222">$    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[])</font>

<a name="line1439">1439: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line1440">1440: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line1441">1441: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line1442">1442: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line1443">1443: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line1444">1444: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line1445">1445: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line1446">1446: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line1447">1447: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line1448">1448: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line1449">1449: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line1450">1450: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line1451">1451: </a><font color="#B22222">. t - current time</font>
<a name="line1452">1452: </a><font color="#B22222">. u_tShift - the multiplier a for dF/dU_t</font>
<a name="line1453">1453: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line1454">1454: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line1455">1455: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line1456">1456: </a><font color="#B22222">- g0 - output values at the current point</font>

<a name="line1458">1458: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1460">1460: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetJacobianPreconditioner.html#PetscDSSetJacobianPreconditioner">PetscDSSetJacobianPreconditioner</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetJacobian.html#PetscDSGetJacobian">PetscDSGetJacobian</a>()</font>
<a name="line1461">1461: </a><font color="#B22222">@*/</font>
<a name="line1462">1462: </a><strong><font color="#4169E1"><a name="PetscDSGetJacobianPreconditioner"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetJacobianPreconditioner.html#PetscDSGetJacobianPreconditioner">PetscDSGetJacobianPreconditioner</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> g,</font></strong>
<a name="line1463">1463: </a><strong><font color="#4169E1">                                  void (**g0)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1464">1464: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1465">1465: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1466">1466: </a><strong><font color="#4169E1">                                              <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[]),</font></strong>
<a name="line1467">1467: </a><strong><font color="#4169E1">                                  void (**g1)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1468">1468: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1469">1469: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1470">1470: </a><strong><font color="#4169E1">                                              <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g1[]),</font></strong>
<a name="line1471">1471: </a><strong><font color="#4169E1">                                  void (**g2)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1472">1472: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1473">1473: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1474">1474: </a><strong><font color="#4169E1">                                              <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g2[]),</font></strong>
<a name="line1475">1475: </a><strong><font color="#4169E1">                                  void (**g3)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1476">1476: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1477">1477: </a><strong><font color="#4169E1">                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1478">1478: </a><strong><font color="#4169E1">                                              <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g3[]))</font></strong>
<a name="line1479">1479: </a>{
<a name="line1482">1482: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line1483">1483: </a>  <font color="#4169E1">if</font> ((g &lt; 0) || (g &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, g, prob-&gt;Nf);
<a name="line1488">1488: </a>  <font color="#4169E1">return</font>(0);
<a name="line1489">1489: </a>}

<a name="line1491">1491: </a><font color="#B22222">/*@C</font>
<a name="line1492">1492: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetJacobianPreconditioner.html#PetscDSSetJacobianPreconditioner">PetscDSSetJacobianPreconditioner</a> - Set the pointwise Jacobian preconditioner function for given test and basis fields. If this is missing, the system matrix is used to build the preconditioner.</font>

<a name="line1494">1494: </a><font color="#B22222">  Not collective</font>

<a name="line1496">1496: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1497">1497: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line1498">1498: </a><font color="#B22222">. f    - The test field number</font>
<a name="line1499">1499: </a><font color="#B22222">. g    - The field number</font>
<a name="line1500">1500: </a><font color="#B22222">. g0 - integrand for the test and basis function term</font>
<a name="line1501">1501: </a><font color="#B22222">. g1 - integrand for the test function and basis function gradient term</font>
<a name="line1502">1502: </a><font color="#B22222">. g2 - integrand for the test function gradient and basis function term</font>
<a name="line1503">1503: </a><font color="#B22222">- g3 - integrand for the test function gradient and basis function gradient term</font>

<a name="line1505">1505: </a><font color="#B22222">  Note: We are using a first order FEM model for the weak form:</font>

<a name="line1507">1507: </a><font color="#B22222">  \int_\Omega \phi g_0(u, u_t, \nabla u, x, t) \psi + \phi {\vec g}_1(u, u_t, \nabla u, x, t) \nabla \psi + \nabla\phi \cdot {\vec g}_2(u, u_t, \nabla u, x, t) \psi + \nabla\phi \cdot {\overleftrightarrow g}_3(u, u_t, \nabla u, x, t) \cdot \nabla \psi</font>

<a name="line1509">1509: </a><font color="#B22222">The calling sequence for the callbacks g0, g1, g2 and g3 is given by:</font>

<a name="line1511">1511: </a><font color="#B22222">$ g0(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line1512">1512: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line1513">1513: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line1514">1514: </a><font color="#B22222">$    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[])</font>

<a name="line1516">1516: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line1517">1517: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line1518">1518: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line1519">1519: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line1520">1520: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line1521">1521: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line1522">1522: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line1523">1523: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line1524">1524: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line1525">1525: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line1526">1526: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line1527">1527: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line1528">1528: </a><font color="#B22222">. t - current time</font>
<a name="line1529">1529: </a><font color="#B22222">. u_tShift - the multiplier a for dF/dU_t</font>
<a name="line1530">1530: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line1531">1531: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line1532">1532: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line1533">1533: </a><font color="#B22222">- g0 - output values at the current point</font>

<a name="line1535">1535: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1537">1537: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetJacobianPreconditioner.html#PetscDSGetJacobianPreconditioner">PetscDSGetJacobianPreconditioner</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetJacobian.html#PetscDSSetJacobian">PetscDSSetJacobian</a>()</font>
<a name="line1538">1538: </a><font color="#B22222">@*/</font>
<a name="line1539">1539: </a><strong><font color="#4169E1"><a name="PetscDSSetJacobianPreconditioner"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetJacobianPreconditioner.html#PetscDSSetJacobianPreconditioner">PetscDSSetJacobianPreconditioner</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> g,</font></strong>
<a name="line1540">1540: </a><strong><font color="#4169E1">                                  void (*g0)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1541">1541: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1542">1542: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1543">1543: </a><strong><font color="#4169E1">                                             <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[]),</font></strong>
<a name="line1544">1544: </a><strong><font color="#4169E1">                                  void (*g1)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1545">1545: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1546">1546: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1547">1547: </a><strong><font color="#4169E1">                                             <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g1[]),</font></strong>
<a name="line1548">1548: </a><strong><font color="#4169E1">                                  void (*g2)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1549">1549: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1550">1550: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1551">1551: </a><strong><font color="#4169E1">                                             <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g2[]),</font></strong>
<a name="line1552">1552: </a><strong><font color="#4169E1">                                  void (*g3)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1553">1553: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1554">1554: </a><strong><font color="#4169E1">                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1555">1555: </a><strong><font color="#4169E1">                                             <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g3[]))</font></strong>
<a name="line1556">1556: </a>{

<a name="line1565">1565: </a>  <font color="#4169E1">if</font> (f &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, f);
<a name="line1566">1566: </a>  <font color="#4169E1">if</font> (g &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, g);
<a name="line1567">1567: </a>  PetscDSEnlarge_Static(prob, <a href="../../../../docs/manualpages/Sys/PetscMax.html#PetscMax">PetscMax</a>(f, g)+1);
<a name="line1568">1568: </a>  prob-&gt;gp[(f*prob-&gt;Nf + g)*4+0] = g0;
<a name="line1569">1569: </a>  prob-&gt;gp[(f*prob-&gt;Nf + g)*4+1] = g1;
<a name="line1570">1570: </a>  prob-&gt;gp[(f*prob-&gt;Nf + g)*4+2] = g2;
<a name="line1571">1571: </a>  prob-&gt;gp[(f*prob-&gt;Nf + g)*4+3] = g3;
<a name="line1572">1572: </a>  <font color="#4169E1">return</font>(0);
<a name="line1573">1573: </a>}

<a name="line1575">1575: </a><font color="#B22222">/*@C</font>
<a name="line1576">1576: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSHasDynamicJacobian.html#PetscDSHasDynamicJacobian">PetscDSHasDynamicJacobian</a> - Signals that a dynamic Jacobian, dF/du_t, has been set</font>

<a name="line1578">1578: </a><font color="#B22222">  Not collective</font>

<a name="line1580">1580: </a><font color="#B22222">  Input Parameter:</font>
<a name="line1581">1581: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>

<a name="line1583">1583: </a><font color="#B22222">  Output Parameter:</font>
<a name="line1584">1584: </a><font color="#B22222">. hasDynJac - flag that pointwise function for dynamic Jacobian has been set</font>

<a name="line1586">1586: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1588">1588: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetDynamicJacobian.html#PetscDSGetDynamicJacobian">PetscDSGetDynamicJacobian</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetDynamicJacobian.html#PetscDSSetDynamicJacobian">PetscDSSetDynamicJacobian</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetJacobian.html#PetscDSGetJacobian">PetscDSGetJacobian</a>()</font>
<a name="line1589">1589: </a><font color="#B22222">@*/</font>
<a name="line1590">1590: </a><strong><font color="#4169E1"><a name="PetscDSHasDynamicJacobian"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSHasDynamicJacobian.html#PetscDSHasDynamicJacobian">PetscDSHasDynamicJacobian</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a> *hasDynJac)</font></strong>
<a name="line1591">1591: </a>{
<a name="line1592">1592: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, g, h;

<a name="line1596">1596: </a>  *hasDynJac = <a href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>;
<a name="line1597">1597: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; prob-&gt;Nf; ++f) {
<a name="line1598">1598: </a>    <font color="#4169E1">for</font> (g = 0; g &lt; prob-&gt;Nf; ++g) {
<a name="line1599">1599: </a>      <font color="#4169E1">for</font> (h = 0; h &lt; 4; ++h) {
<a name="line1600">1600: </a>        <font color="#4169E1">if</font> (prob-&gt;gt[(f*prob-&gt;Nf + g)*4+h]) *hasDynJac = <a href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</a>;
<a name="line1601">1601: </a>      }
<a name="line1602">1602: </a>    }
<a name="line1603">1603: </a>  }
<a name="line1604">1604: </a>  <font color="#4169E1">return</font>(0);
<a name="line1605">1605: </a>}

<a name="line1607">1607: </a><font color="#B22222">/*@C</font>
<a name="line1608">1608: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetDynamicJacobian.html#PetscDSGetDynamicJacobian">PetscDSGetDynamicJacobian</a> - Get the pointwise dynamic Jacobian, dF/du_t, function for given test and basis field</font>

<a name="line1610">1610: </a><font color="#B22222">  Not collective</font>

<a name="line1612">1612: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1613">1613: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line1614">1614: </a><font color="#B22222">. f    - The test field number</font>
<a name="line1615">1615: </a><font color="#B22222">- g    - The field number</font>

<a name="line1617">1617: </a><font color="#B22222">  Output Parameters:</font>
<a name="line1618">1618: </a><font color="#B22222">+ g0 - integrand for the test and basis function term</font>
<a name="line1619">1619: </a><font color="#B22222">. g1 - integrand for the test function and basis function gradient term</font>
<a name="line1620">1620: </a><font color="#B22222">. g2 - integrand for the test function gradient and basis function term</font>
<a name="line1621">1621: </a><font color="#B22222">- g3 - integrand for the test function gradient and basis function gradient term</font>

<a name="line1623">1623: </a><font color="#B22222">  Note: We are using a first order FEM model for the weak form:</font>

<a name="line1625">1625: </a><font color="#B22222">  \int_\Omega \phi g_0(u, u_t, \nabla u, x, t) \psi + \phi {\vec g}_1(u, u_t, \nabla u, x, t) \nabla \psi + \nabla\phi \cdot {\vec g}_2(u, u_t, \nabla u, x, t) \psi + \nabla\phi \cdot {\overleftrightarrow g}_3(u, u_t, \nabla u, x, t) \cdot \nabla \psi</font>

<a name="line1627">1627: </a><font color="#B22222">The calling sequence for the callbacks g0, g1, g2 and g3 is given by:</font>

<a name="line1629">1629: </a><font color="#B22222">$ g0(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line1630">1630: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line1631">1631: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line1632">1632: </a><font color="#B22222">$    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[])</font>

<a name="line1634">1634: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line1635">1635: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line1636">1636: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line1637">1637: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line1638">1638: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line1639">1639: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line1640">1640: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line1641">1641: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line1642">1642: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line1643">1643: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line1644">1644: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line1645">1645: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line1646">1646: </a><font color="#B22222">. t - current time</font>
<a name="line1647">1647: </a><font color="#B22222">. u_tShift - the multiplier a for dF/dU_t</font>
<a name="line1648">1648: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line1649">1649: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line1650">1650: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line1651">1651: </a><font color="#B22222">- g0 - output values at the current point</font>

<a name="line1653">1653: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1655">1655: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetJacobian.html#PetscDSSetJacobian">PetscDSSetJacobian</a>()</font>
<a name="line1656">1656: </a><font color="#B22222">@*/</font>
<a name="line1657">1657: </a><strong><font color="#4169E1"><a name="PetscDSGetDynamicJacobian"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetDynamicJacobian.html#PetscDSGetDynamicJacobian">PetscDSGetDynamicJacobian</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> g,</font></strong>
<a name="line1658">1658: </a><strong><font color="#4169E1">                                         void (**g0)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1659">1659: </a><strong><font color="#4169E1">                                                     const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1660">1660: </a><strong><font color="#4169E1">                                                     const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1661">1661: </a><strong><font color="#4169E1">                                                     <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[]),</font></strong>
<a name="line1662">1662: </a><strong><font color="#4169E1">                                         void (**g1)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1663">1663: </a><strong><font color="#4169E1">                                                     const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1664">1664: </a><strong><font color="#4169E1">                                                     const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1665">1665: </a><strong><font color="#4169E1">                                                     <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g1[]),</font></strong>
<a name="line1666">1666: </a><strong><font color="#4169E1">                                         void (**g2)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1667">1667: </a><strong><font color="#4169E1">                                                     const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1668">1668: </a><strong><font color="#4169E1">                                                     const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1669">1669: </a><strong><font color="#4169E1">                                                     <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g2[]),</font></strong>
<a name="line1670">1670: </a><strong><font color="#4169E1">                                         void (**g3)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1671">1671: </a><strong><font color="#4169E1">                                                     const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1672">1672: </a><strong><font color="#4169E1">                                                     const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1673">1673: </a><strong><font color="#4169E1">                                                     <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g3[]))</font></strong>
<a name="line1674">1674: </a>{
<a name="line1677">1677: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line1678">1678: </a>  <font color="#4169E1">if</font> ((g &lt; 0) || (g &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, g, prob-&gt;Nf);
<a name="line1683">1683: </a>  <font color="#4169E1">return</font>(0);
<a name="line1684">1684: </a>}

<a name="line1686">1686: </a><font color="#B22222">/*@C</font>
<a name="line1687">1687: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetDynamicJacobian.html#PetscDSSetDynamicJacobian">PetscDSSetDynamicJacobian</a> - Set the pointwise dynamic Jacobian, dF/du_t, function for given test and basis fields</font>

<a name="line1689">1689: </a><font color="#B22222">  Not collective</font>

<a name="line1691">1691: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1692">1692: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line1693">1693: </a><font color="#B22222">. f    - The test field number</font>
<a name="line1694">1694: </a><font color="#B22222">. g    - The field number</font>
<a name="line1695">1695: </a><font color="#B22222">. g0 - integrand for the test and basis function term</font>
<a name="line1696">1696: </a><font color="#B22222">. g1 - integrand for the test function and basis function gradient term</font>
<a name="line1697">1697: </a><font color="#B22222">. g2 - integrand for the test function gradient and basis function term</font>
<a name="line1698">1698: </a><font color="#B22222">- g3 - integrand for the test function gradient and basis function gradient term</font>

<a name="line1700">1700: </a><font color="#B22222">  Note: We are using a first order FEM model for the weak form:</font>

<a name="line1702">1702: </a><font color="#B22222">  \int_\Omega \phi g_0(u, u_t, \nabla u, x, t) \psi + \phi {\vec g}_1(u, u_t, \nabla u, x, t) \nabla \psi + \nabla\phi \cdot {\vec g}_2(u, u_t, \nabla u, x, t) \psi + \nabla\phi \cdot {\overleftrightarrow g}_3(u, u_t, \nabla u, x, t) \cdot \nabla \psi</font>

<a name="line1704">1704: </a><font color="#B22222">The calling sequence for the callbacks g0, g1, g2 and g3 is given by:</font>

<a name="line1706">1706: </a><font color="#B22222">$ g0(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line1707">1707: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line1708">1708: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line1709">1709: </a><font color="#B22222">$    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[])</font>

<a name="line1711">1711: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line1712">1712: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line1713">1713: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line1714">1714: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line1715">1715: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line1716">1716: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line1717">1717: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line1718">1718: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line1719">1719: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line1720">1720: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line1721">1721: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line1722">1722: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line1723">1723: </a><font color="#B22222">. t - current time</font>
<a name="line1724">1724: </a><font color="#B22222">. u_tShift - the multiplier a for dF/dU_t</font>
<a name="line1725">1725: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line1726">1726: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line1727">1727: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line1728">1728: </a><font color="#B22222">- g0 - output values at the current point</font>

<a name="line1730">1730: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1732">1732: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetJacobian.html#PetscDSGetJacobian">PetscDSGetJacobian</a>()</font>
<a name="line1733">1733: </a><font color="#B22222">@*/</font>
<a name="line1734">1734: </a><strong><font color="#4169E1"><a name="PetscDSSetDynamicJacobian"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetDynamicJacobian.html#PetscDSSetDynamicJacobian">PetscDSSetDynamicJacobian</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> g,</font></strong>
<a name="line1735">1735: </a><strong><font color="#4169E1">                                         void (*g0)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1736">1736: </a><strong><font color="#4169E1">                                                    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1737">1737: </a><strong><font color="#4169E1">                                                    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1738">1738: </a><strong><font color="#4169E1">                                                    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[]),</font></strong>
<a name="line1739">1739: </a><strong><font color="#4169E1">                                         void (*g1)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1740">1740: </a><strong><font color="#4169E1">                                                    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1741">1741: </a><strong><font color="#4169E1">                                                    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1742">1742: </a><strong><font color="#4169E1">                                                    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g1[]),</font></strong>
<a name="line1743">1743: </a><strong><font color="#4169E1">                                         void (*g2)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1744">1744: </a><strong><font color="#4169E1">                                                    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1745">1745: </a><strong><font color="#4169E1">                                                    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1746">1746: </a><strong><font color="#4169E1">                                                    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g2[]),</font></strong>
<a name="line1747">1747: </a><strong><font color="#4169E1">                                         void (*g3)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1748">1748: </a><strong><font color="#4169E1">                                                    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1749">1749: </a><strong><font color="#4169E1">                                                    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1750">1750: </a><strong><font color="#4169E1">                                                    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g3[]))</font></strong>
<a name="line1751">1751: </a>{

<a name="line1760">1760: </a>  <font color="#4169E1">if</font> (f &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, f);
<a name="line1761">1761: </a>  <font color="#4169E1">if</font> (g &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, g);
<a name="line1762">1762: </a>  PetscDSEnlarge_Static(prob, <a href="../../../../docs/manualpages/Sys/PetscMax.html#PetscMax">PetscMax</a>(f, g)+1);
<a name="line1763">1763: </a>  prob-&gt;gt[(f*prob-&gt;Nf + g)*4+0] = g0;
<a name="line1764">1764: </a>  prob-&gt;gt[(f*prob-&gt;Nf + g)*4+1] = g1;
<a name="line1765">1765: </a>  prob-&gt;gt[(f*prob-&gt;Nf + g)*4+2] = g2;
<a name="line1766">1766: </a>  prob-&gt;gt[(f*prob-&gt;Nf + g)*4+3] = g3;
<a name="line1767">1767: </a>  <font color="#4169E1">return</font>(0);
<a name="line1768">1768: </a>}

<a name="line1770">1770: </a><font color="#B22222">/*@C</font>
<a name="line1771">1771: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetRiemannSolver.html#PetscDSGetRiemannSolver">PetscDSGetRiemannSolver</a> - Returns the Riemann solver for the given field</font>

<a name="line1773">1773: </a><font color="#B22222">  Not collective</font>

<a name="line1775">1775: </a><font color="#B22222">  Input Arguments:</font>
<a name="line1776">1776: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line1777">1777: </a><font color="#B22222">- f    - The field number</font>

<a name="line1779">1779: </a><font color="#B22222">  Output Argument:</font>
<a name="line1780">1780: </a><font color="#B22222">. r    - Riemann solver</font>

<a name="line1782">1782: </a><font color="#B22222">  Calling sequence for r:</font>

<a name="line1784">1784: </a><font color="#B22222">$ r(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> uL[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> uR[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> flux[], void *ctx)</font>

<a name="line1786">1786: </a><font color="#B22222">+ dim  - The spatial dimension</font>
<a name="line1787">1787: </a><font color="#B22222">. Nf   - The number of fields</font>
<a name="line1788">1788: </a><font color="#B22222">. x    - The coordinates at a point on the interface</font>
<a name="line1789">1789: </a><font color="#B22222">. n    - The normal vector to the interface</font>
<a name="line1790">1790: </a><font color="#B22222">. uL   - The state vector to the left of the interface</font>
<a name="line1791">1791: </a><font color="#B22222">. uR   - The state vector to the right of the interface</font>
<a name="line1792">1792: </a><font color="#B22222">. flux - output array of flux through the interface</font>
<a name="line1793">1793: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line1794">1794: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line1795">1795: </a><font color="#B22222">- ctx  - optional user context</font>

<a name="line1797">1797: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1799">1799: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetRiemannSolver.html#PetscDSSetRiemannSolver">PetscDSSetRiemannSolver</a>()</font>
<a name="line1800">1800: </a><font color="#B22222">@*/</font>
<a name="line1801">1801: </a><strong><font color="#4169E1"><a name="PetscDSGetRiemannSolver"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetRiemannSolver.html#PetscDSGetRiemannSolver">PetscDSGetRiemannSolver</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f,</font></strong>
<a name="line1802">1802: </a><strong><font color="#4169E1">                                       void (**r)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> uL[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> uR[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> flux[], void *ctx))</font></strong>
<a name="line1803">1803: </a>{
<a name="line1806">1806: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line1808">1808: </a>  *r = prob-&gt;r[f];
<a name="line1809">1809: </a>  <font color="#4169E1">return</font>(0);
<a name="line1810">1810: </a>}

<a name="line1812">1812: </a><font color="#B22222">/*@C</font>
<a name="line1813">1813: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetRiemannSolver.html#PetscDSSetRiemannSolver">PetscDSSetRiemannSolver</a> - Sets the Riemann solver for the given field</font>

<a name="line1815">1815: </a><font color="#B22222">  Not collective</font>

<a name="line1817">1817: </a><font color="#B22222">  Input Arguments:</font>
<a name="line1818">1818: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line1819">1819: </a><font color="#B22222">. f    - The field number</font>
<a name="line1820">1820: </a><font color="#B22222">- r    - Riemann solver</font>

<a name="line1822">1822: </a><font color="#B22222">  Calling sequence for r:</font>

<a name="line1824">1824: </a><font color="#B22222">$ r(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> uL[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> uR[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> flux[], void *ctx)</font>

<a name="line1826">1826: </a><font color="#B22222">+ dim  - The spatial dimension</font>
<a name="line1827">1827: </a><font color="#B22222">. Nf   - The number of fields</font>
<a name="line1828">1828: </a><font color="#B22222">. x    - The coordinates at a point on the interface</font>
<a name="line1829">1829: </a><font color="#B22222">. n    - The normal vector to the interface</font>
<a name="line1830">1830: </a><font color="#B22222">. uL   - The state vector to the left of the interface</font>
<a name="line1831">1831: </a><font color="#B22222">. uR   - The state vector to the right of the interface</font>
<a name="line1832">1832: </a><font color="#B22222">. flux - output array of flux through the interface</font>
<a name="line1833">1833: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line1834">1834: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line1835">1835: </a><font color="#B22222">- ctx  - optional user context</font>

<a name="line1837">1837: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1839">1839: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetRiemannSolver.html#PetscDSGetRiemannSolver">PetscDSGetRiemannSolver</a>()</font>
<a name="line1840">1840: </a><font color="#B22222">@*/</font>
<a name="line1841">1841: </a><strong><font color="#4169E1"><a name="PetscDSSetRiemannSolver"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetRiemannSolver.html#PetscDSSetRiemannSolver">PetscDSSetRiemannSolver</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f,</font></strong>
<a name="line1842">1842: </a><strong><font color="#4169E1">                                       void (*r)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> uL[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> uR[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> flux[], void *ctx))</font></strong>
<a name="line1843">1843: </a>{

<a name="line1849">1849: </a>  <font color="#4169E1">if</font> (f &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, f);
<a name="line1850">1850: </a>  PetscDSEnlarge_Static(prob, f+1);
<a name="line1851">1851: </a>  prob-&gt;r[f] = r;
<a name="line1852">1852: </a>  <font color="#4169E1">return</font>(0);
<a name="line1853">1853: </a>}

<a name="line1855">1855: </a><font color="#B22222">/*@C</font>
<a name="line1856">1856: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetUpdate.html#PetscDSGetUpdate">PetscDSGetUpdate</a> - Get the pointwise update function for a given field</font>

<a name="line1858">1858: </a><font color="#B22222">  Not collective</font>

<a name="line1860">1860: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1861">1861: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line1862">1862: </a><font color="#B22222">- f    - The field number</font>

<a name="line1864">1864: </a><font color="#B22222">  Output Parameters:</font>
<a name="line1865">1865: </a><font color="#B22222">. update - update function</font>

<a name="line1867">1867: </a><font color="#B22222">  Note: The calling sequence for the callback update is given by:</font>

<a name="line1869">1869: </a><font color="#B22222">$ update(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line1870">1870: </a><font color="#B22222">$        const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line1871">1871: </a><font color="#B22222">$        const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line1872">1872: </a><font color="#B22222">$        <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> uNew[])</font>

<a name="line1874">1874: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line1875">1875: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line1876">1876: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line1877">1877: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line1878">1878: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line1879">1879: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line1880">1880: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line1881">1881: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line1882">1882: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line1883">1883: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line1884">1884: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line1885">1885: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line1886">1886: </a><font color="#B22222">. t - current time</font>
<a name="line1887">1887: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line1888">1888: </a><font color="#B22222">- uNew - new value for field at the current point</font>

<a name="line1890">1890: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1892">1892: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetUpdate.html#PetscDSSetUpdate">PetscDSSetUpdate</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetResidual.html#PetscDSSetResidual">PetscDSSetResidual</a>()</font>
<a name="line1893">1893: </a><font color="#B22222">@*/</font>
<a name="line1894">1894: </a><strong><font color="#4169E1"><a name="PetscDSGetUpdate"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetUpdate.html#PetscDSGetUpdate">PetscDSGetUpdate</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f,</font></strong>
<a name="line1895">1895: </a><strong><font color="#4169E1">                                  void (**update)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1896">1896: </a><strong><font color="#4169E1">                                                  const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1897">1897: </a><strong><font color="#4169E1">                                                  const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1898">1898: </a><strong><font color="#4169E1">                                                  <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> uNew[]))</font></strong>
<a name="line1899">1899: </a>{
<a name="line1902">1902: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line1904">1904: </a>  <font color="#4169E1">return</font>(0);
<a name="line1905">1905: </a>}

<a name="line1907">1907: </a><font color="#B22222">/*@C</font>
<a name="line1908">1908: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetUpdate.html#PetscDSSetUpdate">PetscDSSetUpdate</a> - Set the pointwise update function for a given field</font>

<a name="line1910">1910: </a><font color="#B22222">  Not collective</font>

<a name="line1912">1912: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1913">1913: </a><font color="#B22222">+ prob   - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line1914">1914: </a><font color="#B22222">. f      - The field number</font>
<a name="line1915">1915: </a><font color="#B22222">- update - update function</font>

<a name="line1917">1917: </a><font color="#B22222">  Note: The calling sequence for the callback update is given by:</font>

<a name="line1919">1919: </a><font color="#B22222">$ update(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line1920">1920: </a><font color="#B22222">$        const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line1921">1921: </a><font color="#B22222">$        const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line1922">1922: </a><font color="#B22222">$        <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> uNew[])</font>

<a name="line1924">1924: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line1925">1925: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line1926">1926: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line1927">1927: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line1928">1928: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line1929">1929: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line1930">1930: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line1931">1931: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line1932">1932: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line1933">1933: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line1934">1934: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line1935">1935: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line1936">1936: </a><font color="#B22222">. t - current time</font>
<a name="line1937">1937: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line1938">1938: </a><font color="#B22222">- uNew - new field values at the current point</font>

<a name="line1940">1940: </a><font color="#B22222">  Level: intermediate</font>

<a name="line1942">1942: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetResidual.html#PetscDSGetResidual">PetscDSGetResidual</a>()</font>
<a name="line1943">1943: </a><font color="#B22222">@*/</font>
<a name="line1944">1944: </a><strong><font color="#4169E1"><a name="PetscDSSetUpdate"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetUpdate.html#PetscDSSetUpdate">PetscDSSetUpdate</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f,</font></strong>
<a name="line1945">1945: </a><strong><font color="#4169E1">                                void (*update)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line1946">1946: </a><strong><font color="#4169E1">                                               const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line1947">1947: </a><strong><font color="#4169E1">                                               const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line1948">1948: </a><strong><font color="#4169E1">                                               <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> uNew[]))</font></strong>
<a name="line1949">1949: </a>{

<a name="line1955">1955: </a>  <font color="#4169E1">if</font> (f &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, f);
<a name="line1956">1956: </a>  PetscDSEnlarge_Static(prob, f+1);
<a name="line1957">1957: </a>  prob-&gt;update[f] = update;
<a name="line1958">1958: </a>  <font color="#4169E1">return</font>(0);
<a name="line1959">1959: </a>}

<a name="line1961">1961: </a><strong><font color="#4169E1"><a name="PetscDSGetContext"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDSGetContext(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, void **ctx)</font></strong>
<a name="line1962">1962: </a>{
<a name="line1965">1965: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line1967">1967: </a>  *ctx = prob-&gt;ctx[f];
<a name="line1968">1968: </a>  <font color="#4169E1">return</font>(0);
<a name="line1969">1969: </a>}

<a name="line1971">1971: </a><strong><font color="#4169E1"><a name="PetscDSSetContext"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDSSetContext(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, void *ctx)</font></strong>
<a name="line1972">1972: </a>{

<a name="line1977">1977: </a>  <font color="#4169E1">if</font> (f &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, f);
<a name="line1978">1978: </a>  PetscDSEnlarge_Static(prob, f+1);
<a name="line1979">1979: </a>  prob-&gt;ctx[f] = ctx;
<a name="line1980">1980: </a>  <font color="#4169E1">return</font>(0);
<a name="line1981">1981: </a>}

<a name="line1983">1983: </a><font color="#B22222">/*@C</font>
<a name="line1984">1984: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetBdResidual.html#PetscDSGetBdResidual">PetscDSGetBdResidual</a> - Get the pointwise boundary residual function for a given test field</font>

<a name="line1986">1986: </a><font color="#B22222">  Not collective</font>

<a name="line1988">1988: </a><font color="#B22222">  Input Parameters:</font>
<a name="line1989">1989: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line1990">1990: </a><font color="#B22222">- f    - The test field number</font>

<a name="line1992">1992: </a><font color="#B22222">  Output Parameters:</font>
<a name="line1993">1993: </a><font color="#B22222">+ f0 - boundary integrand for the test function term</font>
<a name="line1994">1994: </a><font color="#B22222">- f1 - boundary integrand for the test function gradient term</font>

<a name="line1996">1996: </a><font color="#B22222">  Note: We are using a first order FEM model for the weak form:</font>

<a name="line1998">1998: </a><font color="#B22222">  \int_\Gamma \phi {\vec f}_0(u, u_t, \nabla u, x, t) \cdot \hat n + \nabla\phi \cdot {\overleftrightarrow f}_1(u, u_t, \nabla u, x, t) \cdot \hat n</font>

<a name="line2000">2000: </a><font color="#B22222">The calling sequence for the callbacks f0 and f1 is given by:</font>

<a name="line2002">2002: </a><font color="#B22222">$ f0(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line2003">2003: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line2004">2004: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line2005">2005: </a><font color="#B22222">$    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> f0[])</font>

<a name="line2007">2007: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line2008">2008: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line2009">2009: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line2010">2010: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line2011">2011: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line2012">2012: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line2013">2013: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line2014">2014: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line2015">2015: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line2016">2016: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line2017">2017: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line2018">2018: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line2019">2019: </a><font color="#B22222">. t - current time</font>
<a name="line2020">2020: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line2021">2021: </a><font color="#B22222">. n - unit normal at the current point</font>
<a name="line2022">2022: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line2023">2023: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line2024">2024: </a><font color="#B22222">- f0 - output values at the current point</font>

<a name="line2026">2026: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2028">2028: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetBdResidual.html#PetscDSSetBdResidual">PetscDSSetBdResidual</a>()</font>
<a name="line2029">2029: </a><font color="#B22222">@*/</font>
<a name="line2030">2030: </a><strong><font color="#4169E1"><a name="PetscDSGetBdResidual"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetBdResidual.html#PetscDSGetBdResidual">PetscDSGetBdResidual</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f,</font></strong>
<a name="line2031">2031: </a><strong><font color="#4169E1">                                    void (**f0)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2032">2032: </a><strong><font color="#4169E1">                                                const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2033">2033: </a><strong><font color="#4169E1">                                                const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2034">2034: </a><strong><font color="#4169E1">                                                <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> f0[]),</font></strong>
<a name="line2035">2035: </a><strong><font color="#4169E1">                                    void (**f1)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2036">2036: </a><strong><font color="#4169E1">                                                const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2037">2037: </a><strong><font color="#4169E1">                                                const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2038">2038: </a><strong><font color="#4169E1">                                                <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> f1[]))</font></strong>
<a name="line2039">2039: </a>{
<a name="line2042">2042: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line2045">2045: </a>  <font color="#4169E1">return</font>(0);
<a name="line2046">2046: </a>}

<a name="line2048">2048: </a><font color="#B22222">/*@C</font>
<a name="line2049">2049: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetBdResidual.html#PetscDSSetBdResidual">PetscDSSetBdResidual</a> - Get the pointwise boundary residual function for a given test field</font>

<a name="line2051">2051: </a><font color="#B22222">  Not collective</font>

<a name="line2053">2053: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2054">2054: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line2055">2055: </a><font color="#B22222">. f    - The test field number</font>
<a name="line2056">2056: </a><font color="#B22222">. f0 - boundary integrand for the test function term</font>
<a name="line2057">2057: </a><font color="#B22222">- f1 - boundary integrand for the test function gradient term</font>

<a name="line2059">2059: </a><font color="#B22222">  Note: We are using a first order FEM model for the weak form:</font>

<a name="line2061">2061: </a><font color="#B22222">  \int_\Gamma \phi {\vec f}_0(u, u_t, \nabla u, x, t) \cdot \hat n + \nabla\phi \cdot {\overleftrightarrow f}_1(u, u_t, \nabla u, x, t) \cdot \hat n</font>

<a name="line2063">2063: </a><font color="#B22222">The calling sequence for the callbacks f0 and f1 is given by:</font>

<a name="line2065">2065: </a><font color="#B22222">$ f0(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line2066">2066: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line2067">2067: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line2068">2068: </a><font color="#B22222">$    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> f0[])</font>

<a name="line2070">2070: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line2071">2071: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line2072">2072: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line2073">2073: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line2074">2074: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line2075">2075: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line2076">2076: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line2077">2077: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line2078">2078: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line2079">2079: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line2080">2080: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line2081">2081: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line2082">2082: </a><font color="#B22222">. t - current time</font>
<a name="line2083">2083: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line2084">2084: </a><font color="#B22222">. n - unit normal at the current point</font>
<a name="line2085">2085: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line2086">2086: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line2087">2087: </a><font color="#B22222">- f0 - output values at the current point</font>

<a name="line2089">2089: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2091">2091: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetBdResidual.html#PetscDSGetBdResidual">PetscDSGetBdResidual</a>()</font>
<a name="line2092">2092: </a><font color="#B22222">@*/</font>
<a name="line2093">2093: </a><strong><font color="#4169E1"><a name="PetscDSSetBdResidual"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetBdResidual.html#PetscDSSetBdResidual">PetscDSSetBdResidual</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f,</font></strong>
<a name="line2094">2094: </a><strong><font color="#4169E1">                                    void (*f0)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2095">2095: </a><strong><font color="#4169E1">                                               const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2096">2096: </a><strong><font color="#4169E1">                                               const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2097">2097: </a><strong><font color="#4169E1">                                               <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> f0[]),</font></strong>
<a name="line2098">2098: </a><strong><font color="#4169E1">                                    void (*f1)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2099">2099: </a><strong><font color="#4169E1">                                               const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2100">2100: </a><strong><font color="#4169E1">                                               const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2101">2101: </a><strong><font color="#4169E1">                                               <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> f1[]))</font></strong>
<a name="line2102">2102: </a>{

<a name="line2107">2107: </a>  <font color="#4169E1">if</font> (f &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, f);
<a name="line2108">2108: </a>  PetscDSEnlarge_Static(prob, f+1);
<a name="line2111">2111: </a>  <font color="#4169E1">return</font>(0);
<a name="line2112">2112: </a>}

<a name="line2114">2114: </a><font color="#B22222">/*@</font>
<a name="line2115">2115: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSHasBdJacobian.html#PetscDSHasBdJacobian">PetscDSHasBdJacobian</a> - Signals that boundary Jacobian functions have been set</font>

<a name="line2117">2117: </a><font color="#B22222">  Not collective</font>

<a name="line2119">2119: </a><font color="#B22222">  Input Parameter:</font>
<a name="line2120">2120: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>

<a name="line2122">2122: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2123">2123: </a><font color="#B22222">. hasBdJac - flag that pointwise function for the boundary Jacobian has been set</font>

<a name="line2125">2125: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2127">2127: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSHasJacobian.html#PetscDSHasJacobian">PetscDSHasJacobian</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetBdJacobian.html#PetscDSSetBdJacobian">PetscDSSetBdJacobian</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetBdJacobian.html#PetscDSGetBdJacobian">PetscDSGetBdJacobian</a>()</font>
<a name="line2128">2128: </a><font color="#B22222">@*/</font>
<a name="line2129">2129: </a><strong><font color="#4169E1"><a name="PetscDSHasBdJacobian"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSHasBdJacobian.html#PetscDSHasBdJacobian">PetscDSHasBdJacobian</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a> *hasBdJac)</font></strong>
<a name="line2130">2130: </a>{
<a name="line2131">2131: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, g, h;

<a name="line2135">2135: </a>  *hasBdJac = <a href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>;
<a name="line2136">2136: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; prob-&gt;Nf; ++f) {
<a name="line2137">2137: </a>    <font color="#4169E1">for</font> (g = 0; g &lt; prob-&gt;Nf; ++g) {
<a name="line2138">2138: </a>      <font color="#4169E1">for</font> (h = 0; h &lt; 4; ++h) {
<a name="line2139">2139: </a>        <font color="#4169E1">if</font> (prob-&gt;gBd[(f*prob-&gt;Nf + g)*4+h]) *hasBdJac = <a href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</a>;
<a name="line2140">2140: </a>      }
<a name="line2141">2141: </a>    }
<a name="line2142">2142: </a>  }
<a name="line2143">2143: </a>  <font color="#4169E1">return</font>(0);
<a name="line2144">2144: </a>}

<a name="line2146">2146: </a><font color="#B22222">/*@C</font>
<a name="line2147">2147: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetBdJacobian.html#PetscDSGetBdJacobian">PetscDSGetBdJacobian</a> - Get the pointwise boundary Jacobian function for given test and basis field</font>

<a name="line2149">2149: </a><font color="#B22222">  Not collective</font>

<a name="line2151">2151: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2152">2152: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line2153">2153: </a><font color="#B22222">. f    - The test field number</font>
<a name="line2154">2154: </a><font color="#B22222">- g    - The field number</font>

<a name="line2156">2156: </a><font color="#B22222">  Output Parameters:</font>
<a name="line2157">2157: </a><font color="#B22222">+ g0 - integrand for the test and basis function term</font>
<a name="line2158">2158: </a><font color="#B22222">. g1 - integrand for the test function and basis function gradient term</font>
<a name="line2159">2159: </a><font color="#B22222">. g2 - integrand for the test function gradient and basis function term</font>
<a name="line2160">2160: </a><font color="#B22222">- g3 - integrand for the test function gradient and basis function gradient term</font>

<a name="line2162">2162: </a><font color="#B22222">  Note: We are using a first order FEM model for the weak form:</font>

<a name="line2164">2164: </a><font color="#B22222">  \int_\Gamma \phi {\vec g}_0(u, u_t, \nabla u, x, t) \cdot \hat n \psi + \phi {\vec g}_1(u, u_t, \nabla u, x, t) \cdot \hat n \nabla \psi + \nabla\phi \cdot {\vec g}_2(u, u_t, \nabla u, x, t) \cdot \hat n \psi + \nabla\phi \cdot {\overleftrightarrow g}_3(u, u_t, \nabla u, x, t) \cdot \hat n \cdot \nabla \psi</font>

<a name="line2166">2166: </a><font color="#B22222">The calling sequence for the callbacks g0, g1, g2 and g3 is given by:</font>

<a name="line2168">2168: </a><font color="#B22222">$ g0(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line2169">2169: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line2170">2170: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line2171">2171: </a><font color="#B22222">$    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[])</font>

<a name="line2173">2173: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line2174">2174: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line2175">2175: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line2176">2176: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line2177">2177: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line2178">2178: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line2179">2179: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line2180">2180: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line2181">2181: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line2182">2182: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line2183">2183: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line2184">2184: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line2185">2185: </a><font color="#B22222">. t - current time</font>
<a name="line2186">2186: </a><font color="#B22222">. u_tShift - the multiplier a for dF/dU_t</font>
<a name="line2187">2187: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line2188">2188: </a><font color="#B22222">. n - normal at the current point</font>
<a name="line2189">2189: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line2190">2190: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line2191">2191: </a><font color="#B22222">- g0 - output values at the current point</font>

<a name="line2193">2193: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2195">2195: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetBdJacobian.html#PetscDSSetBdJacobian">PetscDSSetBdJacobian</a>()</font>
<a name="line2196">2196: </a><font color="#B22222">@*/</font>
<a name="line2197">2197: </a><strong><font color="#4169E1"><a name="PetscDSGetBdJacobian"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetBdJacobian.html#PetscDSGetBdJacobian">PetscDSGetBdJacobian</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> g,</font></strong>
<a name="line2198">2198: </a><strong><font color="#4169E1">                                    void (**g0)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2199">2199: </a><strong><font color="#4169E1">                                                const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2200">2200: </a><strong><font color="#4169E1">                                                const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2201">2201: </a><strong><font color="#4169E1">                                                <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[]),</font></strong>
<a name="line2202">2202: </a><strong><font color="#4169E1">                                    void (**g1)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2203">2203: </a><strong><font color="#4169E1">                                                const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2204">2204: </a><strong><font color="#4169E1">                                                const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2205">2205: </a><strong><font color="#4169E1">                                                <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g1[]),</font></strong>
<a name="line2206">2206: </a><strong><font color="#4169E1">                                    void (**g2)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2207">2207: </a><strong><font color="#4169E1">                                                const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2208">2208: </a><strong><font color="#4169E1">                                                const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2209">2209: </a><strong><font color="#4169E1">                                                <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g2[]),</font></strong>
<a name="line2210">2210: </a><strong><font color="#4169E1">                                    void (**g3)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2211">2211: </a><strong><font color="#4169E1">                                                const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2212">2212: </a><strong><font color="#4169E1">                                                const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2213">2213: </a><strong><font color="#4169E1">                                                <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g3[]))</font></strong>
<a name="line2214">2214: </a>{
<a name="line2217">2217: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line2218">2218: </a>  <font color="#4169E1">if</font> ((g &lt; 0) || (g &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, g, prob-&gt;Nf);
<a name="line2223">2223: </a>  <font color="#4169E1">return</font>(0);
<a name="line2224">2224: </a>}

<a name="line2226">2226: </a><font color="#B22222">/*@C</font>
<a name="line2227">2227: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetBdJacobian.html#PetscDSSetBdJacobian">PetscDSSetBdJacobian</a> - Set the pointwise boundary Jacobian function for given test and basis field</font>

<a name="line2229">2229: </a><font color="#B22222">  Not collective</font>

<a name="line2231">2231: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2232">2232: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line2233">2233: </a><font color="#B22222">. f    - The test field number</font>
<a name="line2234">2234: </a><font color="#B22222">. g    - The field number</font>
<a name="line2235">2235: </a><font color="#B22222">. g0 - integrand for the test and basis function term</font>
<a name="line2236">2236: </a><font color="#B22222">. g1 - integrand for the test function and basis function gradient term</font>
<a name="line2237">2237: </a><font color="#B22222">. g2 - integrand for the test function gradient and basis function term</font>
<a name="line2238">2238: </a><font color="#B22222">- g3 - integrand for the test function gradient and basis function gradient term</font>

<a name="line2240">2240: </a><font color="#B22222">  Note: We are using a first order FEM model for the weak form:</font>

<a name="line2242">2242: </a><font color="#B22222">  \int_\Gamma \phi {\vec g}_0(u, u_t, \nabla u, x, t) \cdot \hat n \psi + \phi {\vec g}_1(u, u_t, \nabla u, x, t) \cdot \hat n \nabla \psi + \nabla\phi \cdot {\vec g}_2(u, u_t, \nabla u, x, t) \cdot \hat n \psi + \nabla\phi \cdot {\overleftrightarrow g}_3(u, u_t, \nabla u, x, t) \cdot \hat n \cdot \nabla \psi</font>

<a name="line2244">2244: </a><font color="#B22222">The calling sequence for the callbacks g0, g1, g2 and g3 is given by:</font>

<a name="line2246">2246: </a><font color="#B22222">$ g0(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line2247">2247: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line2248">2248: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line2249">2249: </a><font color="#B22222">$    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[])</font>

<a name="line2251">2251: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line2252">2252: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line2253">2253: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line2254">2254: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line2255">2255: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line2256">2256: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line2257">2257: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line2258">2258: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line2259">2259: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line2260">2260: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line2261">2261: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line2262">2262: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line2263">2263: </a><font color="#B22222">. t - current time</font>
<a name="line2264">2264: </a><font color="#B22222">. u_tShift - the multiplier a for dF/dU_t</font>
<a name="line2265">2265: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line2266">2266: </a><font color="#B22222">. n - normal at the current point</font>
<a name="line2267">2267: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line2268">2268: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line2269">2269: </a><font color="#B22222">- g0 - output values at the current point</font>

<a name="line2271">2271: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2273">2273: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetBdJacobian.html#PetscDSGetBdJacobian">PetscDSGetBdJacobian</a>()</font>
<a name="line2274">2274: </a><font color="#B22222">@*/</font>
<a name="line2275">2275: </a><strong><font color="#4169E1"><a name="PetscDSSetBdJacobian"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetBdJacobian.html#PetscDSSetBdJacobian">PetscDSSetBdJacobian</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> g,</font></strong>
<a name="line2276">2276: </a><strong><font color="#4169E1">                                    void (*g0)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2277">2277: </a><strong><font color="#4169E1">                                               const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2278">2278: </a><strong><font color="#4169E1">                                               const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2279">2279: </a><strong><font color="#4169E1">                                               <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[]),</font></strong>
<a name="line2280">2280: </a><strong><font color="#4169E1">                                    void (*g1)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2281">2281: </a><strong><font color="#4169E1">                                               const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2282">2282: </a><strong><font color="#4169E1">                                               const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2283">2283: </a><strong><font color="#4169E1">                                               <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g1[]),</font></strong>
<a name="line2284">2284: </a><strong><font color="#4169E1">                                    void (*g2)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2285">2285: </a><strong><font color="#4169E1">                                               const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2286">2286: </a><strong><font color="#4169E1">                                               const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2287">2287: </a><strong><font color="#4169E1">                                               <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g2[]),</font></strong>
<a name="line2288">2288: </a><strong><font color="#4169E1">                                    void (*g3)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2289">2289: </a><strong><font color="#4169E1">                                               const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2290">2290: </a><strong><font color="#4169E1">                                               const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2291">2291: </a><strong><font color="#4169E1">                                               <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g3[]))</font></strong>
<a name="line2292">2292: </a>{

<a name="line2301">2301: </a>  <font color="#4169E1">if</font> (f &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, f);
<a name="line2302">2302: </a>  <font color="#4169E1">if</font> (g &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, g);
<a name="line2303">2303: </a>  PetscDSEnlarge_Static(prob, <a href="../../../../docs/manualpages/Sys/PetscMax.html#PetscMax">PetscMax</a>(f, g)+1);
<a name="line2304">2304: </a>  prob-&gt;gBd[(f*prob-&gt;Nf + g)*4+0] = g0;
<a name="line2305">2305: </a>  prob-&gt;gBd[(f*prob-&gt;Nf + g)*4+1] = g1;
<a name="line2306">2306: </a>  prob-&gt;gBd[(f*prob-&gt;Nf + g)*4+2] = g2;
<a name="line2307">2307: </a>  prob-&gt;gBd[(f*prob-&gt;Nf + g)*4+3] = g3;
<a name="line2308">2308: </a>  <font color="#4169E1">return</font>(0);
<a name="line2309">2309: </a>}

<a name="line2311">2311: </a><font color="#B22222">/*@</font>
<a name="line2312">2312: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSHasBdJacobianPreconditioner.html#PetscDSHasBdJacobianPreconditioner">PetscDSHasBdJacobianPreconditioner</a> - Signals that boundary Jacobian preconditioner functions have been set</font>

<a name="line2314">2314: </a><font color="#B22222">  Not collective</font>

<a name="line2316">2316: </a><font color="#B22222">  Input Parameter:</font>
<a name="line2317">2317: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>

<a name="line2319">2319: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2320">2320: </a><font color="#B22222">. hasBdJac - flag that pointwise function for the boundary Jacobian preconditioner has been set</font>

<a name="line2322">2322: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2324">2324: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSHasJacobian.html#PetscDSHasJacobian">PetscDSHasJacobian</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetBdJacobian.html#PetscDSSetBdJacobian">PetscDSSetBdJacobian</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetBdJacobian.html#PetscDSGetBdJacobian">PetscDSGetBdJacobian</a>()</font>
<a name="line2325">2325: </a><font color="#B22222">@*/</font>
<a name="line2326">2326: </a><strong><font color="#4169E1"><a name="PetscDSHasBdJacobianPreconditioner"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSHasBdJacobianPreconditioner.html#PetscDSHasBdJacobianPreconditioner">PetscDSHasBdJacobianPreconditioner</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscBool.html#PetscBool">PetscBool</a> *hasBdJacPre)</font></strong>
<a name="line2327">2327: </a>{
<a name="line2328">2328: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, g, h;

<a name="line2332">2332: </a>  *hasBdJacPre = <a href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</a>;
<a name="line2333">2333: </a>  <font color="#4169E1">for</font> (f = 0; f &lt; prob-&gt;Nf; ++f) {
<a name="line2334">2334: </a>    <font color="#4169E1">for</font> (g = 0; g &lt; prob-&gt;Nf; ++g) {
<a name="line2335">2335: </a>      <font color="#4169E1">for</font> (h = 0; h &lt; 4; ++h) {
<a name="line2336">2336: </a>        <font color="#4169E1">if</font> (prob-&gt;gpBd[(f*prob-&gt;Nf + g)*4+h]) *hasBdJacPre = <a href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</a>;
<a name="line2337">2337: </a>      }
<a name="line2338">2338: </a>    }
<a name="line2339">2339: </a>  }
<a name="line2340">2340: </a>  <font color="#4169E1">return</font>(0);
<a name="line2341">2341: </a>}

<a name="line2343">2343: </a><font color="#B22222">/*@C</font>
<a name="line2344">2344: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetBdJacobianPreconditioner.html#PetscDSGetBdJacobianPreconditioner">PetscDSGetBdJacobianPreconditioner</a> - Get the pointwise boundary Jacobian preconditioner function for given test and basis field</font>

<a name="line2346">2346: </a><font color="#B22222">  Not collective</font>

<a name="line2348">2348: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2349">2349: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line2350">2350: </a><font color="#B22222">. f    - The test field number</font>
<a name="line2351">2351: </a><font color="#B22222">- g    - The field number</font>

<a name="line2353">2353: </a><font color="#B22222">  Output Parameters:</font>
<a name="line2354">2354: </a><font color="#B22222">+ g0 - integrand for the test and basis function term</font>
<a name="line2355">2355: </a><font color="#B22222">. g1 - integrand for the test function and basis function gradient term</font>
<a name="line2356">2356: </a><font color="#B22222">. g2 - integrand for the test function gradient and basis function term</font>
<a name="line2357">2357: </a><font color="#B22222">- g3 - integrand for the test function gradient and basis function gradient term</font>

<a name="line2359">2359: </a><font color="#B22222">  Note: We are using a first order FEM model for the weak form:</font>

<a name="line2361">2361: </a><font color="#B22222">  \int_\Gamma \phi {\vec g}_0(u, u_t, \nabla u, x, t) \cdot \hat n \psi + \phi {\vec g}_1(u, u_t, \nabla u, x, t) \cdot \hat n \nabla \psi + \nabla\phi \cdot {\vec g}_2(u, u_t, \nabla u, x, t) \cdot \hat n \psi + \nabla\phi \cdot {\overleftrightarrow g}_3(u, u_t, \nabla u, x, t) \cdot \hat n \cdot \nabla \psi</font>

<a name="line2363">2363: </a><font color="#B22222">The calling sequence for the callbacks g0, g1, g2 and g3 is given by:</font>

<a name="line2365">2365: </a><font color="#B22222">$ g0(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line2366">2366: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line2367">2367: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line2368">2368: </a><font color="#B22222">$    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[])</font>

<a name="line2370">2370: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line2371">2371: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line2372">2372: </a><font color="#B22222">. NfAux - the number of auxiliary fields</font>
<a name="line2373">2373: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line2374">2374: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line2375">2375: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line2376">2376: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line2377">2377: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line2378">2378: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line2379">2379: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line2380">2380: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line2381">2381: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line2382">2382: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line2383">2383: </a><font color="#B22222">. t - current time</font>
<a name="line2384">2384: </a><font color="#B22222">. u_tShift - the multiplier a for dF/dU_t</font>
<a name="line2385">2385: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line2386">2386: </a><font color="#B22222">. n - normal at the current point</font>
<a name="line2387">2387: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line2388">2388: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line2389">2389: </a><font color="#B22222">- g0 - output values at the current point</font>

<a name="line2391">2391: </a><font color="#B22222">  This is not yet available in Fortran.</font>

<a name="line2393">2393: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2395">2395: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetBdJacobianPreconditioner.html#PetscDSSetBdJacobianPreconditioner">PetscDSSetBdJacobianPreconditioner</a>()</font>
<a name="line2396">2396: </a><font color="#B22222">@*/</font>
<a name="line2397">2397: </a><strong><font color="#4169E1"><a name="PetscDSGetBdJacobianPreconditioner"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetBdJacobianPreconditioner.html#PetscDSGetBdJacobianPreconditioner">PetscDSGetBdJacobianPreconditioner</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> g,</font></strong>
<a name="line2398">2398: </a><strong><font color="#4169E1">                                                  void (**g0)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2399">2399: </a><strong><font color="#4169E1">                                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2400">2400: </a><strong><font color="#4169E1">                                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2401">2401: </a><strong><font color="#4169E1">                                                              <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[]),</font></strong>
<a name="line2402">2402: </a><strong><font color="#4169E1">                                                  void (**g1)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2403">2403: </a><strong><font color="#4169E1">                                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2404">2404: </a><strong><font color="#4169E1">                                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2405">2405: </a><strong><font color="#4169E1">                                                              <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g1[]),</font></strong>
<a name="line2406">2406: </a><strong><font color="#4169E1">                                                  void (**g2)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2407">2407: </a><strong><font color="#4169E1">                                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2408">2408: </a><strong><font color="#4169E1">                                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2409">2409: </a><strong><font color="#4169E1">                                                              <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g2[]),</font></strong>
<a name="line2410">2410: </a><strong><font color="#4169E1">                                                  void (**g3)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2411">2411: </a><strong><font color="#4169E1">                                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2412">2412: </a><strong><font color="#4169E1">                                                              const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2413">2413: </a><strong><font color="#4169E1">                                                              <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g3[]))</font></strong>
<a name="line2414">2414: </a>{
<a name="line2417">2417: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line2418">2418: </a>  <font color="#4169E1">if</font> ((g &lt; 0) || (g &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, g, prob-&gt;Nf);
<a name="line2423">2423: </a>  <font color="#4169E1">return</font>(0);
<a name="line2424">2424: </a>}

<a name="line2426">2426: </a><font color="#B22222">/*@C</font>
<a name="line2427">2427: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetBdJacobianPreconditioner.html#PetscDSSetBdJacobianPreconditioner">PetscDSSetBdJacobianPreconditioner</a> - Set the pointwise boundary Jacobian preconditioner function for given test and basis field</font>

<a name="line2429">2429: </a><font color="#B22222">  Not collective</font>

<a name="line2431">2431: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2432">2432: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line2433">2433: </a><font color="#B22222">. f    - The test field number</font>
<a name="line2434">2434: </a><font color="#B22222">. g    - The field number</font>
<a name="line2435">2435: </a><font color="#B22222">. g0 - integrand for the test and basis function term</font>
<a name="line2436">2436: </a><font color="#B22222">. g1 - integrand for the test function and basis function gradient term</font>
<a name="line2437">2437: </a><font color="#B22222">. g2 - integrand for the test function gradient and basis function term</font>
<a name="line2438">2438: </a><font color="#B22222">- g3 - integrand for the test function gradient and basis function gradient term</font>

<a name="line2440">2440: </a><font color="#B22222">  Note: We are using a first order FEM model for the weak form:</font>

<a name="line2442">2442: </a><font color="#B22222">  \int_\Gamma \phi {\vec g}_0(u, u_t, \nabla u, x, t) \cdot \hat n \psi + \phi {\vec g}_1(u, u_t, \nabla u, x, t) \cdot \hat n \nabla \psi + \nabla\phi \cdot {\vec g}_2(u, u_t, \nabla u, x, t) \cdot \hat n \psi + \nabla\phi \cdot {\overleftrightarrow g}_3(u, u_t, \nabla u, x, t) \cdot \hat n \cdot \nabla \psi</font>

<a name="line2444">2444: </a><font color="#B22222">The calling sequence for the callbacks g0, g1, g2 and g3 is given by:</font>

<a name="line2446">2446: </a><font color="#B22222">$ g0(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line2447">2447: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line2448">2448: </a><font color="#B22222">$    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line2449">2449: </a><font color="#B22222">$    <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[])</font>

<a name="line2451">2451: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line2452">2452: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line2453">2453: </a><font color="#B22222">. NfAux - the number of auxiliary fields</font>
<a name="line2454">2454: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line2455">2455: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line2456">2456: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line2457">2457: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line2458">2458: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line2459">2459: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line2460">2460: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line2461">2461: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line2462">2462: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line2463">2463: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line2464">2464: </a><font color="#B22222">. t - current time</font>
<a name="line2465">2465: </a><font color="#B22222">. u_tShift - the multiplier a for dF/dU_t</font>
<a name="line2466">2466: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line2467">2467: </a><font color="#B22222">. n - normal at the current point</font>
<a name="line2468">2468: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line2469">2469: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line2470">2470: </a><font color="#B22222">- g0 - output values at the current point</font>

<a name="line2472">2472: </a><font color="#B22222">  This is not yet available in Fortran.</font>

<a name="line2474">2474: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2476">2476: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetBdJacobianPreconditioner.html#PetscDSGetBdJacobianPreconditioner">PetscDSGetBdJacobianPreconditioner</a>()</font>
<a name="line2477">2477: </a><font color="#B22222">@*/</font>
<a name="line2478">2478: </a><strong><font color="#4169E1"><a name="PetscDSSetBdJacobianPreconditioner"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetBdJacobianPreconditioner.html#PetscDSSetBdJacobianPreconditioner">PetscDSSetBdJacobianPreconditioner</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> g,</font></strong>
<a name="line2479">2479: </a><strong><font color="#4169E1">                                                  void (*g0)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2480">2480: </a><strong><font color="#4169E1">                                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2481">2481: </a><strong><font color="#4169E1">                                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2482">2482: </a><strong><font color="#4169E1">                                                             <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g0[]),</font></strong>
<a name="line2483">2483: </a><strong><font color="#4169E1">                                                  void (*g1)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2484">2484: </a><strong><font color="#4169E1">                                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2485">2485: </a><strong><font color="#4169E1">                                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2486">2486: </a><strong><font color="#4169E1">                                                             <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g1[]),</font></strong>
<a name="line2487">2487: </a><strong><font color="#4169E1">                                                  void (*g2)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2488">2488: </a><strong><font color="#4169E1">                                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2489">2489: </a><strong><font color="#4169E1">                                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2490">2490: </a><strong><font color="#4169E1">                                                             <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g2[]),</font></strong>
<a name="line2491">2491: </a><strong><font color="#4169E1">                                                  void (*g3)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font></strong>
<a name="line2492">2492: </a><strong><font color="#4169E1">                                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font></strong>
<a name="line2493">2493: </a><strong><font color="#4169E1">                                                             const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font></strong>
<a name="line2494">2494: </a><strong><font color="#4169E1">                                                             <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> u_tShift, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> n[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> g3[]))</font></strong>
<a name="line2495">2495: </a>{

<a name="line2504">2504: </a>  <font color="#4169E1">if</font> (f &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, f);
<a name="line2505">2505: </a>  <font color="#4169E1">if</font> (g &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, g);
<a name="line2506">2506: </a>  PetscDSEnlarge_Static(prob, <a href="../../../../docs/manualpages/Sys/PetscMax.html#PetscMax">PetscMax</a>(f, g)+1);
<a name="line2507">2507: </a>  prob-&gt;gpBd[(f*prob-&gt;Nf + g)*4+0] = g0;
<a name="line2508">2508: </a>  prob-&gt;gpBd[(f*prob-&gt;Nf + g)*4+1] = g1;
<a name="line2509">2509: </a>  prob-&gt;gpBd[(f*prob-&gt;Nf + g)*4+2] = g2;
<a name="line2510">2510: </a>  prob-&gt;gpBd[(f*prob-&gt;Nf + g)*4+3] = g3;
<a name="line2511">2511: </a>  <font color="#4169E1">return</font>(0);
<a name="line2512">2512: </a>}

<a name="line2514">2514: </a><font color="#B22222">/*@C</font>
<a name="line2515">2515: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetExactSolution.html#PetscDSGetExactSolution">PetscDSGetExactSolution</a> - Get the pointwise exact solution function for a given test field</font>

<a name="line2517">2517: </a><font color="#B22222">  Not collective</font>

<a name="line2519">2519: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2520">2520: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line2521">2521: </a><font color="#B22222">- f    - The test field number</font>

<a name="line2523">2523: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2524">2524: </a><font color="#B22222">+ exactSol - exact solution for the test field</font>
<a name="line2525">2525: </a><font color="#B22222">- exactCtx - exact solution context</font>

<a name="line2527">2527: </a><font color="#B22222">  Note: The calling sequence for the solution functions is given by:</font>

<a name="line2529">2529: </a><font color="#B22222">$ sol(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], void *ctx)</font>

<a name="line2531">2531: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line2532">2532: </a><font color="#B22222">. t - current time</font>
<a name="line2533">2533: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line2534">2534: </a><font color="#B22222">. Nc - the number of field components</font>
<a name="line2535">2535: </a><font color="#B22222">. u - the solution field evaluated at the current point</font>
<a name="line2536">2536: </a><font color="#B22222">- ctx - a user context</font>

<a name="line2538">2538: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2540">2540: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetExactSolution.html#PetscDSSetExactSolution">PetscDSSetExactSolution</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetExactSolutionTimeDerivative.html#PetscDSGetExactSolutionTimeDerivative">PetscDSGetExactSolutionTimeDerivative</a>()</font>
<a name="line2541">2541: </a><font color="#B22222">@*/</font>
<a name="line2542">2542: </a><strong><font color="#4169E1"><a name="PetscDSGetExactSolution"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetExactSolution.html#PetscDSGetExactSolution">PetscDSGetExactSolution</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> (**sol)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], void *ctx), void **ctx)</font></strong>
<a name="line2543">2543: </a>{
<a name="line2546">2546: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line2549">2549: </a>  <font color="#4169E1">return</font>(0);
<a name="line2550">2550: </a>}

<a name="line2552">2552: </a><font color="#B22222">/*@C</font>
<a name="line2553">2553: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetExactSolution.html#PetscDSSetExactSolution">PetscDSSetExactSolution</a> - Set the pointwise exact solution function for a given test field</font>

<a name="line2555">2555: </a><font color="#B22222">  Not collective</font>

<a name="line2557">2557: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2558">2558: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line2559">2559: </a><font color="#B22222">. f    - The test field number</font>
<a name="line2560">2560: </a><font color="#B22222">. sol  - solution function for the test fields</font>
<a name="line2561">2561: </a><font color="#B22222">- ctx  - solution context or NULL</font>

<a name="line2563">2563: </a><font color="#B22222">  Note: The calling sequence for solution functions is given by:</font>

<a name="line2565">2565: </a><font color="#B22222">$ sol(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], void *ctx)</font>

<a name="line2567">2567: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line2568">2568: </a><font color="#B22222">. t - current time</font>
<a name="line2569">2569: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line2570">2570: </a><font color="#B22222">. Nc - the number of field components</font>
<a name="line2571">2571: </a><font color="#B22222">. u - the solution field evaluated at the current point</font>
<a name="line2572">2572: </a><font color="#B22222">- ctx - a user context</font>

<a name="line2574">2574: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2576">2576: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetExactSolution.html#PetscDSGetExactSolution">PetscDSGetExactSolution</a>()</font>
<a name="line2577">2577: </a><font color="#B22222">@*/</font>
<a name="line2578">2578: </a><strong><font color="#4169E1"><a name="PetscDSSetExactSolution"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetExactSolution.html#PetscDSSetExactSolution">PetscDSSetExactSolution</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> (*sol)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], void *ctx), void *ctx)</font></strong>
<a name="line2579">2579: </a>{

<a name="line2584">2584: </a>  <font color="#4169E1">if</font> (f &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, f);
<a name="line2585">2585: </a>  PetscDSEnlarge_Static(prob, f+1);
<a name="line2588">2588: </a>  <font color="#4169E1">return</font>(0);
<a name="line2589">2589: </a>}

<a name="line2591">2591: </a><font color="#B22222">/*@C</font>
<a name="line2592">2592: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetExactSolutionTimeDerivative.html#PetscDSGetExactSolutionTimeDerivative">PetscDSGetExactSolutionTimeDerivative</a> - Get the pointwise time derivative of the exact solution function for a given test field</font>

<a name="line2594">2594: </a><font color="#B22222">  Not collective</font>

<a name="line2596">2596: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2597">2597: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line2598">2598: </a><font color="#B22222">- f    - The test field number</font>

<a name="line2600">2600: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2601">2601: </a><font color="#B22222">+ exactSol - time derivative of the exact solution for the test field</font>
<a name="line2602">2602: </a><font color="#B22222">- exactCtx - time derivative of the exact solution context</font>

<a name="line2604">2604: </a><font color="#B22222">  Note: The calling sequence for the solution functions is given by:</font>

<a name="line2606">2606: </a><font color="#B22222">$ sol(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], void *ctx)</font>

<a name="line2608">2608: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line2609">2609: </a><font color="#B22222">. t - current time</font>
<a name="line2610">2610: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line2611">2611: </a><font color="#B22222">. Nc - the number of field components</font>
<a name="line2612">2612: </a><font color="#B22222">. u - the solution field evaluated at the current point</font>
<a name="line2613">2613: </a><font color="#B22222">- ctx - a user context</font>

<a name="line2615">2615: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2617">2617: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetExactSolutionTimeDerivative.html#PetscDSSetExactSolutionTimeDerivative">PetscDSSetExactSolutionTimeDerivative</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetExactSolution.html#PetscDSGetExactSolution">PetscDSGetExactSolution</a>()</font>
<a name="line2618">2618: </a><font color="#B22222">@*/</font>
<a name="line2619">2619: </a><strong><font color="#4169E1"><a name="PetscDSGetExactSolutionTimeDerivative"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetExactSolutionTimeDerivative.html#PetscDSGetExactSolutionTimeDerivative">PetscDSGetExactSolutionTimeDerivative</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> (**sol)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], void *ctx), void **ctx)</font></strong>
<a name="line2620">2620: </a>{
<a name="line2623">2623: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line2626">2626: </a>  <font color="#4169E1">return</font>(0);
<a name="line2627">2627: </a>}

<a name="line2629">2629: </a><font color="#B22222">/*@C</font>
<a name="line2630">2630: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetExactSolutionTimeDerivative.html#PetscDSSetExactSolutionTimeDerivative">PetscDSSetExactSolutionTimeDerivative</a> - Set the pointwise time derivative of the exact solution function for a given test field</font>

<a name="line2632">2632: </a><font color="#B22222">  Not collective</font>

<a name="line2634">2634: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2635">2635: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a></font>
<a name="line2636">2636: </a><font color="#B22222">. f    - The test field number</font>
<a name="line2637">2637: </a><font color="#B22222">. sol  - time derivative of the solution function for the test fields</font>
<a name="line2638">2638: </a><font color="#B22222">- ctx  - time derivative of the solution context or NULL</font>

<a name="line2640">2640: </a><font color="#B22222">  Note: The calling sequence for solution functions is given by:</font>

<a name="line2642">2642: </a><font color="#B22222">$ sol(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], void *ctx)</font>

<a name="line2644">2644: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line2645">2645: </a><font color="#B22222">. t - current time</font>
<a name="line2646">2646: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line2647">2647: </a><font color="#B22222">. Nc - the number of field components</font>
<a name="line2648">2648: </a><font color="#B22222">. u - the solution field evaluated at the current point</font>
<a name="line2649">2649: </a><font color="#B22222">- ctx - a user context</font>

<a name="line2651">2651: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2653">2653: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetExactSolutionTimeDerivative.html#PetscDSGetExactSolutionTimeDerivative">PetscDSGetExactSolutionTimeDerivative</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetExactSolution.html#PetscDSSetExactSolution">PetscDSSetExactSolution</a>()</font>
<a name="line2654">2654: </a><font color="#B22222">@*/</font>
<a name="line2655">2655: </a><strong><font color="#4169E1"><a name="PetscDSSetExactSolutionTimeDerivative"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetExactSolutionTimeDerivative.html#PetscDSSetExactSolutionTimeDerivative">PetscDSSetExactSolutionTimeDerivative</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> (*sol)(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> t, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], void *ctx), void *ctx)</font></strong>
<a name="line2656">2656: </a>{

<a name="line2661">2661: </a>  <font color="#4169E1">if</font> (f &lt; 0) <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be non-negative"</font>, f);
<a name="line2662">2662: </a>  PetscDSEnlarge_Static(prob, f+1);
<a name="line2665">2665: </a>  <font color="#4169E1">return</font>(0);
<a name="line2666">2666: </a>}

<a name="line2668">2668: </a><font color="#B22222">/*@C</font>
<a name="line2669">2669: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetConstants.html#PetscDSGetConstants">PetscDSGetConstants</a> - Returns the array of constants passed to point functions</font>

<a name="line2671">2671: </a><font color="#B22222">  Not collective</font>

<a name="line2673">2673: </a><font color="#B22222">  Input Parameter:</font>
<a name="line2674">2674: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line2676">2676: </a><font color="#B22222">  Output Parameters:</font>
<a name="line2677">2677: </a><font color="#B22222">+ numConstants - The number of constants</font>
<a name="line2678">2678: </a><font color="#B22222">- constants    - The array of constants, NULL if there are none</font>

<a name="line2680">2680: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2682">2682: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSetConstants.html#PetscDSSetConstants">PetscDSSetConstants</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line2683">2683: </a><font color="#B22222">@*/</font>
<a name="line2684">2684: </a><strong><font color="#4169E1"><a name="PetscDSGetConstants"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetConstants.html#PetscDSGetConstants">PetscDSGetConstants</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *numConstants, const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> *constants[])</font></strong>
<a name="line2685">2685: </a>{
<a name="line2690">2690: </a>  <font color="#4169E1">return</font>(0);
<a name="line2691">2691: </a>}

<a name="line2693">2693: </a><font color="#B22222">/*@C</font>
<a name="line2694">2694: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSetConstants.html#PetscDSSetConstants">PetscDSSetConstants</a> - Set the array of constants passed to point functions</font>

<a name="line2696">2696: </a><font color="#B22222">  Not collective</font>

<a name="line2698">2698: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2699">2699: </a><font color="#B22222">+ prob         - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line2700">2700: </a><font color="#B22222">. numConstants - The number of constants</font>
<a name="line2701">2701: </a><font color="#B22222">- constants    - The array of constants, NULL if there are none</font>

<a name="line2703">2703: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2705">2705: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetConstants.html#PetscDSGetConstants">PetscDSGetConstants</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line2706">2706: </a><font color="#B22222">@*/</font>
<a name="line2707">2707: </a><strong><font color="#4169E1"><a name="PetscDSSetConstants"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSetConstants.html#PetscDSSetConstants">PetscDSSetConstants</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numConstants, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> constants[])</font></strong>
<a name="line2708">2708: </a>{

<a name="line2713">2713: </a>  <font color="#4169E1">if</font> (numConstants != prob-&gt;numConstants) {
<a name="line2714">2714: </a>    <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(prob-&gt;constants);
<a name="line2715">2715: </a>    prob-&gt;numConstants = numConstants;
<a name="line2716">2716: </a>    <font color="#4169E1">if</font> (prob-&gt;numConstants) {
<a name="line2717">2717: </a>      <a href="../../../../docs/manualpages/Sys/PetscMalloc1.html#PetscMalloc1">PetscMalloc1</a>(prob-&gt;numConstants, &amp;prob-&gt;constants);
<a name="line2718">2718: </a>    } <font color="#4169E1">else</font> {
<a name="line2719">2719: </a>      prob-&gt;constants = NULL;
<a name="line2720">2720: </a>    }
<a name="line2721">2721: </a>  }
<a name="line2722">2722: </a>  <font color="#4169E1">if</font> (prob-&gt;numConstants) {
<a name="line2724">2724: </a>    <a href="../../../../docs/manualpages/Sys/PetscArraycpy.html#PetscArraycpy">PetscArraycpy</a>(prob-&gt;constants, constants, prob-&gt;numConstants);
<a name="line2725">2725: </a>  }
<a name="line2726">2726: </a>  <font color="#4169E1">return</font>(0);
<a name="line2727">2727: </a>}

<a name="line2729">2729: </a><font color="#B22222">/*@</font>
<a name="line2730">2730: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetFieldIndex.html#PetscDSGetFieldIndex">PetscDSGetFieldIndex</a> - Returns the index of the given field</font>

<a name="line2732">2732: </a><font color="#B22222">  Not collective</font>

<a name="line2734">2734: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2735">2735: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line2736">2736: </a><font color="#B22222">- disc - The discretization object</font>

<a name="line2738">2738: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2739">2739: </a><font color="#B22222">. f - The field number</font>

<a name="line2741">2741: </a><font color="#B22222">  Level: beginner</font>

<a name="line2743">2743: </a><font color="#B22222">.seealso: PetscGetDiscretization(), <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line2744">2744: </a><font color="#B22222">@*/</font>
<a name="line2745">2745: </a><strong><font color="#4169E1"><a name="PetscDSGetFieldIndex"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetFieldIndex.html#PetscDSGetFieldIndex">PetscDSGetFieldIndex</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a> disc, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *f)</font></strong>
<a name="line2746">2746: </a>{
<a name="line2747">2747: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> g;

<a name="line2752">2752: </a>  *f = -1;
<a name="line2753">2753: </a>  <font color="#4169E1">for</font> (g = 0; g &lt; prob-&gt;Nf; ++g) {<font color="#4169E1">if</font> (disc == prob-&gt;disc[g]) <font color="#4169E1">break</font>;}
<a name="line2754">2754: </a>  <font color="#4169E1">if</font> (g == prob-&gt;Nf) <a href="../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</a>(<a href="../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob), PETSC_ERR_ARG_WRONG, <font color="#666666">"Field not found in <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a>."</font>);
<a name="line2755">2755: </a>  *f = g;
<a name="line2756">2756: </a>  <font color="#4169E1">return</font>(0);
<a name="line2757">2757: </a>}

<a name="line2759">2759: </a><font color="#B22222">/*@</font>
<a name="line2760">2760: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetFieldSize.html#PetscDSGetFieldSize">PetscDSGetFieldSize</a> - Returns the size of the given field in the full space basis</font>

<a name="line2762">2762: </a><font color="#B22222">  Not collective</font>

<a name="line2764">2764: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2765">2765: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line2766">2766: </a><font color="#B22222">- f - The field number</font>

<a name="line2768">2768: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2769">2769: </a><font color="#B22222">. size - The size</font>

<a name="line2771">2771: </a><font color="#B22222">  Level: beginner</font>

<a name="line2773">2773: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetFieldOffset.html#PetscDSGetFieldOffset">PetscDSGetFieldOffset</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line2774">2774: </a><font color="#B22222">@*/</font>
<a name="line2775">2775: </a><strong><font color="#4169E1"><a name="PetscDSGetFieldSize"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetFieldSize.html#PetscDSGetFieldSize">PetscDSGetFieldSize</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *size)</font></strong>
<a name="line2776">2776: </a>{

<a name="line2782">2782: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line2783">2783: </a>  <a href="../../../../docs/manualpages/DT/PetscDSSetUp.html#PetscDSSetUp">PetscDSSetUp</a>(prob);
<a name="line2784">2784: </a>  *size = prob-&gt;Nb[f];
<a name="line2785">2785: </a>  <font color="#4169E1">return</font>(0);
<a name="line2786">2786: </a>}

<a name="line2788">2788: </a><font color="#B22222">/*@</font>
<a name="line2789">2789: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetFieldOffset.html#PetscDSGetFieldOffset">PetscDSGetFieldOffset</a> - Returns the offset of the given field in the full space basis</font>

<a name="line2791">2791: </a><font color="#B22222">  Not collective</font>

<a name="line2793">2793: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2794">2794: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line2795">2795: </a><font color="#B22222">- f - The field number</font>

<a name="line2797">2797: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2798">2798: </a><font color="#B22222">. off - The offset</font>

<a name="line2800">2800: </a><font color="#B22222">  Level: beginner</font>

<a name="line2802">2802: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetFieldSize.html#PetscDSGetFieldSize">PetscDSGetFieldSize</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line2803">2803: </a><font color="#B22222">@*/</font>
<a name="line2804">2804: </a><strong><font color="#4169E1"><a name="PetscDSGetFieldOffset"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetFieldOffset.html#PetscDSGetFieldOffset">PetscDSGetFieldOffset</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *off)</font></strong>
<a name="line2805">2805: </a>{
<a name="line2806">2806: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>       size, g;

<a name="line2812">2812: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line2813">2813: </a>  *off = 0;
<a name="line2814">2814: </a>  <font color="#4169E1">for</font> (g = 0; g &lt; f; ++g) {
<a name="line2815">2815: </a>    <a href="../../../../docs/manualpages/DT/PetscDSGetFieldSize.html#PetscDSGetFieldSize">PetscDSGetFieldSize</a>(prob, g, &amp;size);
<a name="line2816">2816: </a>    *off += size;
<a name="line2817">2817: </a>  }
<a name="line2818">2818: </a>  <font color="#4169E1">return</font>(0);
<a name="line2819">2819: </a>}

<a name="line2821">2821: </a><font color="#B22222">/*@</font>
<a name="line2822">2822: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetDimensions.html#PetscDSGetDimensions">PetscDSGetDimensions</a> - Returns the size of the approximation space for each field on an evaluation point</font>

<a name="line2824">2824: </a><font color="#B22222">  Not collective</font>

<a name="line2826">2826: </a><font color="#B22222">  Input Parameter:</font>
<a name="line2827">2827: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line2829">2829: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2830">2830: </a><font color="#B22222">. dimensions - The number of dimensions</font>

<a name="line2832">2832: </a><font color="#B22222">  Level: beginner</font>

<a name="line2834">2834: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetComponentOffsets.html#PetscDSGetComponentOffsets">PetscDSGetComponentOffsets</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line2835">2835: </a><font color="#B22222">@*/</font>
<a name="line2836">2836: </a><strong><font color="#4169E1"><a name="PetscDSGetDimensions"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetDimensions.html#PetscDSGetDimensions">PetscDSGetDimensions</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *dimensions[])</font></strong>
<a name="line2837">2837: </a>{

<a name="line2842">2842: </a>  <a href="../../../../docs/manualpages/DT/PetscDSSetUp.html#PetscDSSetUp">PetscDSSetUp</a>(prob);
<a name="line2844">2844: </a>  *dimensions = prob-&gt;Nb;
<a name="line2845">2845: </a>  <font color="#4169E1">return</font>(0);
<a name="line2846">2846: </a>}

<a name="line2848">2848: </a><font color="#B22222">/*@</font>
<a name="line2849">2849: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetComponents.html#PetscDSGetComponents">PetscDSGetComponents</a> - Returns the number of components for each field on an evaluation point</font>

<a name="line2851">2851: </a><font color="#B22222">  Not collective</font>

<a name="line2853">2853: </a><font color="#B22222">  Input Parameter:</font>
<a name="line2854">2854: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line2856">2856: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2857">2857: </a><font color="#B22222">. components - The number of components</font>

<a name="line2859">2859: </a><font color="#B22222">  Level: beginner</font>

<a name="line2861">2861: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetComponentOffsets.html#PetscDSGetComponentOffsets">PetscDSGetComponentOffsets</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line2862">2862: </a><font color="#B22222">@*/</font>
<a name="line2863">2863: </a><strong><font color="#4169E1"><a name="PetscDSGetComponents"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetComponents.html#PetscDSGetComponents">PetscDSGetComponents</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *components[])</font></strong>
<a name="line2864">2864: </a>{

<a name="line2869">2869: </a>  <a href="../../../../docs/manualpages/DT/PetscDSSetUp.html#PetscDSSetUp">PetscDSSetUp</a>(prob);
<a name="line2871">2871: </a>  *components = prob-&gt;Nc;
<a name="line2872">2872: </a>  <font color="#4169E1">return</font>(0);
<a name="line2873">2873: </a>}

<a name="line2875">2875: </a><font color="#B22222">/*@</font>
<a name="line2876">2876: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetComponentOffset.html#PetscDSGetComponentOffset">PetscDSGetComponentOffset</a> - Returns the offset of the given field on an evaluation point</font>

<a name="line2878">2878: </a><font color="#B22222">  Not collective</font>

<a name="line2880">2880: </a><font color="#B22222">  Input Parameters:</font>
<a name="line2881">2881: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line2882">2882: </a><font color="#B22222">- f - The field number</font>

<a name="line2884">2884: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2885">2885: </a><font color="#B22222">. off - The offset</font>

<a name="line2887">2887: </a><font color="#B22222">  Level: beginner</font>

<a name="line2889">2889: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line2890">2890: </a><font color="#B22222">@*/</font>
<a name="line2891">2891: </a><strong><font color="#4169E1"><a name="PetscDSGetComponentOffset"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetComponentOffset.html#PetscDSGetComponentOffset">PetscDSGetComponentOffset</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *off)</font></strong>
<a name="line2892">2892: </a>{
<a name="line2896">2896: </a>  <font color="#4169E1">if</font> ((f &lt; 0) || (f &gt;= prob-&gt;Nf)) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Field number %d must be in [0, %d)"</font>, f, prob-&gt;Nf);
<a name="line2897">2897: </a>  *off = prob-&gt;off[f];
<a name="line2898">2898: </a>  <font color="#4169E1">return</font>(0);
<a name="line2899">2899: </a>}

<a name="line2901">2901: </a><font color="#B22222">/*@</font>
<a name="line2902">2902: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetComponentOffsets.html#PetscDSGetComponentOffsets">PetscDSGetComponentOffsets</a> - Returns the offset of each field on an evaluation point</font>

<a name="line2904">2904: </a><font color="#B22222">  Not collective</font>

<a name="line2906">2906: </a><font color="#B22222">  Input Parameter:</font>
<a name="line2907">2907: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line2909">2909: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2910">2910: </a><font color="#B22222">. offsets - The offsets</font>

<a name="line2912">2912: </a><font color="#B22222">  Level: beginner</font>

<a name="line2914">2914: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line2915">2915: </a><font color="#B22222">@*/</font>
<a name="line2916">2916: </a><strong><font color="#4169E1"><a name="PetscDSGetComponentOffsets"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetComponentOffsets.html#PetscDSGetComponentOffsets">PetscDSGetComponentOffsets</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *offsets[])</font></strong>
<a name="line2917">2917: </a>{
<a name="line2921">2921: </a>  *offsets = prob-&gt;off;
<a name="line2922">2922: </a>  <font color="#4169E1">return</font>(0);
<a name="line2923">2923: </a>}

<a name="line2925">2925: </a><font color="#B22222">/*@</font>
<a name="line2926">2926: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetComponentDerivativeOffsets.html#PetscDSGetComponentDerivativeOffsets">PetscDSGetComponentDerivativeOffsets</a> - Returns the offset of each field derivative on an evaluation point</font>

<a name="line2928">2928: </a><font color="#B22222">  Not collective</font>

<a name="line2930">2930: </a><font color="#B22222">  Input Parameter:</font>
<a name="line2931">2931: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line2933">2933: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2934">2934: </a><font color="#B22222">. offsets - The offsets</font>

<a name="line2936">2936: </a><font color="#B22222">  Level: beginner</font>

<a name="line2938">2938: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line2939">2939: </a><font color="#B22222">@*/</font>
<a name="line2940">2940: </a><strong><font color="#4169E1"><a name="PetscDSGetComponentDerivativeOffsets"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetComponentDerivativeOffsets.html#PetscDSGetComponentDerivativeOffsets">PetscDSGetComponentDerivativeOffsets</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *offsets[])</font></strong>
<a name="line2941">2941: </a>{
<a name="line2945">2945: </a>  *offsets = prob-&gt;offDer;
<a name="line2946">2946: </a>  <font color="#4169E1">return</font>(0);
<a name="line2947">2947: </a>}

<a name="line2949">2949: </a><font color="#B22222">/*@C</font>
<a name="line2950">2950: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetTabulation.html#PetscDSGetTabulation">PetscDSGetTabulation</a> - Return the basis tabulation at quadrature points for the volume discretization</font>

<a name="line2952">2952: </a><font color="#B22222">  Not collective</font>

<a name="line2954">2954: </a><font color="#B22222">  Input Parameter:</font>
<a name="line2955">2955: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line2957">2957: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2958">2958: </a><font color="#B22222">. T - The basis function and derivatives tabulation at quadrature points for each field</font>

<a name="line2960">2960: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2962">2962: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line2963">2963: </a><font color="#B22222">@*/</font>
<a name="line2964">2964: </a><strong><font color="#4169E1"><a name="PetscDSGetTabulation"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetTabulation.html#PetscDSGetTabulation">PetscDSGetTabulation</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, PetscTabulation *T[])</font></strong>
<a name="line2965">2965: </a>{

<a name="line2971">2971: </a>  <a href="../../../../docs/manualpages/DT/PetscDSSetUp.html#PetscDSSetUp">PetscDSSetUp</a>(prob);
<a name="line2972">2972: </a>  *T = prob-&gt;T;
<a name="line2973">2973: </a>  <font color="#4169E1">return</font>(0);
<a name="line2974">2974: </a>}

<a name="line2976">2976: </a><font color="#B22222">/*@C</font>
<a name="line2977">2977: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetFaceTabulation.html#PetscDSGetFaceTabulation">PetscDSGetFaceTabulation</a> - Return the basis tabulation at quadrature points on the faces</font>

<a name="line2979">2979: </a><font color="#B22222">  Not collective</font>

<a name="line2981">2981: </a><font color="#B22222">  Input Parameter:</font>
<a name="line2982">2982: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line2984">2984: </a><font color="#B22222">  Output Parameter:</font>
<a name="line2985">2985: </a><font color="#B22222">. Tf - The basis function and derviative tabulation on each local face at quadrature points for each and field</font>

<a name="line2987">2987: </a><font color="#B22222">  Level: intermediate</font>

<a name="line2989">2989: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetTabulation.html#PetscDSGetTabulation">PetscDSGetTabulation</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line2990">2990: </a><font color="#B22222">@*/</font>
<a name="line2991">2991: </a><strong><font color="#4169E1"><a name="PetscDSGetFaceTabulation"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetFaceTabulation.html#PetscDSGetFaceTabulation">PetscDSGetFaceTabulation</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, PetscTabulation *Tf[])</font></strong>
<a name="line2992">2992: </a>{

<a name="line2998">2998: </a>  <a href="../../../../docs/manualpages/DT/PetscDSSetUp.html#PetscDSSetUp">PetscDSSetUp</a>(prob);
<a name="line2999">2999: </a>  *Tf = prob-&gt;Tf;
<a name="line3000">3000: </a>  <font color="#4169E1">return</font>(0);
<a name="line3001">3001: </a>}

<a name="line3003">3003: </a><strong><font color="#4169E1"><a name="PetscDSGetEvaluationArrays"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDSGetEvaluationArrays(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> **u, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> **u_t, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> **u_x)</font></strong>
<a name="line3004">3004: </a>{

<a name="line3009">3009: </a>  <a href="../../../../docs/manualpages/DT/PetscDSSetUp.html#PetscDSSetUp">PetscDSSetUp</a>(prob);
<a name="line3013">3013: </a>  <font color="#4169E1">return</font>(0);
<a name="line3014">3014: </a>}

<a name="line3016">3016: </a><strong><font color="#4169E1"><a name="PetscDSGetWeakFormArrays"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDSGetWeakFormArrays(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> **f0, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> **f1, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> **g0, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> **g1, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> **g2, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> **g3)</font></strong>
<a name="line3017">3017: </a>{

<a name="line3022">3022: </a>  <a href="../../../../docs/manualpages/DT/PetscDSSetUp.html#PetscDSSetUp">PetscDSSetUp</a>(prob);
<a name="line3029">3029: </a>  <font color="#4169E1">return</font>(0);
<a name="line3030">3030: </a>}

<a name="line3032">3032: </a><strong><font color="#4169E1"><a name="PetscDSGetWorkspace"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDSGetWorkspace(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> **x, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> **basisReal, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> **basisDerReal, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> **testReal, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> **testDerReal)</font></strong>
<a name="line3033">3033: </a>{

<a name="line3038">3038: </a>  <a href="../../../../docs/manualpages/DT/PetscDSSetUp.html#PetscDSSetUp">PetscDSSetUp</a>(prob);
<a name="line3044">3044: </a>  <font color="#4169E1">return</font>(0);
<a name="line3045">3045: </a>}

<a name="line3047">3047: </a><font color="#B22222">/*@C</font>
<a name="line3048">3048: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSAddBoundary.html#PetscDSAddBoundary">PetscDSAddBoundary</a> - Add a boundary condition to the model. The pointwise functions are used to provide boundary values for essential boundary conditions. In FEM, they are acting upon by dual basis functionals to generate FEM coefficients which are fixed. Natural boundary conditions signal to PETSc that boundary integrals should be performaed, using the kernels from <a href="../../../../docs/manualpages/DT/PetscDSSetBdResidual.html#PetscDSSetBdResidual">PetscDSSetBdResidual</a>().</font>

<a name="line3050">3050: </a><font color="#B22222">  Collective on ds</font>

<a name="line3052">3052: </a><font color="#B22222">  Input Parameters:</font>
<a name="line3053">3053: </a><font color="#B22222">+ ds          - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line3054">3054: </a><font color="#B22222">. type        - The type of condition, e.g. <a href="../../../../docs/manualpages/DM/DMBoundaryConditionType.html#DMBoundaryConditionType">DM_BC_ESSENTIAL</a>/<a href="../../../../docs/manualpages/DM/DMBoundaryConditionType.html#DMBoundaryConditionType">DM_BC_ESSENTIAL_FIELD</a> (Dirichlet), or <a href="../../../../docs/manualpages/DM/DMBoundaryConditionType.html#DMBoundaryConditionType">DM_BC_NATURAL</a> (Neumann)</font>
<a name="line3055">3055: </a><font color="#B22222">. name        - The BC name</font>
<a name="line3056">3056: </a><font color="#B22222">. labelname   - The label defining constrained points</font>
<a name="line3057">3057: </a><font color="#B22222">. field       - The field to constrain</font>
<a name="line3058">3058: </a><font color="#B22222">. numcomps    - The number of constrained field components (0 will constrain all fields)</font>
<a name="line3059">3059: </a><font color="#B22222">. comps       - An array of constrained component numbers</font>
<a name="line3060">3060: </a><font color="#B22222">. bcFunc      - A pointwise function giving boundary values</font>
<a name="line3061">3061: </a><font color="#B22222">. bcFunc_t    - A pointwise function giving the time derviative of the boundary values, or NULL</font>
<a name="line3062">3062: </a><font color="#B22222">. numids      - The number of <a href="../../../../docs/manualpages/DM/DMLabel.html#DMLabel">DMLabel</a> ids for constrained points</font>
<a name="line3063">3063: </a><font color="#B22222">. ids         - An array of ids for constrained points</font>
<a name="line3064">3064: </a><font color="#B22222">- ctx         - An optional user context for bcFunc</font>

<a name="line3066">3066: </a><font color="#B22222">  Options Database Keys:</font>
<a name="line3067">3067: </a><font color="#B22222">+ -bc_&lt;boundary name&gt; &lt;num&gt; - Overrides the boundary ids</font>
<a name="line3068">3068: </a><font color="#B22222">- -bc_&lt;boundary name&gt;_comp &lt;num&gt; - Overrides the boundary components</font>

<a name="line3070">3070: </a><font color="#B22222">  Note:</font>
<a name="line3071">3071: </a><font color="#B22222">  Both bcFunc abd bcFunc_t will depend on the boundary condition type. If the type if <a href="../../../../docs/manualpages/DM/DMBoundaryConditionType.html#DMBoundaryConditionType">DM_BC_ESSENTIAL</a>, Then the calling sequence is:</font>

<a name="line3073">3073: </a><font color="#B22222">$ bcFunc(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> time, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nc, <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> bcval[])</font>

<a name="line3075">3075: </a><font color="#B22222">  If the type is <a href="../../../../docs/manualpages/DM/DMBoundaryConditionType.html#DMBoundaryConditionType">DM_BC_ESSENTIAL_FIELD</a> or other _FIELD value, then the calling sequence is:</font>

<a name="line3077">3077: </a><font color="#B22222">$ bcFunc(<a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> dim, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> Nf, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> NfAux,</font>
<a name="line3078">3078: </a><font color="#B22222">$        const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> uOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> u_x[],</font>
<a name="line3079">3079: </a><font color="#B22222">$        const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff[], const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> aOff_x[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_t[], const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> a_x[],</font>
<a name="line3080">3080: </a><font color="#B22222">$        <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> time, const <a href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</a> x[], <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> bcval[])</font>

<a name="line3082">3082: </a><font color="#B22222">+ dim - the spatial dimension</font>
<a name="line3083">3083: </a><font color="#B22222">. Nf - the number of fields</font>
<a name="line3084">3084: </a><font color="#B22222">. uOff - the offset into u[] and u_t[] for each field</font>
<a name="line3085">3085: </a><font color="#B22222">. uOff_x - the offset into u_x[] for each field</font>
<a name="line3086">3086: </a><font color="#B22222">. u - each field evaluated at the current point</font>
<a name="line3087">3087: </a><font color="#B22222">. u_t - the time derivative of each field evaluated at the current point</font>
<a name="line3088">3088: </a><font color="#B22222">. u_x - the gradient of each field evaluated at the current point</font>
<a name="line3089">3089: </a><font color="#B22222">. aOff - the offset into a[] and a_t[] for each auxiliary field</font>
<a name="line3090">3090: </a><font color="#B22222">. aOff_x - the offset into a_x[] for each auxiliary field</font>
<a name="line3091">3091: </a><font color="#B22222">. a - each auxiliary field evaluated at the current point</font>
<a name="line3092">3092: </a><font color="#B22222">. a_t - the time derivative of each auxiliary field evaluated at the current point</font>
<a name="line3093">3093: </a><font color="#B22222">. a_x - the gradient of auxiliary each field evaluated at the current point</font>
<a name="line3094">3094: </a><font color="#B22222">. t - current time</font>
<a name="line3095">3095: </a><font color="#B22222">. x - coordinates of the current point</font>
<a name="line3096">3096: </a><font color="#B22222">. numConstants - number of constant parameters</font>
<a name="line3097">3097: </a><font color="#B22222">. constants - constant parameters</font>
<a name="line3098">3098: </a><font color="#B22222">- bcval - output values at the current point</font>

<a name="line3100">3100: </a><font color="#B22222">  Level: developer</font>

<a name="line3102">3102: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSGetBoundary.html#PetscDSGetBoundary">PetscDSGetBoundary</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetResidual.html#PetscDSSetResidual">PetscDSSetResidual</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetBdResidual.html#PetscDSSetBdResidual">PetscDSSetBdResidual</a>()</font>
<a name="line3103">3103: </a><font color="#B22222">@*/</font>
<a name="line3104">3104: </a><strong><font color="#4169E1"><a name="PetscDSAddBoundary"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSAddBoundary.html#PetscDSAddBoundary">PetscDSAddBoundary</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> ds, <a href="../../../../docs/manualpages/DM/DMBoundaryConditionType.html#DMBoundaryConditionType">DMBoundaryConditionType</a> type, const char name[], const char labelname[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> field, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numcomps, const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *comps, void (*bcFunc)(void), void (*bcFunc_t)(void), <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numids, const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *ids, void *ctx)</font></strong>
<a name="line3105">3105: </a>{
<a name="line3106">3106: </a>  DSBoundary     b;

<a name="line3115">3115: </a>  <a href="../../../../docs/manualpages/Sys/PetscNew.html#PetscNew">PetscNew</a>(&amp;b);
<a name="line3116">3116: </a>  <a href="../../../../docs/manualpages/Sys/PetscStrallocpy.html#PetscStrallocpy">PetscStrallocpy</a>(name, (char **) &amp;b-&gt;name);
<a name="line3117">3117: </a>  <a href="../../../../docs/manualpages/Sys/PetscStrallocpy.html#PetscStrallocpy">PetscStrallocpy</a>(labelname, (char **) &amp;b-&gt;labelname);
<a name="line3118">3118: </a>  <a href="../../../../docs/manualpages/Sys/PetscMalloc1.html#PetscMalloc1">PetscMalloc1</a>(numcomps, &amp;b-&gt;comps);
<a name="line3119">3119: </a>  <font color="#4169E1">if</font> (numcomps) {<a href="../../../../docs/manualpages/Sys/PetscArraycpy.html#PetscArraycpy">PetscArraycpy</a>(b-&gt;comps, comps, numcomps);}
<a name="line3120">3120: </a>  <a href="../../../../docs/manualpages/Sys/PetscMalloc1.html#PetscMalloc1">PetscMalloc1</a>(numids, &amp;b-&gt;ids);
<a name="line3121">3121: </a>  <font color="#4169E1">if</font> (numids) {<a href="../../../../docs/manualpages/Sys/PetscArraycpy.html#PetscArraycpy">PetscArraycpy</a>(b-&gt;ids, ids, numids);}
<a name="line3122">3122: </a>  b-&gt;type            = type;
<a name="line3123">3123: </a>  b-&gt;field           = field;
<a name="line3124">3124: </a>  b-&gt;numcomps        = numcomps;
<a name="line3125">3125: </a>  b-&gt;func            = bcFunc;
<a name="line3126">3126: </a>  b-&gt;func_t          = bcFunc_t;
<a name="line3127">3127: </a>  b-&gt;numids          = numids;
<a name="line3128">3128: </a>  b-&gt;ctx             = ctx;
<a name="line3129">3129: </a>  b-&gt;next            = ds-&gt;boundary;
<a name="line3130">3130: </a>  ds-&gt;boundary       = b;
<a name="line3131">3131: </a>  <font color="#4169E1">return</font>(0);
<a name="line3132">3132: </a>}

<a name="line3134">3134: </a><font color="#B22222">/*@C</font>
<a name="line3135">3135: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSUpdateBoundary.html#PetscDSUpdateBoundary">PetscDSUpdateBoundary</a> - Change a boundary condition for the model. The pointwise functions are used to provide boundary values for essential boundary conditions. In FEM, they are acting upon by dual basis functionals to generate FEM coefficients which are fixed. Natural boundary conditions signal to PETSc that boundary integrals should be performaed, using the kernels from <a href="../../../../docs/manualpages/DT/PetscDSSetBdResidual.html#PetscDSSetBdResidual">PetscDSSetBdResidual</a>().</font>

<a name="line3137">3137: </a><font color="#B22222">  Input Parameters:</font>
<a name="line3138">3138: </a><font color="#B22222">+ ds          - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line3139">3139: </a><font color="#B22222">. bd          - The boundary condition number</font>
<a name="line3140">3140: </a><font color="#B22222">. type        - The type of condition, e.g. <a href="../../../../docs/manualpages/DM/DMBoundaryConditionType.html#DMBoundaryConditionType">DM_BC_ESSENTIAL</a>/<a href="../../../../docs/manualpages/DM/DMBoundaryConditionType.html#DMBoundaryConditionType">DM_BC_ESSENTIAL_FIELD</a> (Dirichlet), or <a href="../../../../docs/manualpages/DM/DMBoundaryConditionType.html#DMBoundaryConditionType">DM_BC_NATURAL</a> (Neumann)</font>
<a name="line3141">3141: </a><font color="#B22222">. name        - The BC name</font>
<a name="line3142">3142: </a><font color="#B22222">. labelname   - The label defining constrained points</font>
<a name="line3143">3143: </a><font color="#B22222">. field       - The field to constrain</font>
<a name="line3144">3144: </a><font color="#B22222">. numcomps    - The number of constrained field components</font>
<a name="line3145">3145: </a><font color="#B22222">. comps       - An array of constrained component numbers</font>
<a name="line3146">3146: </a><font color="#B22222">. bcFunc      - A pointwise function giving boundary values</font>
<a name="line3147">3147: </a><font color="#B22222">. bcFunc_t    - A pointwise function giving the time derviative of the boundary values, or NULL</font>
<a name="line3148">3148: </a><font color="#B22222">. numids      - The number of <a href="../../../../docs/manualpages/DM/DMLabel.html#DMLabel">DMLabel</a> ids for constrained points</font>
<a name="line3149">3149: </a><font color="#B22222">. ids         - An array of ids for constrained points</font>
<a name="line3150">3150: </a><font color="#B22222">- ctx         - An optional user context for bcFunc</font>

<a name="line3152">3152: </a><font color="#B22222">  Note:</font>
<a name="line3153">3153: </a><font color="#B22222">  The boundary condition number is the order in which it was registered. The user can get the number of boundary conditions from <a href="../../../../docs/manualpages/DT/PetscDSGetNumBoundary.html#PetscDSGetNumBoundary">PetscDSGetNumBoundary</a>(). See <a href="../../../../docs/manualpages/DT/PetscDSAddBoundary.html#PetscDSAddBoundary">PetscDSAddBoundary</a>() for a description of the calling sequences for the callbacks.</font>

<a name="line3155">3155: </a><font color="#B22222">  Level: developer</font>

<a name="line3157">3157: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSAddBoundary.html#PetscDSAddBoundary">PetscDSAddBoundary</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetBoundary.html#PetscDSGetBoundary">PetscDSGetBoundary</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetNumBoundary.html#PetscDSGetNumBoundary">PetscDSGetNumBoundary</a>()</font>
<a name="line3158">3158: </a><font color="#B22222">@*/</font>
<a name="line3159">3159: </a><strong><font color="#4169E1"><a name="PetscDSUpdateBoundary"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSUpdateBoundary.html#PetscDSUpdateBoundary">PetscDSUpdateBoundary</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> ds, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> bd, <a href="../../../../docs/manualpages/DM/DMBoundaryConditionType.html#DMBoundaryConditionType">DMBoundaryConditionType</a> type, const char name[], const char labelname[], <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> field, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numcomps, const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *comps, void (*bcFunc)(void), void (*bcFunc_t)(void), <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numids, const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *ids, void *ctx)</font></strong>
<a name="line3160">3160: </a>{
<a name="line3161">3161: </a>  DSBoundary     b = ds-&gt;boundary;
<a name="line3162">3162: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>       n = 0;

<a name="line3167">3167: </a>  <font color="#4169E1">while</font> (b) {
<a name="line3168">3168: </a>    <font color="#4169E1">if</font> (n == bd) <font color="#4169E1">break</font>;
<a name="line3169">3169: </a>    b = b-&gt;next;
<a name="line3170">3170: </a>    ++n;
<a name="line3171">3171: </a>  }
<a name="line3172">3172: </a>  <font color="#4169E1">if</font> (!b) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Boundary %d is not in [0, %d)"</font>, bd, n);
<a name="line3173">3173: </a>  <font color="#4169E1">if</font> (name) {
<a name="line3174">3174: </a>    <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(b-&gt;name);
<a name="line3175">3175: </a>    <a href="../../../../docs/manualpages/Sys/PetscStrallocpy.html#PetscStrallocpy">PetscStrallocpy</a>(name, (char **) &amp;b-&gt;name);
<a name="line3176">3176: </a>  }
<a name="line3177">3177: </a>  <font color="#4169E1">if</font> (labelname) {
<a name="line3178">3178: </a>    <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(b-&gt;labelname);
<a name="line3179">3179: </a>    <a href="../../../../docs/manualpages/Sys/PetscStrallocpy.html#PetscStrallocpy">PetscStrallocpy</a>(labelname, (char **) &amp;b-&gt;labelname);
<a name="line3180">3180: </a>  }
<a name="line3181">3181: </a>  <font color="#4169E1">if</font> (numcomps &gt;= 0 &amp;&amp; numcomps != b-&gt;numcomps) {
<a name="line3182">3182: </a>    b-&gt;numcomps = numcomps;
<a name="line3183">3183: </a>    <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(b-&gt;comps);
<a name="line3184">3184: </a>    <a href="../../../../docs/manualpages/Sys/PetscMalloc1.html#PetscMalloc1">PetscMalloc1</a>(numcomps, &amp;b-&gt;comps);
<a name="line3185">3185: </a>    <font color="#4169E1">if</font> (numcomps) {<a href="../../../../docs/manualpages/Sys/PetscArraycpy.html#PetscArraycpy">PetscArraycpy</a>(b-&gt;comps, comps, numcomps);}
<a name="line3186">3186: </a>  }
<a name="line3187">3187: </a>  <font color="#4169E1">if</font> (numids &gt;= 0 &amp;&amp; numids != b-&gt;numids) {
<a name="line3188">3188: </a>    b-&gt;numids = numids;
<a name="line3189">3189: </a>    <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(b-&gt;ids);
<a name="line3190">3190: </a>    <a href="../../../../docs/manualpages/Sys/PetscMalloc1.html#PetscMalloc1">PetscMalloc1</a>(numids, &amp;b-&gt;ids);
<a name="line3191">3191: </a>    <font color="#4169E1">if</font> (numids) {<a href="../../../../docs/manualpages/Sys/PetscArraycpy.html#PetscArraycpy">PetscArraycpy</a>(b-&gt;ids, ids, numids);}
<a name="line3192">3192: </a>  }
<a name="line3193">3193: </a>  b-&gt;type = type;
<a name="line3194">3194: </a>  <font color="#4169E1">if</font> (field &gt;= 0) {b-&gt;field  = field;}
<a name="line3195">3195: </a>  <font color="#4169E1">if</font> (bcFunc)     {b-&gt;func   = bcFunc;}
<a name="line3196">3196: </a>  <font color="#4169E1">if</font> (bcFunc_t)   {b-&gt;func_t = bcFunc_t;}
<a name="line3197">3197: </a>  <font color="#4169E1">if</font> (ctx)        {b-&gt;ctx    = ctx;}
<a name="line3198">3198: </a>  <font color="#4169E1">return</font>(0);
<a name="line3199">3199: </a>}

<a name="line3201">3201: </a><font color="#B22222">/*@</font>
<a name="line3202">3202: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetNumBoundary.html#PetscDSGetNumBoundary">PetscDSGetNumBoundary</a> - Get the number of registered BC</font>

<a name="line3204">3204: </a><font color="#B22222">  Input Parameters:</font>
<a name="line3205">3205: </a><font color="#B22222">. ds - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line3207">3207: </a><font color="#B22222">  Output Parameters:</font>
<a name="line3208">3208: </a><font color="#B22222">. numBd - The number of BC</font>

<a name="line3210">3210: </a><font color="#B22222">  Level: intermediate</font>

<a name="line3212">3212: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSAddBoundary.html#PetscDSAddBoundary">PetscDSAddBoundary</a>(), <a href="../../../../docs/manualpages/DT/PetscDSGetBoundary.html#PetscDSGetBoundary">PetscDSGetBoundary</a>()</font>
<a name="line3213">3213: </a><font color="#B22222">@*/</font>
<a name="line3214">3214: </a><strong><font color="#4169E1"><a name="PetscDSGetNumBoundary"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetNumBoundary.html#PetscDSGetNumBoundary">PetscDSGetNumBoundary</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> ds, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *numBd)</font></strong>
<a name="line3215">3215: </a>{
<a name="line3216">3216: </a>  DSBoundary b = ds-&gt;boundary;

<a name="line3221">3221: </a>  *numBd = 0;
<a name="line3222">3222: </a>  <font color="#4169E1">while</font> (b) {++(*numBd); b = b-&gt;next;}
<a name="line3223">3223: </a>  <font color="#4169E1">return</font>(0);
<a name="line3224">3224: </a>}

<a name="line3226">3226: </a><font color="#B22222">/*@C</font>
<a name="line3227">3227: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSGetBoundary.html#PetscDSGetBoundary">PetscDSGetBoundary</a> - Gets a boundary condition to the model</font>

<a name="line3229">3229: </a><font color="#B22222">  Input Parameters:</font>
<a name="line3230">3230: </a><font color="#B22222">+ ds          - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line3231">3231: </a><font color="#B22222">- bd          - The BC number</font>

<a name="line3233">3233: </a><font color="#B22222">  Output Parameters:</font>
<a name="line3234">3234: </a><font color="#B22222">+ type        - The type of condition, e.g. <a href="../../../../docs/manualpages/DM/DMBoundaryConditionType.html#DMBoundaryConditionType">DM_BC_ESSENTIAL</a>/<a href="../../../../docs/manualpages/DM/DMBoundaryConditionType.html#DMBoundaryConditionType">DM_BC_ESSENTIAL_FIELD</a> (Dirichlet), or <a href="../../../../docs/manualpages/DM/DMBoundaryConditionType.html#DMBoundaryConditionType">DM_BC_NATURAL</a> (Neumann)</font>
<a name="line3235">3235: </a><font color="#B22222">. name        - The BC name</font>
<a name="line3236">3236: </a><font color="#B22222">. labelname   - The label defining constrained points</font>
<a name="line3237">3237: </a><font color="#B22222">. field       - The field to constrain</font>
<a name="line3238">3238: </a><font color="#B22222">. numcomps    - The number of constrained field components</font>
<a name="line3239">3239: </a><font color="#B22222">. comps       - An array of constrained component numbers</font>
<a name="line3240">3240: </a><font color="#B22222">. bcFunc      - A pointwise function giving boundary values</font>
<a name="line3241">3241: </a><font color="#B22222">. bcFunc_t    - A pointwise function giving the time derviative of the boundary values</font>
<a name="line3242">3242: </a><font color="#B22222">. numids      - The number of <a href="../../../../docs/manualpages/DM/DMLabel.html#DMLabel">DMLabel</a> ids for constrained points</font>
<a name="line3243">3243: </a><font color="#B22222">. ids         - An array of ids for constrained points</font>
<a name="line3244">3244: </a><font color="#B22222">- ctx         - An optional user context for bcFunc</font>

<a name="line3246">3246: </a><font color="#B22222">  Options Database Keys:</font>
<a name="line3247">3247: </a><font color="#B22222">+ -bc_&lt;boundary name&gt; &lt;num&gt; - Overrides the boundary ids</font>
<a name="line3248">3248: </a><font color="#B22222">- -bc_&lt;boundary name&gt;_comp &lt;num&gt; - Overrides the boundary components</font>

<a name="line3250">3250: </a><font color="#B22222">  Level: developer</font>

<a name="line3252">3252: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSAddBoundary.html#PetscDSAddBoundary">PetscDSAddBoundary</a>()</font>
<a name="line3253">3253: </a><font color="#B22222">@*/</font>
<a name="line3254">3254: </a><strong><font color="#4169E1"><a name="PetscDSGetBoundary"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSGetBoundary.html#PetscDSGetBoundary">PetscDSGetBoundary</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> ds, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> bd, <a href="../../../../docs/manualpages/DM/DMBoundaryConditionType.html#DMBoundaryConditionType">DMBoundaryConditionType</a> *type, const char **name, const char **labelname, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *field, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *numcomps, const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> **comps, void (**func)(void), void (**func_t)(void), <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> *numids, const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> **ids, void **ctx)</font></strong>
<a name="line3255">3255: </a>{
<a name="line3256">3256: </a>  DSBoundary b    = ds-&gt;boundary;
<a name="line3257">3257: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>   n    = 0;

<a name="line3261">3261: </a>  <font color="#4169E1">while</font> (b) {
<a name="line3262">3262: </a>    <font color="#4169E1">if</font> (n == bd) <font color="#4169E1">break</font>;
<a name="line3263">3263: </a>    b = b-&gt;next;
<a name="line3264">3264: </a>    ++n;
<a name="line3265">3265: </a>  }
<a name="line3266">3266: </a>  <font color="#4169E1">if</font> (!b) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</a>, PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"Boundary %d is not in [0, %d)"</font>, bd, n);
<a name="line3267">3267: </a>  <font color="#4169E1">if</font> (type) {
<a name="line3269">3269: </a>    *type = b-&gt;type;
<a name="line3270">3270: </a>  }
<a name="line3271">3271: </a>  <font color="#4169E1">if</font> (name) {
<a name="line3273">3273: </a>    *name = b-&gt;name;
<a name="line3274">3274: </a>  }
<a name="line3275">3275: </a>  <font color="#4169E1">if</font> (labelname) {
<a name="line3277">3277: </a>    *labelname = b-&gt;labelname;
<a name="line3278">3278: </a>  }
<a name="line3279">3279: </a>  <font color="#4169E1">if</font> (field) {
<a name="line3281">3281: </a>    *field = b-&gt;field;
<a name="line3282">3282: </a>  }
<a name="line3283">3283: </a>  <font color="#4169E1">if</font> (numcomps) {
<a name="line3285">3285: </a>    *numcomps = b-&gt;numcomps;
<a name="line3286">3286: </a>  }
<a name="line3287">3287: </a>  <font color="#4169E1">if</font> (comps) {
<a name="line3289">3289: </a>    *comps = b-&gt;comps;
<a name="line3290">3290: </a>  }
<a name="line3291">3291: </a>  <font color="#4169E1">if</font> (func) {
<a name="line3293">3293: </a>    *func = b-&gt;func;
<a name="line3294">3294: </a>  }
<a name="line3295">3295: </a>  <font color="#4169E1">if</font> (func_t) {
<a name="line3297">3297: </a>    *func_t = b-&gt;func_t;
<a name="line3298">3298: </a>  }
<a name="line3299">3299: </a>  <font color="#4169E1">if</font> (numids) {
<a name="line3301">3301: </a>    *numids = b-&gt;numids;
<a name="line3302">3302: </a>  }
<a name="line3303">3303: </a>  <font color="#4169E1">if</font> (ids) {
<a name="line3305">3305: </a>    *ids = b-&gt;ids;
<a name="line3306">3306: </a>  }
<a name="line3307">3307: </a>  <font color="#4169E1">if</font> (ctx) {
<a name="line3309">3309: </a>    *ctx = b-&gt;ctx;
<a name="line3310">3310: </a>  }
<a name="line3311">3311: </a>  <font color="#4169E1">return</font>(0);
<a name="line3312">3312: </a>}

<a name="line3314">3314: </a><font color="#B22222">/*@</font>
<a name="line3315">3315: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSCopyBoundary.html#PetscDSCopyBoundary">PetscDSCopyBoundary</a> - Copy all boundary condition objects to the new problem</font>

<a name="line3317">3317: </a><font color="#B22222">  Not collective</font>

<a name="line3319">3319: </a><font color="#B22222">  Input Parameter:</font>
<a name="line3320">3320: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line3322">3322: </a><font color="#B22222">  Output Parameter:</font>
<a name="line3323">3323: </a><font color="#B22222">. newprob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> copy</font>

<a name="line3325">3325: </a><font color="#B22222">  Level: intermediate</font>

<a name="line3327">3327: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSCopyEquations.html#PetscDSCopyEquations">PetscDSCopyEquations</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetResidual.html#PetscDSSetResidual">PetscDSSetResidual</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetJacobian.html#PetscDSSetJacobian">PetscDSSetJacobian</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetRiemannSolver.html#PetscDSSetRiemannSolver">PetscDSSetRiemannSolver</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetBdResidual.html#PetscDSSetBdResidual">PetscDSSetBdResidual</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetBdJacobian.html#PetscDSSetBdJacobian">PetscDSSetBdJacobian</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line3328">3328: </a><font color="#B22222">@*/</font>
<a name="line3329">3329: </a><strong><font color="#4169E1"><a name="PetscDSCopyBoundary"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSCopyBoundary.html#PetscDSCopyBoundary">PetscDSCopyBoundary</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> probA, <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> probB)</font></strong>
<a name="line3330">3330: </a>{
<a name="line3331">3331: </a>  DSBoundary     b, next, *lastnext;

<a name="line3337">3337: </a>  <font color="#4169E1">if</font> (probA == probB) <font color="#4169E1">return</font>(0);
<a name="line3338">3338: </a>  next = probB-&gt;boundary;
<a name="line3339">3339: </a>  <font color="#4169E1">while</font> (next) {
<a name="line3340">3340: </a>    DSBoundary b = next;

<a name="line3342">3342: </a>    next = b-&gt;next;
<a name="line3343">3343: </a>    <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(b-&gt;comps);
<a name="line3344">3344: </a>    <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(b-&gt;ids);
<a name="line3345">3345: </a>    <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(b-&gt;name);
<a name="line3346">3346: </a>    <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(b-&gt;labelname);
<a name="line3347">3347: </a>    <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(b);
<a name="line3348">3348: </a>  }
<a name="line3349">3349: </a>  lastnext = &amp;(probB-&gt;boundary);
<a name="line3350">3350: </a>  <font color="#4169E1">for</font> (b = probA-&gt;boundary; b; b = b-&gt;next) {
<a name="line3351">3351: </a>    DSBoundary bNew;

<a name="line3353">3353: </a>    <a href="../../../../docs/manualpages/Sys/PetscNew.html#PetscNew">PetscNew</a>(&amp;bNew);
<a name="line3354">3354: </a>    bNew-&gt;numcomps = b-&gt;numcomps;
<a name="line3355">3355: </a>    <a href="../../../../docs/manualpages/Sys/PetscMalloc1.html#PetscMalloc1">PetscMalloc1</a>(bNew-&gt;numcomps, &amp;bNew-&gt;comps);
<a name="line3356">3356: </a>    <a href="../../../../docs/manualpages/Sys/PetscArraycpy.html#PetscArraycpy">PetscArraycpy</a>(bNew-&gt;comps, b-&gt;comps, bNew-&gt;numcomps);
<a name="line3357">3357: </a>    bNew-&gt;numids = b-&gt;numids;
<a name="line3358">3358: </a>    <a href="../../../../docs/manualpages/Sys/PetscMalloc1.html#PetscMalloc1">PetscMalloc1</a>(bNew-&gt;numids, &amp;bNew-&gt;ids);
<a name="line3359">3359: </a>    <a href="../../../../docs/manualpages/Sys/PetscArraycpy.html#PetscArraycpy">PetscArraycpy</a>(bNew-&gt;ids, b-&gt;ids, bNew-&gt;numids);
<a name="line3360">3360: </a>    <a href="../../../../docs/manualpages/Sys/PetscStrallocpy.html#PetscStrallocpy">PetscStrallocpy</a>(b-&gt;labelname,(char **) &amp;(bNew-&gt;labelname));
<a name="line3361">3361: </a>    <a href="../../../../docs/manualpages/Sys/PetscStrallocpy.html#PetscStrallocpy">PetscStrallocpy</a>(b-&gt;name,(char **) &amp;(bNew-&gt;name));
<a name="line3362">3362: </a>    bNew-&gt;ctx   = b-&gt;ctx;
<a name="line3363">3363: </a>    bNew-&gt;type  = b-&gt;type;
<a name="line3364">3364: </a>    bNew-&gt;field = b-&gt;field;
<a name="line3365">3365: </a>    bNew-&gt;func  = b-&gt;func;

<a name="line3367">3367: </a>    *lastnext = bNew;
<a name="line3368">3368: </a>    lastnext = &amp;(bNew-&gt;next);
<a name="line3369">3369: </a>  }
<a name="line3370">3370: </a>  <font color="#4169E1">return</font>(0);
<a name="line3371">3371: </a>}

<a name="line3373">3373: </a><font color="#B22222">/*@</font>
<a name="line3374">3374: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSelectDiscretizations.html#PetscDSSelectDiscretizations">PetscDSSelectDiscretizations</a> - Copy discretizations to the new problem with different field layout</font>

<a name="line3376">3376: </a><font color="#B22222">  Not collective</font>

<a name="line3378">3378: </a><font color="#B22222">  Input Parameter:</font>
<a name="line3379">3379: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line3380">3380: </a><font color="#B22222">. numFields - Number of new fields</font>
<a name="line3381">3381: </a><font color="#B22222">- fields - Old field number for each new field</font>

<a name="line3383">3383: </a><font color="#B22222">  Output Parameter:</font>
<a name="line3384">3384: </a><font color="#B22222">. newprob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> copy</font>

<a name="line3386">3386: </a><font color="#B22222">  Level: intermediate</font>

<a name="line3388">3388: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSelectEquations.html#PetscDSSelectEquations">PetscDSSelectEquations</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCopyBoundary.html#PetscDSCopyBoundary">PetscDSCopyBoundary</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetResidual.html#PetscDSSetResidual">PetscDSSetResidual</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetJacobian.html#PetscDSSetJacobian">PetscDSSetJacobian</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetRiemannSolver.html#PetscDSSetRiemannSolver">PetscDSSetRiemannSolver</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetBdResidual.html#PetscDSSetBdResidual">PetscDSSetBdResidual</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetBdJacobian.html#PetscDSSetBdJacobian">PetscDSSetBdJacobian</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line3389">3389: </a><font color="#B22222">@*/</font>
<a name="line3390">3390: </a><strong><font color="#4169E1"><a name="PetscDSSelectDiscretizations"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSelectDiscretizations.html#PetscDSSelectDiscretizations">PetscDSSelectDiscretizations</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numFields, const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> fields[], <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> newprob)</font></strong>
<a name="line3391">3391: </a>{
<a name="line3392">3392: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>       Nf, Nfn, fn;

<a name="line3399">3399: </a>  <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(prob, &amp;Nf);
<a name="line3400">3400: </a>  <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(newprob, &amp;Nfn);
<a name="line3401">3401: </a>  <font color="#4169E1">if</font> (numFields &gt; Nfn) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob), PETSC_ERR_ARG_SIZ, <font color="#666666">"Number of fields %D to transfer must not be greater then the total number of fields %D"</font>, numFields, Nfn);
<a name="line3402">3402: </a>  <font color="#4169E1">for</font> (fn = 0; fn &lt; numFields; ++fn) {
<a name="line3403">3403: </a>    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f = fields ? fields[fn] : fn;
<a name="line3404">3404: </a>    <a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>    disc;

<a name="line3406">3406: </a>    <font color="#4169E1">if</font> (f &gt;= Nf) <font color="#4169E1">continue</font>;
<a name="line3407">3407: </a>    <a href="../../../../docs/manualpages/DT/PetscDSGetDiscretization.html#PetscDSGetDiscretization">PetscDSGetDiscretization</a>(prob, f, &amp;disc);
<a name="line3408">3408: </a>    <a href="../../../../docs/manualpages/DT/PetscDSSetDiscretization.html#PetscDSSetDiscretization">PetscDSSetDiscretization</a>(newprob, fn, disc);
<a name="line3409">3409: </a>  }
<a name="line3410">3410: </a>  <font color="#4169E1">return</font>(0);
<a name="line3411">3411: </a>}

<a name="line3413">3413: </a><font color="#B22222">/*@</font>
<a name="line3414">3414: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSSelectEquations.html#PetscDSSelectEquations">PetscDSSelectEquations</a> - Copy pointwise function pointers to the new problem with different field layout</font>

<a name="line3416">3416: </a><font color="#B22222">  Not collective</font>

<a name="line3418">3418: </a><font color="#B22222">  Input Parameter:</font>
<a name="line3419">3419: </a><font color="#B22222">+ prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>
<a name="line3420">3420: </a><font color="#B22222">. numFields - Number of new fields</font>
<a name="line3421">3421: </a><font color="#B22222">- fields - Old field number for each new field</font>

<a name="line3423">3423: </a><font color="#B22222">  Output Parameter:</font>
<a name="line3424">3424: </a><font color="#B22222">. newprob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> copy</font>

<a name="line3426">3426: </a><font color="#B22222">  Level: intermediate</font>

<a name="line3428">3428: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSSelectDiscretizations.html#PetscDSSelectDiscretizations">PetscDSSelectDiscretizations</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCopyBoundary.html#PetscDSCopyBoundary">PetscDSCopyBoundary</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetResidual.html#PetscDSSetResidual">PetscDSSetResidual</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetJacobian.html#PetscDSSetJacobian">PetscDSSetJacobian</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetRiemannSolver.html#PetscDSSetRiemannSolver">PetscDSSetRiemannSolver</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetBdResidual.html#PetscDSSetBdResidual">PetscDSSetBdResidual</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetBdJacobian.html#PetscDSSetBdJacobian">PetscDSSetBdJacobian</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line3429">3429: </a><font color="#B22222">@*/</font>
<a name="line3430">3430: </a><strong><font color="#4169E1"><a name="PetscDSSelectEquations"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSSelectEquations.html#PetscDSSelectEquations">PetscDSSelectEquations</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> numFields, const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> fields[], <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> newprob)</font></strong>
<a name="line3431">3431: </a>{
<a name="line3432">3432: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>       Nf, Nfn, fn, gn;

<a name="line3439">3439: </a>  <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(prob, &amp;Nf);
<a name="line3440">3440: </a>  <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(newprob, &amp;Nfn);
<a name="line3441">3441: </a>  <font color="#4169E1">if</font> (numFields &gt; Nfn) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob), PETSC_ERR_ARG_SIZ, <font color="#666666">"Number of fields %D to transfer must not be greater then the total number of fields %D"</font>, numFields, Nfn);
<a name="line3442">3442: </a>  <font color="#4169E1">for</font> (fn = 0; fn &lt; numFields; ++fn) {
<a name="line3443">3443: </a>    const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>   f = fields ? fields[fn] : fn;
<a name="line3444">3444: </a>    PetscPointFunc   obj;
<a name="line3445">3445: </a>    PetscPointFunc   f0, f1;
<a name="line3446">3446: </a>    PetscBdPointFunc f0Bd, f1Bd;
<a name="line3447">3447: </a>    PetscRiemannFunc r;

<a name="line3449">3449: </a>    <font color="#4169E1">if</font> (f &gt;= Nf) <font color="#4169E1">continue</font>;
<a name="line3450">3450: </a>    PetscDSGetObjective(prob, f, &amp;obj);
<a name="line3451">3451: </a>    <a href="../../../../docs/manualpages/DT/PetscDSGetResidual.html#PetscDSGetResidual">PetscDSGetResidual</a>(prob, f, &amp;f0, &amp;f1);
<a name="line3452">3452: </a>    <a href="../../../../docs/manualpages/DT/PetscDSGetBdResidual.html#PetscDSGetBdResidual">PetscDSGetBdResidual</a>(prob, f, &amp;f0Bd, &amp;f1Bd);
<a name="line3453">3453: </a>    <a href="../../../../docs/manualpages/DT/PetscDSGetRiemannSolver.html#PetscDSGetRiemannSolver">PetscDSGetRiemannSolver</a>(prob, f, &amp;r);
<a name="line3454">3454: </a>    PetscDSSetObjective(newprob, fn, obj);
<a name="line3455">3455: </a>    <a href="../../../../docs/manualpages/DT/PetscDSSetResidual.html#PetscDSSetResidual">PetscDSSetResidual</a>(newprob, fn, f0, f1);
<a name="line3456">3456: </a>    <a href="../../../../docs/manualpages/DT/PetscDSSetBdResidual.html#PetscDSSetBdResidual">PetscDSSetBdResidual</a>(newprob, fn, f0Bd, f1Bd);
<a name="line3457">3457: </a>    <a href="../../../../docs/manualpages/DT/PetscDSSetRiemannSolver.html#PetscDSSetRiemannSolver">PetscDSSetRiemannSolver</a>(newprob, fn, r);
<a name="line3458">3458: </a>    <font color="#4169E1">for</font> (gn = 0; gn &lt; numFields; ++gn) {
<a name="line3459">3459: </a>      const <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>  g = fields ? fields[gn] : gn;
<a name="line3460">3460: </a>      PetscPointJac   g0, g1, g2, g3;
<a name="line3461">3461: </a>      PetscPointJac   g0p, g1p, g2p, g3p;
<a name="line3462">3462: </a>      PetscBdPointJac g0Bd, g1Bd, g2Bd, g3Bd;

<a name="line3464">3464: </a>      <font color="#4169E1">if</font> (g &gt;= Nf) <font color="#4169E1">continue</font>;
<a name="line3465">3465: </a>      <a href="../../../../docs/manualpages/DT/PetscDSGetJacobian.html#PetscDSGetJacobian">PetscDSGetJacobian</a>(prob, f, g, &amp;g0, &amp;g1, &amp;g2, &amp;g3);
<a name="line3466">3466: </a>      <a href="../../../../docs/manualpages/DT/PetscDSGetJacobianPreconditioner.html#PetscDSGetJacobianPreconditioner">PetscDSGetJacobianPreconditioner</a>(prob, f, g, &amp;g0p, &amp;g1p, &amp;g2p, &amp;g3p);
<a name="line3467">3467: </a>      <a href="../../../../docs/manualpages/DT/PetscDSGetBdJacobian.html#PetscDSGetBdJacobian">PetscDSGetBdJacobian</a>(prob, f, g, &amp;g0Bd, &amp;g1Bd, &amp;g2Bd, &amp;g3Bd);
<a name="line3468">3468: </a>      <a href="../../../../docs/manualpages/DT/PetscDSSetJacobian.html#PetscDSSetJacobian">PetscDSSetJacobian</a>(newprob, fn, gn, g0, g1, g2, g3);
<a name="line3469">3469: </a>      <a href="../../../../docs/manualpages/DT/PetscDSSetJacobianPreconditioner.html#PetscDSSetJacobianPreconditioner">PetscDSSetJacobianPreconditioner</a>(newprob, fn, gn, g0p, g1p, g2p, g3p);
<a name="line3470">3470: </a>      <a href="../../../../docs/manualpages/DT/PetscDSSetBdJacobian.html#PetscDSSetBdJacobian">PetscDSSetBdJacobian</a>(newprob, fn, gn, g0Bd, g1Bd, g2Bd, g3Bd);
<a name="line3471">3471: </a>    }
<a name="line3472">3472: </a>  }
<a name="line3473">3473: </a>  <font color="#4169E1">return</font>(0);
<a name="line3474">3474: </a>}

<a name="line3476">3476: </a><font color="#B22222">/*@</font>
<a name="line3477">3477: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSCopyEquations.html#PetscDSCopyEquations">PetscDSCopyEquations</a> - Copy all pointwise function pointers to the new problem</font>

<a name="line3479">3479: </a><font color="#B22222">  Not collective</font>

<a name="line3481">3481: </a><font color="#B22222">  Input Parameter:</font>
<a name="line3482">3482: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line3484">3484: </a><font color="#B22222">  Output Parameter:</font>
<a name="line3485">3485: </a><font color="#B22222">. newprob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> copy</font>

<a name="line3487">3487: </a><font color="#B22222">  Level: intermediate</font>

<a name="line3489">3489: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSCopyBoundary.html#PetscDSCopyBoundary">PetscDSCopyBoundary</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetResidual.html#PetscDSSetResidual">PetscDSSetResidual</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetJacobian.html#PetscDSSetJacobian">PetscDSSetJacobian</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetRiemannSolver.html#PetscDSSetRiemannSolver">PetscDSSetRiemannSolver</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetBdResidual.html#PetscDSSetBdResidual">PetscDSSetBdResidual</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetBdJacobian.html#PetscDSSetBdJacobian">PetscDSSetBdJacobian</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line3490">3490: </a><font color="#B22222">@*/</font>
<a name="line3491">3491: </a><strong><font color="#4169E1"><a name="PetscDSCopyEquations"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSCopyEquations.html#PetscDSCopyEquations">PetscDSCopyEquations</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> newprob)</font></strong>
<a name="line3492">3492: </a>{
<a name="line3493">3493: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>       Nf, Ng;

<a name="line3499">3499: </a>  <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(prob, &amp;Nf);
<a name="line3500">3500: </a>  <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(newprob, &amp;Ng);
<a name="line3501">3501: </a>  <font color="#4169E1">if</font> (Nf != Ng) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob), PETSC_ERR_ARG_SIZ, <font color="#666666">"Number of fields must match %D != %D"</font>, Nf, Ng);
<a name="line3502">3502: </a>  <a href="../../../../docs/manualpages/DT/PetscDSSelectEquations.html#PetscDSSelectEquations">PetscDSSelectEquations</a>(prob, Nf, NULL, newprob);
<a name="line3503">3503: </a>  <font color="#4169E1">return</font>(0);
<a name="line3504">3504: </a>}
<a name="line3505">3505: </a><font color="#B22222">/*@</font>
<a name="line3506">3506: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PetscDSCopyConstants.html#PetscDSCopyConstants">PetscDSCopyConstants</a> - Copy all constants to the new problem</font>

<a name="line3508">3508: </a><font color="#B22222">  Not collective</font>

<a name="line3510">3510: </a><font color="#B22222">  Input Parameter:</font>
<a name="line3511">3511: </a><font color="#B22222">. prob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> object</font>

<a name="line3513">3513: </a><font color="#B22222">  Output Parameter:</font>
<a name="line3514">3514: </a><font color="#B22222">. newprob - The <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> copy</font>

<a name="line3516">3516: </a><font color="#B22222">  Level: intermediate</font>

<a name="line3518">3518: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DT/PetscDSCopyBoundary.html#PetscDSCopyBoundary">PetscDSCopyBoundary</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCopyEquations.html#PetscDSCopyEquations">PetscDSCopyEquations</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetResidual.html#PetscDSSetResidual">PetscDSSetResidual</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetJacobian.html#PetscDSSetJacobian">PetscDSSetJacobian</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetRiemannSolver.html#PetscDSSetRiemannSolver">PetscDSSetRiemannSolver</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetBdResidual.html#PetscDSSetBdResidual">PetscDSSetBdResidual</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetBdJacobian.html#PetscDSSetBdJacobian">PetscDSSetBdJacobian</a>(), <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>()</font>
<a name="line3519">3519: </a><font color="#B22222">@*/</font>
<a name="line3520">3520: </a><strong><font color="#4169E1"><a name="PetscDSCopyConstants"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> <a href="../../../../docs/manualpages/DT/PetscDSCopyConstants.html#PetscDSCopyConstants">PetscDSCopyConstants</a>(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> newprob)</font></strong>
<a name="line3521">3521: </a>{
<a name="line3522">3522: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>           Nc;
<a name="line3523">3523: </a>  const <a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> *constants;
<a name="line3524">3524: </a>  <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a>     ierr;

<a name="line3529">3529: </a>  <a href="../../../../docs/manualpages/DT/PetscDSGetConstants.html#PetscDSGetConstants">PetscDSGetConstants</a>(prob, &amp;Nc, &amp;constants);
<a name="line3530">3530: </a>  <a href="../../../../docs/manualpages/DT/PetscDSSetConstants.html#PetscDSSetConstants">PetscDSSetConstants</a>(newprob, Nc, (<a href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</a> *) constants);
<a name="line3531">3531: </a>  <font color="#4169E1">return</font>(0);
<a name="line3532">3532: </a>}

<a name="line3534">3534: </a><strong><font color="#4169E1"><a name="PetscDSGetHeightSubspace"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDSGetHeightSubspace(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> height, <a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> *subprob)</font></strong>
<a name="line3535">3535: </a>{
<a name="line3536">3536: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>       dim, Nf, f;

<a name="line3542">3542: </a>  <font color="#4169E1">if</font> (height == 0) {*subprob = prob; <font color="#4169E1">return</font>(0);}
<a name="line3543">3543: </a>  <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(prob, &amp;Nf);
<a name="line3544">3544: </a>  <a href="../../../../docs/manualpages/DT/PetscDSGetSpatialDimension.html#PetscDSGetSpatialDimension">PetscDSGetSpatialDimension</a>(prob, &amp;dim);
<a name="line3545">3545: </a>  <font color="#4169E1">if</font> (height &gt; dim) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob), PETSC_ERR_ARG_OUTOFRANGE, <font color="#666666">"DS can only handle height in [0, %D], not %D"</font>, dim, height);
<a name="line3546">3546: </a>  <font color="#4169E1">if</font> (!prob-&gt;subprobs) {<a href="../../../../docs/manualpages/Sys/PetscCalloc1.html#PetscCalloc1">PetscCalloc1</a>(dim, &amp;prob-&gt;subprobs);}
<a name="line3547">3547: </a>  <font color="#4169E1">if</font> (!prob-&gt;subprobs[height-1]) {
<a name="line3548">3548: </a>    <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> cdim;

<a name="line3550">3550: </a>    <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>(<a href="../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob), &amp;prob-&gt;subprobs[height-1]);
<a name="line3551">3551: </a>    <a href="../../../../docs/manualpages/DT/PetscDSGetCoordinateDimension.html#PetscDSGetCoordinateDimension">PetscDSGetCoordinateDimension</a>(prob, &amp;cdim);
<a name="line3552">3552: </a>    <a href="../../../../docs/manualpages/DT/PetscDSSetCoordinateDimension.html#PetscDSSetCoordinateDimension">PetscDSSetCoordinateDimension</a>(prob-&gt;subprobs[height-1], cdim);
<a name="line3553">3553: </a>    <font color="#4169E1">for</font> (f = 0; f &lt; Nf; ++f) {
<a name="line3554">3554: </a>      <a href="../../../../docs/manualpages/FE/PetscFE.html#PetscFE">PetscFE</a>      subfe;
<a name="line3555">3555: </a>      <a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>  obj;
<a name="line3556">3556: </a>      <a href="../../../../docs/manualpages/Sys/PetscClassId.html#PetscClassId">PetscClassId</a> id;

<a name="line3558">3558: </a>      <a href="../../../../docs/manualpages/DT/PetscDSGetDiscretization.html#PetscDSGetDiscretization">PetscDSGetDiscretization</a>(prob, f, &amp;obj);
<a name="line3559">3559: </a>      <a href="../../../../docs/manualpages/Sys/PetscObjectGetClassId.html#PetscObjectGetClassId">PetscObjectGetClassId</a>(obj, &amp;id);
<a name="line3560">3560: </a>      <font color="#4169E1">if</font> (id == PETSCFE_CLASSID) {<a href="../../../../docs/manualpages/FE/PetscFEGetHeightSubspace.html#PetscFEGetHeightSubspace">PetscFEGetHeightSubspace</a>((<a href="../../../../docs/manualpages/FE/PetscFE.html#PetscFE">PetscFE</a>) obj, height, &amp;subfe);}
<a name="line3561">3561: </a>      <font color="#4169E1">else</font> <a href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</a>(<a href="../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) prob), PETSC_ERR_ARG_WRONG, <font color="#666666">"Unsupported discretization type for field %d"</font>, f);
<a name="line3562">3562: </a>      <a href="../../../../docs/manualpages/DT/PetscDSSetDiscretization.html#PetscDSSetDiscretization">PetscDSSetDiscretization</a>(prob-&gt;subprobs[height-1], f, (<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) subfe);
<a name="line3563">3563: </a>    }
<a name="line3564">3564: </a>  }
<a name="line3565">3565: </a>  *subprob = prob-&gt;subprobs[height-1];
<a name="line3566">3566: </a>  <font color="#4169E1">return</font>(0);
<a name="line3567">3567: </a>}

<a name="line3569">3569: </a><strong><font color="#4169E1"><a name="PetscDSGetDiscType_Internal"></a><a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDSGetDiscType_Internal(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> ds, <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a> f, PetscDiscType *disctype)</font></strong>
<a name="line3570">3570: </a>{
<a name="line3571">3571: </a>  <a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>    obj;
<a name="line3572">3572: </a>  <a href="../../../../docs/manualpages/Sys/PetscClassId.html#PetscClassId">PetscClassId</a>   id;
<a name="line3573">3573: </a>  <a href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</a>       Nf;

<a name="line3579">3579: </a>  *disctype = PETSC_DISC_NONE;
<a name="line3580">3580: </a>  <a href="../../../../docs/manualpages/DT/PetscDSGetNumFields.html#PetscDSGetNumFields">PetscDSGetNumFields</a>(ds, &amp;Nf);
<a name="line3581">3581: </a>  <font color="#4169E1">if</font> (f &gt;= Nf) <a href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</a>(<a href="../../../../docs/manualpages/Sys/PetscObjectComm.html#PetscObjectComm">PetscObjectComm</a>((<a href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</a>) ds), PETSC_ERR_ARG_SIZ, <font color="#666666">"Field %D must be in [0, %D)"</font>, f, Nf);
<a name="line3582">3582: </a>  <a href="../../../../docs/manualpages/DT/PetscDSGetDiscretization.html#PetscDSGetDiscretization">PetscDSGetDiscretization</a>(ds, f, &amp;obj);
<a name="line3583">3583: </a>  <font color="#4169E1">if</font> (obj) {
<a name="line3584">3584: </a>    <a href="../../../../docs/manualpages/Sys/PetscObjectGetClassId.html#PetscObjectGetClassId">PetscObjectGetClassId</a>(obj, &amp;id);
<a name="line3585">3585: </a>    <font color="#4169E1">if</font> (id == PETSCFE_CLASSID) *disctype = PETSC_DISC_FE;
<a name="line3586">3586: </a>    <font color="#4169E1">else</font>                       *disctype = PETSC_DISC_FV;
<a name="line3587">3587: </a>  }
<a name="line3588">3588: </a>  <font color="#4169E1">return</font>(0);
<a name="line3589">3589: </a>}

<a name="line3591">3591: </a><strong><font color="#4169E1"><a name="PetscDSDestroy_Basic"></a>static <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDSDestroy_Basic(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob)</font></strong>
<a name="line3592">3592: </a>{
<a name="line3593">3593: </a>  <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a>      ierr;

<a name="line3596">3596: </a>  <a href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</a>(prob-&gt;data);
<a name="line3597">3597: </a>  <font color="#4169E1">return</font>(0);
<a name="line3598">3598: </a>}

<a name="line3600">3600: </a><strong><font color="#4169E1"><a name="PetscDSInitialize_Basic"></a>static <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDSInitialize_Basic(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob)</font></strong>
<a name="line3601">3601: </a>{
<a name="line3603">3603: </a>  prob-&gt;ops-&gt;setfromoptions = NULL;
<a name="line3604">3604: </a>  prob-&gt;ops-&gt;setup          = NULL;
<a name="line3605">3605: </a>  prob-&gt;ops-&gt;view           = NULL;
<a name="line3606">3606: </a>  prob-&gt;ops-&gt;destroy        = PetscDSDestroy_Basic;
<a name="line3607">3607: </a>  <font color="#4169E1">return</font>(0);
<a name="line3608">3608: </a>}

<a name="line3610">3610: </a><font color="#B22222">/*MC</font>
<a name="line3611">3611: </a><font color="#B22222">  <a href="../../../../docs/manualpages/DT/PETSCDSBASIC.html#PETSCDSBASIC">PETSCDSBASIC</a> = "basic" - A discrete system with pointwise residual and boundary residual functions</font>

<a name="line3613">3613: </a><font color="#B22222">  Level: intermediate</font>

<a name="line3615">3615: </a><font color="#B22222">.seealso: <a href="../../../../docs/manualpages/DM/PetscDSType.html#PetscDSType">PetscDSType</a>, <a href="../../../../docs/manualpages/DT/PetscDSCreate.html#PetscDSCreate">PetscDSCreate</a>(), <a href="../../../../docs/manualpages/DT/PetscDSSetType.html#PetscDSSetType">PetscDSSetType</a>()</font>
<a name="line3616">3616: </a><font color="#B22222">M*/</font>

<a name="line3618">3618: </a><strong><font color="#4169E1"><a name="PetscDSCreate_Basic"></a>PETSC_EXTERN <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a> PetscDSCreate_Basic(<a href="../../../../docs/manualpages/DM/PetscDS.html#PetscDS">PetscDS</a> prob)</font></strong>
<a name="line3619">3619: </a>{
<a name="line3620">3620: </a>  PetscDS_Basic *b;
<a name="line3621">3621: </a>  <a href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</a>      ierr;

<a name="line3625">3625: </a>  <a href="../../../../docs/manualpages/Sys/PetscNewLog.html#PetscNewLog">PetscNewLog</a>(prob, &amp;b);
<a name="line3626">3626: </a>  prob-&gt;data = b;

<a name="line3628">3628: </a>  PetscDSInitialize_Basic(prob);
<a name="line3629">3629: </a>  <font color="#4169E1">return</font>(0);
<a name="line3630">3630: </a>}
</pre>
</body>

</html>
